function wCp(a){vj.call(this,a)}z(wCp,vj);wCp.prototype.getStatus=function(){return this.message.getStatus()};function xCp(a){this.Gb=dj(a,-1,0)}z(xCp,ej);xCp.prototype.yb=function(){return new wCp(this)};xCp.prototype.getStatus=function(){return rj(this,1,0)};function yCp(a){vj.call(this,a)}z(yCp,vj);yCp.prototype.getStatus=function(){return this.message.getStatus()};function zCp(a){this.Gb=dj(a,-1,0)}z(zCp,ej);zCp.prototype.yb=function(){return new yCp(this)};
zCp.prototype.getStatus=function(){return rj(this,1,0)};function ACp(a,b){return new Mn(function(c,d){wx(a,"/dbx/createSchedule",[],b.Mb(),function(e){c(fj(xCp,JSON.stringify(e.gh())))},d)})}function BCp(a,b){return new Mn(function(c,d){wx(a,"/dbx/updateSchedule",[],b.Mb(),function(e){c(fj(zCp,JSON.stringify(e.gh())))},d)})}function CCp(a){if(!il().aPa()(a)||il().QEc()(a))return!1;a=il().iY()(a);return t4c.has(a)}
function DCp(a){var b=[];a=ea(a.C.keys());for(var c=a.next();!c.done;c=a.next())c=c.value,CCp(c)&&b.push(c);return b}function ECp(a){if(a.O.Ni())return[];var b=[];a.C.forEach(function(c,d){g4c.has(c.D)&&CCp(d)&&b.push(d)});return b}function FCp(a){a.Dc()&&RJk(a.F)}function GCp(){var a=void 0===a?hj(fKk):a;return new eKk(a)}function HCp(){var a=void 0===a?hj(hKk):a;return new gKk(a)}function ICp(a){vj.call(this,a)}z(ICp,vj);function JCp(a,b){return Fj(a,1,b)}function KCp(a){this.Gb=dj(a,-1,0)}
z(KCp,ej);KCp.prototype.yb=function(){return new ICp(this)};function LCp(){var a=void 0===a?hj(KCp):a;return new ICp(a)}function MCp(a){vj.call(this,a)}z(MCp,vj);function NCp(a,b){return yj(a,1,b)}function OCp(a,b){return Fj(a,2,b)}function PCp(a){this.Gb=dj(a,-1,0)}z(PCp,ej);PCp.prototype.yb=function(){return new MCp(this)};function QCp(){var a=void 0===a?hj(PCp):a;return new MCp(a)}
function RCp(a,b,c,d){uq.call(this,d);this.hb=c;this.$a=a;this.state=3;this.C=null;this.Va=this.ma=!1;this.ib=new Es(this);this.Ca(this.ib);this.Za=new i_k(500,500,"dbxScheduleOnCompleteAuth");this.Ca(this.Za);SCp(this)}z(RCp,uq);function SCp(a){a.ib.Fc(R8b,dp,function(b){b=b.data;TCp(a,36713,b);UCp(a,b,null)}).Fc(S8b,dp,function(b){b=b.data;TCp(a,36714,b);VCp(a,b,null)}).Fc(T8b,dp,a.zb).Fc(U8b,dp,a.sb).Fc(su,cp,a.refresh)}
function UCp(a,b,c,d){d=void 0===d?!0:d;var e=JCp(LCp(),b);c&&yj(e,2,c);ACp(vx.qb(),e.qa()).then(function(f){return WCp(a,b,f.getStatus(),mj(f,2),!0,d)},function(){a.SXa()})}function VCp(a,b,c,d){d=void 0===d?!0:d;var e=OCp(NCp(QCp(),a.C.getId()),b);c&&yj(e,3,c);BCp(vx.qb(),e.qa()).then(function(f){return WCp(a,b,f.getStatus(),mj(f,2),!1,d)},function(){a.SXa()})}RCp.prototype.zb=function(){if(su.isEnabled()){var a=zKk(this.C);TCp(this,36715,a);a=a.yb().Ya(!0).qa();VCp(this,a,null)}};
RCp.prototype.sb=function(){if(su.isEnabled()){var a=zKk(this.C);TCp(this,36716,a);a=a.yb().Ya(!1).qa();VCp(this,a,null)}};function TCp(a,b,c){var d=new tPa;c=XCp(c.Uo());d=T(d,10,c);d=HFk(d);d=Mp(Jp(new Gp,75),d).qa();a.hb.C(b,d)}function XCp(a){switch(a.Uo()){case 4:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 0:return 0}}
function YCp(a){a.state=3;a.refresh();WKk().then(function(b){a.isDisposed()||(b=tj(b,1,yKk).Lc(),0==b.length?(a.state=1,a.C=null):(a.state=4,a.C=b[0]),a.Va?(a.Va=!1,a.show()):a.refresh())},function(){Vs.qb().postMessage(Xs("Error loading schedule configuration.","error",!0))})}function ZCp(a){return a.C&&kj(zKk(a.C),1)?(pj(a.C.getStatus(),1),!0):!1}
function WCp(a,b,c,d,e,f){a.cpb(!0);switch(c){case 1:a.focus();YCp(a);dx.dispatchEvent("load-schedules-on-config-bar");break;case 2:if(!f)break;j_k(a.Za,d,function(h){a.isDisposed()||(a.cpb(!1),e?UCp(a,b,h,!1):VCp(a,b,h,!1))});break;default:a.SXa()}}RCp.prototype.show=function(){3==this.state?this.Va=!0:(this.hb.C(116122),this.state=1==this.state?2:5,this.refresh())};function $Cp(a,b){ffl.call(this,a,b)}z($Cp,ffl);$Cp.prototype.R=function(){this.refresh()};$Cp.prototype.refresh=function(){if(this.Dc()){var a=su.isEnabled();a=this.J&&this.O&&a&&0<ECp(this.H).length;this.C.Ya(a)}};$Cp.prototype.V=q("Refresh all");function aDp(a){a=a||{};var b=Pq(void 0,null)?18:void 0;b='<svg xmlns="http://www.w3.org/2000/svg" width="'+V(b)+'px" height="'+V(b)+'px" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-2 -2)"><polygon points="0 0 24 0 24 24 0 24"/><path fill="'+V(Pq(void 0,null)?"#188038":void 0)+'" fill-rule="nonzero" d="M22,4 L22,10 L16,10 L16,8 L18.91,8 C17.53,5.61 14.96,4 12,4 C7.58,4 4,7.58 4,12 C4,16.42 7.58,20 12,20 C16.42,20 20,16.42 20,12 L22,12 C22,17.52 17.52,22 11.99,22 C6.47,22 2,17.52 2,12 C2,6.48 6.47,2 11.99,2 C15.27,2 18.17,3.58 20,6.01 L20,4 L22,4 Z M13,12 L13,6 L11,6 L11,13 L15.97,16.49 L17.23,14.94 L13,12 Z"/></g></svg>';
b=Nq(b);a=""+jZ(Oq({title:"Refresh options",qD:"waffle-dataconnector-refresh-sidebar",hP:Rq(""+b),iA:Rq('<div class="'+V("waffle-dataconnector-refresh-sidebar-container")+'"><div class="'+V("waffle-dataconnector-refresh-sidebar-refresh-widget")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-sidebar-backdrop")+'"></div>'),a8:!0,fY:Rq('<div class="'+V("waffle-dataconnector-refresh-sidebar-footer-wrapper")+'"></div>')},a));return Nq(a)};function bDp(){}z(bDp,us);bDp.prototype.Bd=q("docs-calendar-select");bDp.prototype.tx=function(a){a=a.Ia("DIV",["docs-calendar-select-dropdown","docs-gm-arrow","goog-inline-block"],a.Ia("DIV",["docs-icon","goog-inline-block"],a.Ia("DIV",["docs-icon-img-container","docs-icon-img","docs-icon-arrow-dropdown"])));mr(a,"docs-material");return a};qa(bDp);function cDp(){return Nq('<div><div class="'+V("waffle-dataconnector-refresh-date-input-date-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-date-input-date-picker")+'"></div>')};function dDp(a,b,c){void 0===b&&ize.qb();uq.call(this,c);this.D=new Iy("",c);this.Pa(this.D);this.C=null;this.setDate(new Date)}z(dDp,uq);u=dDp.prototype;u.Ia=function(){uq.prototype.Ia.call(this);this.Ob(Lq(cDp))};u.Qa=function(){uq.prototype.Qa.call(this);this.D.render(this.Ja("waffle-dataconnector-refresh-date-input-date-select"));this.setDate(this.F);this.getHandler().listen(this.D,"action",this.Sic)};u.getDate=n("F");
u.Sic=function(){var a=this;null==this.C?eDp(this,function(){return fDp(a)}):fDp(this)};function fDp(a){a.C.position(a.Ua());a.C.Ja("goog-date-picker").focus();null!=a.D.getValue()&&a.C.$od(a.getDate())}function eDp(a,b){Co("datepicker",function(){var c=Eo("datepicker");a.C=c.C(a.Da());a.Pa(a.C);a.C.render(a.Ja("waffle-dataconnector-refresh-date-input-date-picker"));a.C.Ifc();a.getHandler().listen(a.C,"change",a.ZTc);b()})}u.ZTc=function(a){this.setDate(new Date(a.C.getTime()));this.C.hide();this.D.Ua().focus()};
u.setDate=function(a){this.F=new Date(a);this.F.setMinutes(0);this.F.setSeconds(0);this.F.setMilliseconds(0);var b=this.D,c=b.setValue;a=(new gu(hu.MONTH_DAY_YEAR_MEDIUM)).format(a);c.call(b,a);this.Dc()&&(am(this.D.Ua(),""+this.D.getValue()),jr(this.D.Ua(),"Start date:"+this.D.getValue()))};var gDp=new lt("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function hDp(a,b){a=void 0===a?Ev.qb():a;for(var c=new ns,d=1;28>=d;d++)c.Pa(new js(gDp.format({DAY:d}),d),!0);ZOk.call(this,c,a,b)}z(hDp,ZOk);function iDp(){var a='<div class="'+V("waffle-dataconnector-refresh-day-of-month-widget")+'"><div><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-day-of-month-widget-label")+'"></div><div class="'+V("waffle-dataconnector-refresh-day-of-month-widget-add-day-select")+'" aria-label="';a+=Tq("Add day to repeat on");a+='"></div></div><div class="'+V("waffle-dataconnector-refresh-day-of-month-widget-chip-container")+'"></div></div>';return Nq(a)};var jDp=new lt("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function kDp(a){uq.call(this,a);this.D=new uq;this.Pa(this.D);this.C=new hDp(gs.qb(),a);UOb(this.C,"Add day");this.Pa(this.C);this.F=new lDp}z(kDp,uq);u=kDp.prototype;u.Ia=function(){uq.prototype.Ia.call(this);this.Ob(Lq(iDp));this.D.ub(this.Ja("waffle-dataconnector-refresh-day-of-month-widget-chip-container"));this.C.render(this.Ja("waffle-dataconnector-refresh-day-of-month-widget-add-day-select"))};
u.Qa=function(){uq.prototype.Qa.call(this);am(this.Ja("waffle-dataconnector-refresh-day-of-month-widget-label"),"Repeat on");this.getHandler().listen(this.C,"change",this.Jhd).listen(this,"Ee",this.Vjd)};u.Jhd=function(){var a=this.C.getValue();SOb(this.C.Cr,null);mDp(this,a);this.dispatchEvent("change")};u.Vjd=function(a){a=a.target;var b=Dq(this.D,a);this.F.remove(b)&&(this.D.removeChild(a,this.Dc()),this.dispatchEvent("change"))};
function mDp(a,b){if(!a.F.has(b)){var c=new g_k(jDp.format({DAY:b}),a.Da());b=a.F.add(b);a.D.Fj(c,b,a.Dc())}}u.Bg=function(){return this.F.C};function nDp(a,b){for(var c=0;c<b.length;c++)mDp(a,b[c])}function lDp(){this.C=[]}lDp.prototype.add=function(a){var b=jg(this.C,a);Uf(this.C,a,-b-1);return-b-1};lDp.prototype.has=function(a){return-1<uf(this.C,a)};lDp.prototype.remove=function(a){return Zf(this.C,a)};function oDp(){}z(oDp,gze);oDp.prototype.Ia=function(a){return a.Da().Ia("INPUT",{type:"number",max:"100",min:"1"})};qa(oDp);function pDp(){var a='<div class="'+V("waffle-dataconnector-refresh-schedules-new-widget")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-header")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-top-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-header-title")+'"><span tabindex="0" class="'+V("waffle-dataconnector-refresh-schedules-new-title")+'"></span></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-enable-switch")+'"></div></div><div class="'+
V("waffle-dataconnector-refresh-schedules-new-spinner")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-setup-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-overview-section")+'"><span class="'+V("waffle-dataconnector-refresh-schedules-new-overview-text")+'"></span><span class="'+V("waffle-dataconnector-refresh-schedules-new-label-separator")+'"></span><span class="'+V("waffle-dataconnector-refresh-schedules-new-edit-btn")+'"></span></div><div class="'+
V("waffle-dataconnector-refresh-schedules-new-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-new-fullview-text"></div><div><span class="'+V("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn")+'"></span> - ';a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(V("waffle-dataconnector-refresh-schedules-new-edit-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-schedules-new-repeat-every-label")+
'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+V("waffle-dataconnector-refresh-schedules-new-justify-content")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-interval-input")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-frequency-select")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+V("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget")+
'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-day-of-month-widget")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-weekday-select")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-schedules-new-repeat-at-label")+
'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+V("waffle-dataconnector-refresh-schedules-new-time-select-label")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-time-select")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-schedules-new-start-date-label")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+
" "+V("waffle-dataconnector-refresh-schedules-new-justify-content")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-start-date-select")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-start-time-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-owner-info")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-btns")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-cancel-btn")+'"></div><div class="'+
V("waffle-dataconnector-refresh-schedules-new-save-btn")+'"></div></div></div></div>');return Nq(a)};function qDp(){for(var a='<div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-weekday-select-label")+'"></div><div style="display: flex">',b=0;7>b;b++)a+='<div data-index="'+V(b)+'" class="'+V("waffle-dataconnector-refresh-weekday-select")+'"></div>';return Nq(a+"</div>")};function rDp(a){a=a.name;return Nq('<div class="'+V("waffle-dataconnector-refresh-weekday-toggle")+'">'+Mq(a)+"</div>")};function sDp(a,b,c,d){hs.call(this,void 0,tDp.qb(),d);this.F=a;this.D=c;this.C=b;this.bk(16,!0)}z(sDp,hs);sDp.prototype.oy=function(a){hs.prototype.oy.call(this,a);this.isEnabled()&&this.dispatchEvent("change")};sDp.prototype.getName=n("F");sDp.prototype.getFullName=n("D");function tDp(){}z(tDp,gs);tDp.prototype.Ia=function(a){var b=Lq(rDp,{name:a.getName()});nr(b,this.Nx(a));return b};tDp.prototype.Bd=q("waffle-dataconnector-refresh-weekday-toggle");qa(tDp);function uDp(a){uq.call(this,a);this.C=vDp(this,a)}z(uDp,uq);uDp.prototype.Ia=function(){uq.prototype.Ia.call(this);this.Ob(Lq(qDp))};uDp.prototype.Qa=function(){var a=this;uq.prototype.Qa.call(this);am(this.Ja("waffle-dataconnector-refresh-weekday-select-label"),"Repeat on");this.C.forEach(function(b,c){b.render(a.mj("waffle-dataconnector-refresh-weekday-select")[c]);jr(b.Ua(),b.getFullName())})};uDp.prototype.Bg=function(){return this.C.filter(function(a){return a.Me()}).map(function(a){return a.C})};
function vDp(a,b){var c=(cu.FIRSTDAYOFWEEK+1)%7,d=cu.NARROWWEEKDAYS.map(function(e,f){return new sDp(e,(f+6)%7+1,cu.WEEKDAYS[f],b)});d=d.slice(c).concat(d.slice(0,c));d.forEach(function(e){return a.Pa(e)});return d};var wDp=new lt("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function xDp(a,b,c,d){RCp.call(this,a,b,c,d);this.V=new b0k(0,oDp.qb(),d);this.V.setValue("1");this.Pa(this.V);a=new ns;a.Pa(new js("hours",4),!0);a.Pa(new js("days",1),!0);a.Pa(new js("weeks",2),!0);a.Pa(new js("months",3),!0);this.D=new ZOk(a,bDp.qb(),d);this.D.Yi(0);this.D.bd("waffle-dataconnector-refresh-schedule-frequency");this.Pa(this.D);this.O=new kDp(d);this.Pa(this.O);this.Fa=new uDp(d);this.Pa(this.Fa);this.F=new ZOk(yDp(),bDp.qb(),d);this.F.Yi((new Date).getHours());this.F.bd("waffle-dataconnector-refresh-schedule-time");
this.Pa(this.F);this.Aa=new dDp(0,gze.qb(),d);this.X=new ZOk(yDp(),bDp.qb(),d);this.X.Yi((new Date).getHours());this.Pa(this.Aa);this.J=new dA("Cancel");this.Pa(this.J);this.oa=new Zt("Save",d);this.Pa(this.oa);this.Ga=new hs("",kx.qb(),d);this.Pa(this.Ga);this.Ta=new hs("Setup now",kx.qb(),d);this.Pa(this.Ta);this.Ra=new hs("",kx.qb(),d);this.Pa(this.Ra);this.H=new Hbk(d);this.H.dh("Enable schedule");this.Pa(this.H);this.Ka=b;this.R=new r0k(d);this.R.hd("waffle-dataconnector-refresh-schedules-new-info-icon");
this.R.setVisible(!1);this.rb=new aZ(!0,"#0f9d58")}z(xDp,RCp);u=xDp.prototype;
u.Ia=function(){RCp.prototype.Ia.call(this);this.Ob(Lq(pDp));var a=this.Ja("waffle-dataconnector-refresh-schedules-new-title");a.id=wq(this,"waffle-dataconnector-refresh-schedules-new-title");gr(this.Ua(),"labelledby",a.id);jr(a,"Scheduled refresh");am(a,"Scheduled refresh");a=this.R.C;a.setContent(ih("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.R.render(this.Ja("waffle-dataconnector-refresh-schedules-new-header-title"));
a=a.Ec();gr(Wl(this.R.Ua())[0],"labelledby",a.id)};
u.Qa=function(){var a=this;RCp.prototype.Qa.call(this);this.J.render(this.Ja("waffle-dataconnector-refresh-schedules-new-cancel-btn"));this.Ga.render(this.Ja("waffle-dataconnector-refresh-schedules-new-edit-btn"));this.H.render(this.Ja("waffle-dataconnector-refresh-schedules-new-enable-switch"));this.V.render(this.Ja("waffle-dataconnector-refresh-schedules-new-interval-input"));this.D.render(this.Ja("waffle-dataconnector-refresh-schedules-new-frequency-select"));this.oa.render(this.Ja("waffle-dataconnector-refresh-schedules-new-save-btn"));
this.Ta.render(this.Ja("waffle-dataconnector-refresh-schedules-new-setup-btn"));this.Ra.render(this.Ja("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn"));this.F.render(this.Ja("waffle-dataconnector-refresh-schedules-new-time-select"));this.O.render(this.Ja("waffle-dataconnector-refresh-schedules-new-day-of-month-widget"));this.Fa.render(this.Ja("waffle-dataconnector-refresh-schedules-new-weekday-select"));this.rb.render(this.Ja("waffle-dataconnector-refresh-schedules-new-spinner"));
this.Aa.render(this.Ja("waffle-dataconnector-refresh-schedules-new-start-date-select"));this.X.render(this.Ja("waffle-dataconnector-refresh-schedules-new-start-time-select"));zDp(this,!1);ADp(this,!1);BDp(this,!0);gOb(this.F,new er(null,13));gOb(this.X,new er(null,13));am(this.Ja("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),"Repeat at");am(this.Ja("waffle-dataconnector-refresh-schedules-new-repeat-every-label"),"Repeat every");am(this.Ja("waffle-dataconnector-refresh-schedules-new-start-date-label"),
"Start date");var b=this.Ja("waffle-dataconnector-refresh-schedules-new-repeat-every-label");b.id=wq(this,"waffle-dataconnector-refresh-schedules-new-repeat-every-label");gr(this.D.Ua(),"labelledby",b.id);gr(this.V.Ua(),"labelledby",b.id);b=this.Ja("waffle-dataconnector-refresh-schedules-new-repeat-at-label");b.id=wq(this,"waffle-dataconnector-refresh-schedules-new-repeat-at-label");gr(this.F.Ua(),"labelledby",b.id);b=this.Ja("waffle-dataconnector-refresh-schedules-new-start-date-label");b.id=wq(this,
"waffle-dataconnector-refresh-schedules-new-start-date-label");gr(this.Aa.Ua(),"labelledby",b.id);this.getHandler().listen(this.Ga,"action",this.show).listen(this.J,"action",this.Uic).listen(this.oa,"action",this.Xic).listen(this.Ta,"action",this.show).listen(this.H,"action",this.Vic).listen(this.D,"change",this.Wic).listen(this.O,"change",this.b1).listen(this.Fa,"change",this.b1).listen(this.O,"change",this.b1).listen(this.F,"change",this.b1).listen(this.X,"change",this.b1).listen(this.V,"action",
this.b1).listen(this.Ra,"action",this.Yic).listen(this.Ua(),"keydown",this.Tic);[this.D,this.F,this.X,this.J].forEach(function(c){a.getHandler().listen(c.Ua(),"focus",function(){var d=a.Aa;d.C&&d.C.isVisible()&&d.C.hide()})});0<Array.from(this.$a.C.keys()).length?(oq(this.Ua(),!0),YCp(this)):oq(this.Ua(),!1)};
u.refresh=function(){if(!this.isDisposed()){var a=this.Ja("waffle-dataconnector-refresh-schedules-new-edit-section"),b=this.Ja("waffle-dataconnector-refresh-schedules-new-overview-section"),c=this.Ja("waffle-dataconnector-refresh-schedules-new-fullview-section"),d=this.Ja("waffle-dataconnector-refresh-schedules-new-owner-info"),e=this.Ja("waffle-dataconnector-refresh-schedules-new-setup-btn"),f=this.Ja("waffle-dataconnector-refresh-schedules-new-enable-switch"),h=this.Ja("waffle-dataconnector-refresh-schedules-new-spinner");
oq(e,!1);oq(f,!1);oq(a,!1);oq(b,!1);oq(c,!1);oq(d,!1);oq(h,!1);qr(this.Ua(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!1);var k=!1;this.R.setVisible(!1);switch(this.state){case 1:oq(e,!0);break;case 2:oq(c,!0);oq(a,!0);oq(d,!0);qr(this.Ua(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!0);k=!0;CDp(this);DDp(this);this.b1();this.J.Ya(!0);this.R.setVisible(!0);nDp(this.O,[1]);break;case 3:oq(h,!0);break;case 5:oq(c,!0);oq(f,!0);oq(a,!0);oq(d,!0);qr(this.Ua(),"waffle-dataconnector-refresh-schedules-new-widget-opened",
!0);k=!0;EDp(this);CDp(this);DDp(this);a=zKk(this.C);this.H.Xc(!!kj(a,1));b=a.Uo().Uo();this.D.setValue(b);switch(b){case 4:ADp(this,!1);zDp(this,!1);break;case 1:ADp(this,!1);zDp(this,!1);this.F.setValue(qj(a.Uo(),2));break;case 2:ADp(this,!0);zDp(this,!1);c=this.Fa;d=NX(a.Uo(),4).Lc();e=ea(c.C);for(f=e.next();!f.done;f=e.next())f.value.Xc(!1);for(e=0;e<c.C.length;e++)f=c.C[e],0<=d.indexOf(f.C)&&f.Xc(!0);this.F.setValue(qj(a.Uo(),2));break;case 3:ADp(this,!1),zDp(this,!0),nDp(this.O,NX(a.Uo(),5).Lc()),
this.F.setValue(qj(a.Uo(),2))}c=ij(a.Uo(),7)?new Date(pj(a.Uo(),7)):new Date;this.Aa.setDate(c);4===b?this.X.setValue(c.getHours()):this.F.setValue(qj(a.Uo(),2));this.V.setValue(rj(a.Uo(),6,1).toString());this.b1();this.J.Ya(!0);this.R.setVisible(!0);break;case 4:oq(f,!0),oq(b,!0),EDp(this),b=this.Ja("waffle-dataconnector-refresh-schedules-new-overview-text"),ZCp(this)?(a=this.C.getStatus(),am(b,"Next: "),b=new Date(1E3*pj(a,2)),a=new Date(1E3*pj(a,3)),this.Ga.setContent(mm(this.Da(),y0k(b,a,this.Ka,
!0,!0))),oq(this.Ja("waffle-dataconnector-refresh-schedules-new-label-separator"),!1)):(am(b,"Paused"),this.Ga.setContent("Edit"),oq(this.Ja("waffle-dataconnector-refresh-schedules-new-label-separator"),!0))}this.ma!=k&&(this.ma=k,this.dispatchEvent(k?"Wk":"Vk"))}};function EDp(a){var b=!!kj(zKk(a.C),1),c=su.isEnabled();a.H.Xc(b);a.H.Ya(c)}
function CDp(a){var b=a.Ja("waffle-dataconnector-refresh-schedules-new-owner-info"),c="Will run as you.";a.C&&(a=mj(a.C.rc(4,nKk),1))&&(c+=" Currently running as "+a);am(b,c)}function DDp(a){var b=a.Ja("waffle-dataconnector-refresh-schedules-new-fullview-text");if(ZCp(a)){var c=a.C.getStatus(),d=new Date(1E3*pj(c,2));c=new Date(1E3*pj(c,3));var e=a.Da();e.Se(b);e.appendChild(b,mm(e,qh(ih("Next: "),y0k(d,c,a.Ka,!1,!0))))}else am(b,"");a.Ra.setContent(x0k(a.Ka))}u.Uic=function(){FDp(this)};
function FDp(a){a.state=2==a.state?1:4;a.refresh();a.Ja("waffle-dataconnector-refresh-schedules-new-title").focus()}u.Wic=function(){switch(this.D.getValue()){case 4:ADp(this,!1);zDp(this,!1);BDp(this,!0);break;case 1:ADp(this,!1);zDp(this,!1);BDp(this,!1);break;case 2:zDp(this,!1);ADp(this,!0);BDp(this,!1);break;case 3:ADp(this,!1),zDp(this,!0),BDp(this,!1)}this.b1()};
function BDp(a,b){oq(a.Ja("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),!b);oq(a.Ja("waffle-dataconnector-refresh-schedules-new-time-select"),!b);oq(a.Ja("waffle-dataconnector-refresh-schedules-new-start-time-select"),b)}
u.Xic=function(){this.oa.Ya(!1);this.J.Ya(!1);var a=this.D.getValue(),b=GCp().X$(a);if(2===a)for(var c=ea(this.Fa.Bg()),d=c.next();!d.done;d=c.next())d=d.value,Tva(b.Gb,4,vva).add(d);else if(3===a)for(c=ea(this.O.Bg()),d=c.next();!d.done;d=c.next())d=d.value,Tva(b.Gb,5,vva).add(d);c=this.Aa.getDate();4===a&&c.setHours(this.X.getValue());c=c.getTime();zj(b,7,c);4!==a&&(a=this.F.getValue(),Aj(b,2,a));a=parseInt(this.V.getValue(),10);Aj(b,6,a);b=Aj(HCp().X$(b),3,1);2==this.state?(b.Ya(!0),R8b.Nb(b.qa())):
(b.Ya(this.H.Me()),S8b.Nb(b.qa()))};u.Vic=function(){var a=this;if(4==this.state){var b=this.H.Me();this.H.Xc(!b);this.H.Ya(!1);if(b){var c=GDp(this);c.render();c.setVisible(!0);c.getResult().then(function(){ii(c);T8b.Nb()},function(){ii(c);EDp(a)})}else U8b.Nb()}};u.Tic=function(a){27==a.keyCode&&this.ma&&(FDp(this),a.stopPropagation())};u.Yic=function(){dfc.Nb()};
u.b1=function(){var a=!!this.D.ej(),b=3!==this.D.getValue()||0<this.O.Bg().length,c=2!==this.D.getValue()||0<this.Fa.Bg().length,d=!!this.F.ej()||4===this.D.getValue(),e=!!this.X.ej()||4!==this.D.getValue(),f=su.isEnabled(),h=parseFloat(this.V.getValue());h=Number.isInteger(h)&&0<h&&100>=h;this.oa.Ya(a&&b&&c&&d&&e&&f&&h)};u.focus=function(){this.Ja("waffle-dataconnector-refresh-schedules-new-title").focus()};u.cpb=function(a){this.H.Ya(a)};
function zDp(a,b){oq(a.Ja("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget"),b)}function ADp(a,b){oq(a.Ja("waffle-dataconnector-refresh-schedules-new-weekday-select"),b)}
function GDp(a){var b=new Ohl;b.hd("waffle-dataconnector-refresh-schedules-new-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=zKk(a.C);switch(c.Uo().Uo()){case 1:var d="Daily ";break;case 2:d=HDp();var e=NX(c.Uo(),4).Lc();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(NX(c.Uo(),5).Lc().map(function(l){return wDp.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=v0k(a.Ka);var h=new Date(wa()),k=new Date(1E3*pj(f,2));f=new Date(1E3*pj(f,3));d+=w0k(k,f,c)+" ("+o1b(q1b(c,h))+")";a="Will run as "+mj(a.C.rc(4,nKk),1);a=qh(ih("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),oh("H4",void 0,"Schedule"),ih(d),oh("BR"),ih(a));zr(b,a);return b}u.SXa=function(){Vs.qb().postMessage(Xs("Error saving schedule.","error",!0));this.oa.Ya(!0);this.J.Ya(!0);this.H.Ya(!0)};
function HDp(){var a=(cu.FIRSTDAYOFWEEK+1)%7,b=cu.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))}function yDp(){for(var a=new ns,b=new Date(wa()),c=Array(24),d=0;24>d;d++){b.setHours(d,0,0,0);var e=new Date(b.getTime()),f=new Date(b.getTime());f.setHours(e.getHours()+1);f=w0k(e,f);c[e.getHours()]={value:d,label:f}}for(b=0;24>b;b++)d=new js(c[b].label,c[b].value),a.Pa(d,!0);return a};function IDp(a,b,c){ki.call(this);this.C=a;this.J=b;this.O=c;this.F=[];this.H=[];this.D=[]}z(IDp,ki);IDp.prototype.Wa=function(){JDp(this);ki.prototype.Wa.call(this)};function KDp(a,b,c){var d=gy(a.C);b.forEach(function(e){var f=e.rect;f&&xv(f)&&(d&&HY(a.C)==e.gid?(e=MAd(d,f,LDp(c)),a.Ca(e),e.setVisible(!0),a.F.push(e)):MDp(a,e.gid,c))})}
function NDp(a,b,c){var d=gy(a.C);b.forEach(function(e){if(d){var f=Lsd(d.J,e);if(f&&f.Dc()&&f instanceof bhl){a.D.push(f);mr(Kgl(f.D),LDp(c));return}}(e=a.O.J.Dr(e))&&MDp(a,e.Db(),c)})}function MDp(a,b,c){b=mMk(a.J,b);mr(b.Ua(),LDp(c));a.H.push(b)}function LDp(a){return a?"waffle-dataconnector-refreshall-highlight-valid":"waffle-dataconnector-refreshall-highlight-error"}
function JDp(a){ji(a.F);a.F=[];a.H.forEach(function(b){pr(b.Ua(),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.H=[];a.D.forEach(function(b){pr(Kgl(b.D),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.D=[]};function ODp(){return Nq('<div class="'+V("waffle-dataconnector-refresh-all-pane")+'"><div class="'+V("waffle-dataconnector-refresh-all-datasources-container")+'"></div></div>')}function PDp(){return Nq('<div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-items-container")+'"></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer-container")+'"></div>')}
function QDp(a,b){return Nq('<div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title")+'"></div>'+PDp(null,b))}function RDp(){return Nq('<div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer")+'"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper")+'"></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper")+'"></div></div>')}
function SDp(a){a=a.title;a='<div class="'+V("waffle-dataconnector-refresh-all-dbobject-item")+'" tabindex="0"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-icon-wrapper")+'"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh")+'">'+xUc()+'</div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-title")+'" role="heading">'+Mq(a)+'</div><div class="'+
V("waffle-dataconnector-refresh-all-dbobject-item-status-wrapper")+'"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-timestamp")+'"></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-error")+'">';a=a+'Error</div><div class="'+(V("waffle-dataconnector-refresh-all-dbobject-item-loading")+'">');a=a+'Loading\u2026</div><div class="'+(V("waffle-dataconnector-refresh-all-dbobject-item-running")+'">');return Nq(a+"Running\u2026</div></div></div>")};function TDp(a,b,c,d,e,f,h){uq.call(this,h);this.C=a;this.ma=b;this.X=c;this.V=d.O;this.O=e;this.D=new IDp(e,f,d);this.Ca(this.D);this.R=new spd;this.H=new aZ(!1,"#0f9d58");this.F=this.J=!0}z(TDp,uq);u=TDp.prototype;u.Ia=function(){this.Ob(Lq(SDp,{title:this.ma}));var a=this.Ja("waffle-dataconnector-refresh-all-dbobject-item-title");a.id=wq(this,"waffle-dataconnector-refresh-all-dbobject-item-title");fr(a,"heading");gr(this.Ua(),"labelledby",a.id)};
u.Qa=function(){uq.prototype.Qa.call(this);mr(this.Ua(),"waffle-dataconnector-refresh-all-dbobject-item-enabled");this.H.render(this.Ja("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"));this.getHandler().listen(this.Ua(),"click",this.myb).listen(this.Ua(),"keydown",this.$ic).listen(this.Ua(),["mouseenter","focus"],this.Zic).listen(this.Ua(),["mouseleave","blur"],this.iSc);UDp(this)};
function UDp(a){var b=QKk(a.V,a.C),c=b.getType(),d=a.Ua();switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":case "offline":rr(d,"valid-highlight","error-highlight");a.F=!1;break;case "loading":case "no-results":case "fetch-successful":rr(d,"error-highlight","valid-highlight");a.F=!0;break;case "fetching-results":case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":VDp(a,
"waffle-dataconnector-refresh-all-dbobject-item-error");WDp(a);break;case "offline":WDp(a);break;case "loading":VDp(a,"waffle-dataconnector-refresh-all-dbobject-item-loading");XDp(a);break;case "fetching-results":VDp(a,"waffle-dataconnector-refresh-all-dbobject-item-running");XDp(a);break;case "no-results":YDp(a);WDp(a);break;case "fetch-successful":b=pj(b.C,8);b=a.R.format(b);am(a.Ja("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);jr(a.Ja("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),
b);VDp(a,"waffle-dataconnector-refresh-all-dbobject-item-timestamp");WDp(a);break;case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}}u.Ya=function(a){this.J=a;var b=this.Ua();this.Da().pn(b,a);a?rr(b,"waffle-dataconnector-refresh-all-dbobject-item-disabled","waffle-dataconnector-refresh-all-dbobject-item-enabled"):rr(b,"waffle-dataconnector-refresh-all-dbobject-item-enabled","waffle-dataconnector-refresh-all-dbobject-item-disabled")};
u.Zic=function(){var a=this;switch(this.X){case 1:case 3:case 5:var b=il().dIb()(this.C,HY(this.O)).map(function(c){return Kv(yo(c))});KDp(this.D,b,this.F);break;case 2:b=il().cIb()(this.C);NDp(this.D,b,this.F);break;case 4:il().bIb()(this.C).forEach(function(c){MDp(a.D,c,a.F)})}};u.iSc=function(){JDp(this.D)};function VDp(a,b){YDp(a);oq(a.Ja(b),!0)}
function WDp(a){a.H.setActive(!1);oq(a.Ja("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!1);oq(a.Ja("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!0)}function XDp(a){a.H.setActive(!0);oq(a.Ja("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!1);oq(a.Ja("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!0)}u.$ic=function(a){13===a.keyCode&&this.myb()};u.myb=function(){if(this.J){var a=new Pv("refresh-db-object-request");a.vGb=this.C;this.dispatchEvent(a)}};
function YDp(a){["waffle-dataconnector-refresh-all-dbobject-item-timestamp","waffle-dataconnector-refresh-all-dbobject-item-error","waffle-dataconnector-refresh-all-dbobject-item-loading","waffle-dataconnector-refresh-all-dbobject-item-running"].forEach(function(b){return oq(a.Ja(b),!1)})};function ZDp(a,b,c,d,e,f,h,k){uq.call(this,k);this.R=a;this.H=new Set(b);this.oa=c;this.V=c.O;this.F=[];this.X=f;this.ma=h;this.J=d;this.D=this.C=null;e&&(this.C=new $Dp(this.Da()),this.D=new a_k(this.J,this.Da(),!0));this.O=new Map([[1,0],[2,0],[3,0],[4,0],[5,0]])}z(ZDp,uq);u=ZDp.prototype;u.Ia=function(){if(this.D){var a=Nl("DIV","waffle-dataconnector-refresh-all-dbobject-list-parent");this.Ob(a);this.Pa(this.D,!0);this.D.setContent(Lq(PDp));mr(this.D.getElement(),"waffle-dataconnector-refresh-all-dbobject-list-collapsible")}else this.Ob(Lq(QDp))};
u.Qa=function(){uq.prototype.Qa.call(this);this.D||am(this.Ja("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),this.J);aEp(this);bEp(this);var a=this.getHandler();this.C&&(this.C.render(this.Ja("waffle-dataconnector-refresh-all-dbobject-list-footer-container")),a.listen(this.C,"action",this.v5c))};function cEp(a){var b=a.getHandler();a.F.forEach(function(c){b.Wd(c,"refresh-db-object-request",a.SNb)})}
function bEp(a){var b=a.getHandler();a.F.forEach(function(c){b.listen(c,"refresh-db-object-request",a.SNb)})}function aEp(a){var b=a.Ja("waffle-dataconnector-refresh-all-dbobject-list-items-container");a.H.forEach(function(c){var d=il().iY()(c);c=new TDp(c,dEp(a,d),d,a.oa,a.X,a.ma,a.Da());a.F.push(c);c.render(b)})}
function dEp(a,b){switch(b){case 1:return"Pivot table "+eEp(a,1);case 2:return"Chart "+eEp(a,2);case 3:return"Function "+eEp(a,3);case 4:return"Preview";case 5:return"Extract "+eEp(a,5);default:throw Error("Unexpected DbObjectType");}}function eEp(a,b){var c=a.O.get(b);a.O.set(b,c+1);return 0==c?"":c.toString()}function fEp(a){a.O.forEach(function(b,c,d){return d.set(c,0)})}
u.v5c=function(){var a=this,b=Array.from(this.H).filter(function(c){return g4c.has(QKk(a.V,c).D)});z8b.Nb(new eck(b,"all-objects-for-single-datasource",this.R))};u.SNb=function(a){a=a.vGb;g4c.has(QKk(this.V,a).D)&&z8b.Nb(new eck([a],"specific-ids"))};function gEp(a){a.F.forEach(function(b){return UDp(b)})}function hEp(a,b){a.C&&(b=b.filter(function(c){return ij(c,3)&&a.H.has(c.Iu())}),iEp(a.C,b))}u.expand=function(){this.D.Cl().Xc(!0)};u.hg=n("R");
function jEp(a,b){a.J=b;a.D?a.D.Cl().setContent(b):am(a.Ja("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),b)}u.Ya=function(a){this.C&&this.C.Ya(a);this.F.forEach(function(b){return b.Ya(a)})};function $Dp(a){uq.call(this,a);this.D=new dA("Refresh",this.Da());this.Pa(this.D);this.C=new efl;this.Pa(this.C)}z($Dp,uq);$Dp.prototype.Ia=function(){this.Ob(Lq(RDp))};
$Dp.prototype.Qa=function(){uq.prototype.Qa.call(this);this.D.render(this.Ja("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper"));this.C.render(this.Ja("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper"))};function iEp(a,b){var c=0;b.forEach(function(d){return c+=parseInt(d.zz(),10)});WJk(a.C,c);a.D.Ya(!0)}$Dp.prototype.Ya=function(a){this.D.Ya(a)};function kEp(a,b,c,d){uq.call(this,d);this.F=a;this.J=a.O;this.D=new uq;this.Pa(this.D);this.C=[];this.H=b;this.O=c}z(kEp,uq);kEp.prototype.Ia=function(){this.Ob(Lq(ODp))};kEp.prototype.Qa=function(){var a=this;uq.prototype.Qa.call(this);this.D.ub(this.Ja("waffle-dataconnector-refresh-all-datasources-container"));lEp(this);this.getHandler().listen(this.F.C,"ua",function(b){return mEp(a,b)})};
function lEp(a){var b=a.D.Se(!0);ji(b);a.C=[];b=nEp(a);if(1==b.size)b=b.entries().next().value,oEp(a,b[0],b[1],!1),mr(a.D.Ua(),"waffle-dataconnector-refresh-all-single-datasource-container");else{for(var c=ea(b.keys()),d=c.next();!d.done;d=c.next()){d=d.value;var e=b.get(d);oEp(a,d,e,!0)}or(a.D.Ua(),"waffle-dataconnector-refresh-all-single-datasource-container")}1<a.C.length&&a.C[0].expand()}
function pEp(a){var b=nEp(a);1!=b.size&&1!=a.C.length||b.size==a.C.length?(a.C.forEach(function(c){var d=c.hg();if(b.has(d)){var e=b.get(d);cEp(c);ji(c.F);c.F=[];fEp(c);c.H=new Set(e);aEp(c);bEp(c)}else qEp(a,c);b.delete(d)}),b.forEach(function(c,d){return oEp(a,d,c,!0)})):lEp(a)}function qEp(a,b){a.C=a.C.filter(function(c){return b!=c});ii(b)}function oEp(a,b,c,d){var e=il().fea()(b);e=Bw(a.F.C,e).Rg();b=new ZDp(b,c,a.F,e,d,a.H,a.O,a.Da());a.C.push(b);a.D.Pa(b,!0)}
function nEp(a){var b=new Map;DCp(a.J).forEach(function(c){var d=il().l8()(c);b.has(d)?b.get(d).push(c):b.set(d,[c])});return b}function rEp(a,b){a.C.forEach(function(c){return hEp(c,b)})}function sEp(a){a.C.forEach(function(b){b.C&&XJk(b.C.C)})}function tEp(a){a.C.forEach(function(b){b.C&&(b=b.C,RJk(b.C),b.D.Ya(!1))})}function uEp(a){a.C.forEach(function(b){return gEp(b)})}kEp.prototype.Ya=function(a){this.C.forEach(function(b){return b.Ya(a)})};
function mEp(a,b){3==Bw(a.F.C,b.ym).pj()&&(a=a.C.find(function(c){return c.J==b.C}))&&jEp(a,b.Dv)};function vEp(a,b,c){b=void 0===b?Dv.qb():b;Vr.call(this,"",void 0,c);a&&wEp(a);this.C=new xEp(a,b,c);this.Pa(this.C)}z(vEp,Vr);u=vEp.prototype;u.Ia=function(){this.C.Ia();this.Ob(this.C.Ua())};u.Ne=function(a){a.fw(!0);this.C.Ne(a)};u.$D=function(a,b){a.fw(!0);this.C.$D(a,b)};u.ul=function(a){return this.C.ul(a)};u.Fm=function(){return this.C.Fm()};u.Bg=function(){return this.C.C.map(function(a){return a.getValue()})};
function yEp(a,b){a=a.C;for(var c=ea(a.C),d=c.next();!d.done;d=c.next())d.value.Xc(!1);if(0==b.length)a.C=[];else{c=[];d=b.length;for(var e=0;e<a.Fm();e++){var f=a.ul(e),h=f.getValue();if(0<=b.indexOf(h)&&(f.Xc(!0),c.push(f),0==--d))break}a.C=c}a.y_()}u.Jc=function(){return this.C.Jc()};u.Ch=function(a){wEp(a);this.C.Ch(a)};u.bd=function(a){this.C.bd(a)};function wEp(a){for(var b=0;b<a.zd();b++)a.Nd(b).fw(!0)}function xEp(a,b,c){b=void 0===b?Dv.qb():b;RY.call(this,a,b,c);this.C=[]}z(xEp,RY);
xEp.prototype.Ch=function(a){RY.prototype.Ch.call(this,a);this.C=[];this.y_()};xEp.prototype.wA=function(a){a.stopPropagation();a=a.target;if(a.Me()){var b=this.Jc();Gia(this.C,a,function(c,d){return mg(Dq(b,c),Dq(b,d))})}else Xf(this.C,a);this.y_();this.dispatchEvent("change")};xEp.prototype.J=function(){var a;0==this.C.length?a=this.H:a=this.C.map(function(b){return b.Gl()}).join(", ");return a||""};function zEp(){var a='<div class="'+V("waffle-dataconnector-refresh-schedules-widget")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-header")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-top-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-header-title")+'"><span tabindex="0" class="'+V("waffle-dataconnector-refresh-schedules-title")+'" role="heading">';a=a+'Scheduled refresh</span></div><div class="'+(V("waffle-dataconnector-refresh-schedules-enable-switch")+
'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-spinner")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-setup-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-overview-section")+'"><span class="'+V("waffle-dataconnector-refresh-schedules-overview-text")+'"></span><span class="'+V("waffle-dataconnector-refresh-schedules-edit-btn")+'"></span></div><div class="'+V("waffle-dataconnector-refresh-schedules-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-fullview-text"></div><div><span class="'+
V("waffle-dataconnector-refresh-schedules-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(V("waffle-dataconnector-refresh-schedules-edit-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-frequency-select")+" "+V("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-edit-section-row")+
" "+V("waffle-dataconnector-refresh-schedules-edit-section-row-date")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-date-select")+" "+V("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-time-select")+" "+V("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-owner-info")+'"></div><div class="'+
V("waffle-dataconnector-refresh-schedules-btns")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-cancel-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-save-btn")+'"></div></div></div></div>');return Nq(a)};var AEp=new lt("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function BEp(a,b,c,d){RCp.call(this,a,b,c,d);this.Ka=of(pf(),"fdsrfu")?1:4;a=new ns;a.Pa(new js("Every day",1),!0);a.Pa(new js("Every week",2),!0);a.Pa(new js("Every month",3),!0);this.H=new RY(a,Dv.qb(),d);UOb(this.H,"Add frequency");this.H.bd("waffle-dataconnector-refresh-schedule-frequency");this.H.setContent("Frequency");this.Pa(this.H);this.D=new vEp(void 0,Dv.qb(),d);UOb(this.D.C,"Add date");this.D.bd("waffle-dataconnector-refresh-schedule-date");this.D.C.setContent("On date");this.Pa(this.D);
var e=this.Ka;a=new ns;var f=new Date(wa());c=Array(24);for(var h=0;24>h;h++){f.setHours(h,0,0,0);var k=new Date(f.getTime()),l=new Date(f.getTime());l.setHours(k.getHours()+e);l=w0k(k,l);c[k.getHours()]={value:h,label:l}}for(e=0;24>e;e++)f=new js(c[e].label,c[e].value),a.Pa(f,!0);this.J=new RY(a,Dv.qb(),d);UOb(this.J,"Add time");this.J.bd("waffle-dataconnector-refresh-schedule-time");this.J.setContent("Between");this.Pa(this.J);this.R=new dA("Cancel");this.Pa(this.R);this.V=new Zt("Save",d);this.V.Ya(!1);
this.Pa(this.V);this.X=new hs("",kx.qb(),d);this.Pa(this.X);this.Fa=new hs("Setup now",kx.qb(),d);this.Pa(this.Fa);this.Aa=new hs("",kx.qb(),d);this.Pa(this.Aa);this.F=new Hbk(d);this.F.dh("Enable schedule");this.Pa(this.F);this.oa=b;this.O=new r0k(d);this.O.hd("waffle-dataconnector-refresh-schedules-info-icon");this.O.setVisible(!1);this.Ga=new aZ(!0,"#0f9d58")}z(BEp,RCp);u=BEp.prototype;
u.Ia=function(){RCp.prototype.Ia.call(this);this.Ob(Lq(zEp));var a=this.Ja("waffle-dataconnector-refresh-schedules-title");a.id=wq(this,"waffle-dataconnector-refresh-schedules-title");fr(a,"heading");gr(this.Ua(),"labelledby",a.id);a=this.O.C;a.setContent(ih("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.O.render(this.Ja("waffle-dataconnector-refresh-schedules-header-title"));a=a.Ec();gr(this.O.Ua(),"labelledby",
a.id)};
u.Qa=function(){RCp.prototype.Qa.call(this);this.R.render(this.Ja("waffle-dataconnector-refresh-schedules-cancel-btn"));this.X.render(this.Ja("waffle-dataconnector-refresh-schedules-edit-btn"));this.F.render(this.Ja("waffle-dataconnector-refresh-schedules-enable-switch"));this.H.render(this.Ja("waffle-dataconnector-refresh-schedules-frequency-select"));this.V.render(this.Ja("waffle-dataconnector-refresh-schedules-save-btn"));this.Fa.render(this.Ja("waffle-dataconnector-refresh-schedules-setup-btn"));this.Aa.render(this.Ja("waffle-dataconnector-refresh-schedules-timezone-setting-btn"));
this.J.render(this.Ja("waffle-dataconnector-refresh-schedules-time-select"));this.D.render(this.Ja("waffle-dataconnector-refresh-schedules-date-select"));this.Ga.render(this.Ja("waffle-dataconnector-refresh-schedules-spinner"));CEp(this,!1);gOb(this.J,new er(null,13));this.getHandler().listen(this.X,"action",this.show).listen(this.R,"action",this.bjc).listen(this.V,"action",this.ejc).listen(this.Fa,"action",this.show).listen(this.F,"action",this.cjc).listen(this.H,"change",this.djc).listen(this.D,
"change",this.Gva).listen(this.J,"change",this.Gva).listen(this.Aa,"action",this.fjc).listen(this.Ua(),"keydown",this.ajc);0<Array.from(this.$a.C.keys()).length?(oq(this.Ua(),!0),YCp(this)):oq(this.Ua(),!1)};
u.refresh=function(){if(!this.isDisposed()){var a=this.Ja("waffle-dataconnector-refresh-schedules-edit-section"),b=this.Ja("waffle-dataconnector-refresh-schedules-overview-section"),c=this.Ja("waffle-dataconnector-refresh-schedules-fullview-section"),d=this.Ja("waffle-dataconnector-refresh-schedules-owner-info"),e=this.Ja("waffle-dataconnector-refresh-schedules-setup-btn"),f=this.Ja("waffle-dataconnector-refresh-schedules-enable-switch"),h=this.Ja("waffle-dataconnector-refresh-schedules-spinner");
oq(e,!1);oq(f,!1);oq(a,!1);oq(b,!1);oq(c,!1);oq(d,!1);oq(h,!1);qr(this.Ua(),"waffle-dataconnector-refresh-schedules-widget-opened",!1);var k=!1;this.O.setVisible(!1);switch(this.state){case 1:oq(e,!0);break;case 2:oq(c,!0);oq(a,!0);oq(d,!0);qr(this.Ua(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);k=!0;DEp(this);EEp(this);this.Gva();this.R.Ya(!0);this.O.setVisible(!0);break;case 3:oq(h,!0);break;case 5:oq(c,!0);oq(f,!0);oq(a,!0);oq(d,!0);qr(this.Ua(),"waffle-dataconnector-refresh-schedules-widget-opened",
!0);k=!0;FEp(this);DEp(this);EEp(this);a=zKk(this.C);this.F.Xc(!!kj(a,1));b=a.Uo().Uo();this.H.setValue(b);switch(b){case 1:CEp(this,!1);break;case 2:yEp(this.D,NX(a.Uo(),4).Lc());CEp(this,!0);break;case 3:yEp(this.D,NX(a.Uo(),5).Lc()),CEp(this,!0)}this.J.setValue(qj(a.Uo(),2));this.Gva();this.R.Ya(!0);this.O.setVisible(!0);break;case 4:oq(f,!0),oq(b,!0),FEp(this),b=this.Ja("waffle-dataconnector-refresh-schedules-overview-text"),ZCp(this)?(a=this.C.getStatus(),am(b,"Next: "),b=new Date(1E3*pj(a,2)),
a=new Date(1E3*pj(a,3)),this.X.setContent(mm(this.Da(),y0k(b,a,this.oa,!0,!0)))):(am(b,"Paused"),this.X.setContent("Edit"))}this.ma!=k&&(this.ma=k,this.dispatchEvent(k?"Wk":"Vk"))}};function FEp(a){var b=!!kj(zKk(a.C),1),c=su.isEnabled();a.F.Xc(b);a.F.Ya(c)}function DEp(a){var b=a.Ja("waffle-dataconnector-refresh-schedules-owner-info"),c="Will run as you.";a.C&&(a=mj(a.C.rc(4,nKk),1))&&(c+=" Currently running as "+a);am(b,c)}
function EEp(a){var b=a.Ja("waffle-dataconnector-refresh-schedules-fullview-text");if(ZCp(a)){var c=a.C.getStatus(),d=new Date(1E3*pj(c,2));c=new Date(1E3*pj(c,3));var e=a.Da();e.Se(b);e.appendChild(b,mm(e,qh(ih("Next: "),y0k(d,c,a.oa,!1,!0))))}else am(b,"");a.Aa.setContent(x0k(a.oa))}u.bjc=function(){GEp(this)};function GEp(a){a.state=2==a.state?1:4;a.refresh();a.Ja("waffle-dataconnector-refresh-schedules-title").focus()}
u.djc=function(){var a=this.H.getValue();yEp(this.D,[]);switch(a){case 1:CEp(this,!1);break;case 2:CEp(this,!0);a=this.D;var b=a.Ch,c=new ns,d=HEp();d=ea(d);for(var e=d.next();!e.done;e=d.next())e=e.value,c.Pa(new js(e.label,e.value),!0);a=b.call(a,c);ii(a);break;case 3:CEp(this,!0);a=this.D;b=a.Ch;c=new ns;for(d=1;28>=d;d++)c.Pa(new js(AEp.format({DAY:d}),d),!0);a=b.call(a,c);ii(a)}this.Gva()};
u.ejc=function(){this.V.Ya(!1);this.R.Ya(!1);var a=this.H.getValue(),b=GCp().X$(a);if(2===a){a=ea(this.D.Bg());for(var c=a.next();!c.done;c=a.next())c=c.value,Tva(b.Gb,4,vva).add(c)}else if(3===a)for(a=ea(this.D.Bg()),c=a.next();!c.done;c=a.next())c=c.value,Tva(b.Gb,5,vva).add(c);a=this.J.getValue();Aj(b,2,a);b=Aj(HCp().X$(b),3,1);2==this.state?(b.Ya(!0),R8b.Nb(b.qa())):(b.Ya(this.F.Me()),S8b.Nb(b.qa()))};
u.cjc=function(){var a=this;if(4==this.state){var b=this.F.Me();this.F.Xc(!b);this.F.Ya(!1);if(b){var c=IEp(this);c.render();c.setVisible(!0);c.getResult().then(function(){ii(c);T8b.Nb()},function(){ii(c);FEp(a)})}else U8b.Nb()}};u.ajc=function(a){27==a.keyCode&&this.ma&&(GEp(this),a.stopPropagation())};u.fjc=function(){dfc.Nb()};u.Gva=function(){var a=!!this.H.ej(),b=1===this.H.getValue()||0<this.D.Bg().length,c=!!this.J.ej(),d=su.isEnabled();this.V.Ya(a&&b&&c&&d)};u.focus=function(){this.Ja("waffle-dataconnector-refresh-schedules-title").focus()};
u.cpb=function(a){this.F.Ya(a)};function CEp(a,b){oq(a.Ja("waffle-dataconnector-refresh-schedules-edit-section-row-date"),b)}
function IEp(a){var b=new Ohl;b.hd("waffle-dataconnector-refresh-schedules-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=zKk(a.C);switch(c.Uo().Uo()){case 1:var d="Daily ";break;case 2:d=HEp();var e=NX(c.Uo(),4).Lc();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(NX(c.Uo(),5).Lc().map(function(l){return AEp.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=v0k(a.oa);var h=new Date(wa()),k=new Date(1E3*pj(f,2));f=new Date(1E3*pj(f,3));d+=w0k(k,f,c)+" ("+o1b(q1b(c,h))+")";a="Will run as "+mj(a.C.rc(4,nKk),1);a=qh(ih("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),oh("H4",void 0,"Schedule"),ih(d),oh("BR"),ih(a));zr(b,a);return b}u.SXa=function(){Vs.qb().postMessage(Xs("Error saving schedule.","error",!0));this.V.Ya(!0);this.R.Ya(!0);this.F.Ya(!0)};
function HEp(){var a=(cu.FIRSTDAYOFWEEK+1)%7,b=cu.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))};function JEp(a,b,c,d,e,f){dZ.call(this,f);this.F=b.O;this.O=a;this.V=d;this.G$=new kEp(b,c,this.V,this.Da());this.Pa(this.G$);this.D=new $Cp(this.F,f);this.Ca(this.D);this.C=null;this.X=of(pf(),"fdsrfu");this.J=null;this.R=e}z(JEp,dZ);u=JEp.prototype;u.Ia=function(){dZ.prototype.Ia.call(this);this.Ob(Lq(aDp,{id:this.getId()}));this.D.render(this.Ja("waffle-dataconnector-refresh-sidebar-footer-wrapper"))};
u.Qa=function(){var a=this;dZ.prototype.Qa.call(this);KEp(this);this.getHandler().listen(this,["Vk","Wk"],this.F6c);this.G$.render(this.Ja("waffle-dataconnector-refresh-sidebar-refresh-widget"));LEp(this,!0);this.getHandler().listen(this.D,"refresh-db-object-request",function(){var b=ECp(a.F);z8b.Nb(new eck(b,"all-objects-for-all-datasources"))});this.D.refresh();oq(this.Ja("waffle-dataconnector-refresh-sidebar-backdrop"),!1)};function MEp(a){null!=a.C&&(ii(a.C),ii(a.J),KEp(a))}
u.e_a=function(){null!=this.C&&this.C.show()};function NEp(a,b){rEp(a.G$,b);var c=0;b.forEach(function(d){return c+=parseInt(d.zz(),10)});a.D.Wu(c)}function LEp(a,b){a.G$.Ya(b);b?a.D.refresh():a.D.C.Ya(b)}
u.F6c=function(a){var b=this;a="Wk"===a.type;oq(this.Ja("waffle-dataconnector-refresh-sidebar-backdrop"),a);LEp(this,!a);Xp(this.Ec(),"overflow-y",a?"hidden":"auto");ii(this.J);a?(OEp(this),setTimeout(function(){if(b.C.Dc()){var c=b.C.Ua();b.J=new Qt(c,b.Da());b.Ca(b.J);Rt(b.J);c.focus()}},500)):this.resize()};function KEp(a){a.C=a.X?new xDp(a.F,a.O,a.R,a.Da()):new BEp(a.F,a.O,a.R,a.Da());a.Pa(a.C);a.C.render(a.Ua());oq(a.Ja("waffle-dataconnector-refresh-sidebar-backdrop"),!1)}
u.resize=function(){if(this.C)if(this.C.ma)OEp(this);else{var a=kq(this.Ec()).height-kq(this.C.Ua()).height,b=this.Ja("waffle-dataconnector-refresh-sidebar-refresh-widget");jq(b,a)}};function OEp(a){var b=kq(a.Ua()).height-kq(a.Ja("waffle-sidebar-title")).height-10;Xp(a.C.Ua(),"max-height",b+"px")};function PEp(a,b,c){LY.call(this,a,b);var d=this;this.C=c;this.F=new Hn;this.Ca(this.F);this.F.Bc(this.C.H,function(e){if("dbobjectmodel-event-add"==e.getType()||"dbobjectmodel-event-remove"==e.getType())e=d.xd,pEp(e.G$),0<ECp(e.F).length||e.dispatchEvent("close-sidebar");QEp(d);uEp(d.xd.G$)});this.D.listen(dx,"show-db-objects-refresh-sidebar",this.H)}z(PEp,LY);PEp.prototype.Gj=function(){return B8b};PEp.prototype.uv=function(){return C8b};
function QEp(a){var b=ECp(a.C),c=a.xd;0==b.length?FCp(c.D):(sEp(c.G$),gfl(c.D),m4j(a.C,b,function(d){a.isDisposed()||c.isDisposed()||NEp(c,d)},function(d){a.isDisposed()||c.isDisposed()||(d=new Q2c(d[0].Iu(),d[0].nj()),tEp(c.G$),c.D.jP(d))}))}PEp.prototype.H=function(a){var b=this;MEp(this.xd);QEp(this);MY(this);a.e_a&&this.xd.e_a();pm(function(){b.xd.Ua().focus()})};function REp(){to.apply(this,arguments)}z(REp,to);REp.prototype.C=function(){return PEp};REp.prototype.D=function(){return JEp};Do("dbrefresh",REp);
