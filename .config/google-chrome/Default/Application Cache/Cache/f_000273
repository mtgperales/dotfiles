function Xqh(a){return a.map(function(b){return new ajf(b.getId(),b.getName())})}ljf.prototype.D9=X(1696,function(a){a=Xqh(a);njf(this,a);ojf(this)});tjf.prototype.D9=X(1695,function(a){ljf.prototype.D9.call(this,a);ujf(this)});Knc.prototype.OP=X(1556,function(){if(!this.isDisposed()){var a=this.Da(qL.s3),b=af("Estimating\u2026");hf(a,b);this.yb()&&(Q(a,!0),a=this.Da(qL.LQ),Q(a,!1))}});Mnc.prototype.OP=X(1555,function(){this.C["refresh-query"].OP()});Unc.prototype.OP=X(1554,function(){this.C.OP()});
function Yqh(a){C.call(this,a)}v(Yqh,C);function Zqh(a){this.hb=eh(a,-1,0)}v(Zqh,hh);Zqh.prototype.toBuilder=function(){return new Yqh(this)};function $qh(){return Lw.getInstance().C.newDatasourceFromOnboarding}function arh(){return!!Lw.getInstance().C.showBigQueryProjectSelectionOnStart}function brh(a){var b=[];a.C.forEach(function(c,d){lh(c,2)||b.push(d)});return b}function crh(a){C.call(this,a)}v(crh,C);crh.prototype.hasError=function(){return this.message.hasError()};crh.prototype.getError=function(){return this.message.getError()};
function drh(a){this.hb=eh(a,-1,0)}v(drh,hh);drh.prototype.toBuilder=function(){return new crh(this)};drh.prototype.hasError=function(){return lh(this,1)};drh.prototype.getError=function(){return th(this,1,0)};function erh(a){C.call(this,a)}v(erh,C);erh.prototype.getStatus=function(){return this.message.getStatus()};erh.prototype.Fe=function(){return this.message.Fe()};erh.prototype.getNumberOfColumns=function(){return this.message.getNumberOfColumns()};erh.prototype.getNumberOfRows=function(){return this.message.getNumberOfRows()};
function frh(a){this.hb=eh(a,-1,0)}v(frh,hh);p=frh.prototype;p.toBuilder=function(){return new erh(this)};p.getStatus=function(){return th(this,6,0)};p.Fe=function(){return th(this,7,0)};p.getNumberOfColumns=function(){return sh(this,8)};p.getNumberOfRows=function(){return sh(this,9)};function grh(a){C.call(this,a)}v(grh,C);grh.prototype.getStatus=function(){return this.message.getStatus()};function hrh(a){this.hb=eh(a,-1,0)}v(hrh,hh);hrh.prototype.toBuilder=function(){return new grh(this)};
hrh.prototype.getStatus=function(){return th(this,1,0)};function irh(a){C.call(this,a)}v(irh,C);p=irh.prototype;p.qf=function(){return this.message.qf()};p.Sl=function(){return this.message.Sl()};p.Rf=function(){return this.message.Rf()};p.xq=function(){return this.message.xq()};p.getDataSourceId=function(){return this.message.getDataSourceId()};function jrh(a){this.hb=eh(a,-1,0)}v(jrh,hh);p=jrh.prototype;p.toBuilder=function(){return new irh(this)};p.qf=function(){return this.sb(1,Gh)};
p.Sl=function(){return ph(this,2)};p.Rf=function(){return rh(this,3)};p.xq=function(){return lh(this,5)};p.getDataSourceId=function(){return ph(this,5)};function krh(a){var b=void 0===b?jh(jrh):b;b=new irh(b);return Fh(b,1,a)}function lrh(a){C.call(this,a)}v(lrh,C);function mrh(a){this.hb=eh(a,-1,0)}v(mrh,hh);mrh.prototype.toBuilder=function(){return new lrh(this)};function nrh(a){C.call(this,a)}v(nrh,C);function orh(a){this.hb=eh(a,-1,0)}v(orh,hh);orh.prototype.toBuilder=function(){return new nrh(this)};
function prh(a,b){return Dh(a,1,b)}function qrh(a){C.call(this,a)}v(qrh,C);qrh.prototype.UT=function(a){return this.message.UT(a)};function rrh(a){this.hb=eh(a,-1,0)}v(rrh,hh);rrh.prototype.toBuilder=function(){return new qrh(this)};rrh.prototype.UT=function(a){return vh(this,2,a,jrh)};function srh(a){C.call(this,a)}v(srh,C);srh.prototype.UT=function(a){return this.message.UT(a)};function trh(a){this.hb=eh(a,-1,0)}v(trh,hh);trh.prototype.toBuilder=function(){return new srh(this)};
trh.prototype.UT=function(a){return vh(this,1,a,jrh)};function urh(a){C.call(this,a)}v(urh,C);urh.prototype.getStatus=function(){return this.message.getStatus()};function vrh(a){this.hb=eh(a,-1,0)}v(vrh,hh);vrh.prototype.toBuilder=function(){return new urh(this)};vrh.prototype.getStatus=function(){return th(this,1,0)};
function wrh(a,b){return new Sm(function(c,d){dp(Jl(Kl(Gl(ep(Fl(a.C.Oe("/answers/tablemetadata"),"did",b),"POST"),2),function(e){e=ih(drh,JSON.stringify(e.we()));c(e)}),function(){d()})).Qe()})}function xrh(a,b){return new Sm(function(c,d){wH(a,"/dbx/createDelegation",[],b.qb(),function(e){c(ih(hrh,JSON.stringify(e.we())))},d)})}function yrh(a,b){return new Sm(function(c,d){wH(a,"/dbx/updateDelegation",[],b.qb(),function(e){c(ih(vrh,JSON.stringify(e.we())))},d)})}
function zrh(a){Date.now()-a.D>a.F&&a.clearCache()}function Arh(a,b){return a.C.has(b)?a.C.get(b):null}function Brh(a,b){var c=new Set;b.forEach(function(d){a.ea.add(d);c.add(d)});Q3b(a,c,"dbobjectmodel-event-update")}function Crh(a,b){a.D&&a.F&&b.forEach(function(c){a.D.C.has(c)?Arh(a.D,c)||a.F.C(116202):a.F.C(1162031)})}function Drh(a,b){a.F.C(36994);b||a.F.C(36995)}
function Erh(a,b,c,d){pse(a.J,b,function(e){var f=e.filter(function(h){return 2==h.qf().getState()});c(f);e=e.filter(function(h){return 2!=h.qf().getState()});d(e)},d,!0,2)}
function Frh(a,b){if(a.O&&b&&a.F){b=N().dOb()(b.gb());zd(b)||zrh(a.D);for(var c=[],d=0;d<b.length;d++){var e=b[d];a.D.C.has(e)?(e=Arh(a.D,e),Drh(a,e)):c.push(e)}zd(c)||Erh(a,c,function(f){f.forEach(function(h){h=h.Sl();a.D.C.set(h,!0);Drh(a,!0)})},function(f){f.forEach(function(h){var k=h.qf();k=lh(h,1)&&37==k.getErrorCode();h=h.Sl();a.D.C.set(h,!k);Drh(a,!k)})})}}function Grh(a,b,c,d){pse(a.J,b,function(e){var f=e.filter(function(h){return 2!=h.qf().getState()});0==f.length?c(e):d(f)},d,!0)}
function Hrh(a,b,c,d){v5e(a.J,b,c,d,!0)}function Irh(a){var b=vH.getInstance();return new Sm(function(c,d){k5e(b,"/dbx/delegations",function(e){c(ih(orh,JSON.stringify(e.we())))},d,["data",a.qb()])})}function Jrh(a){var b=vH.getInstance();return new Sm(function(c,d){wH(b,"/charts/score",[],a.qb(),function(e){e=ih(frh,JSON.stringify(e.we()));c(e)},d)})}function Krh(a){var b=vH.getInstance();b.F=a;b.C&&b.F.pE(b.C)}
function Lrh(a,b,c){return new Sm(function(d,e){Aw(c,function(){wH(a,"/dbx/refreshSlicerObject",a.D?["esid",a.D]:[],b.qb(),function(f){f=ih(trh,JSON.stringify(f.we()));d(f)},function(){var f=kQ(jQ().Db(3),31).build();f=krh(f).build();var h=void 0===h?jh(trh):h;h=new srh(h);f=Dh(h,1,f).build();e(f)})})})}
function Mrh(a,b,c){return new Sm(function(d,e){Aw(c,function(){wH(a,"/dbx/refreshObject",a.D?["esid",a.D]:[],b.qb(),function(f){f=ih(rrh,Al(f.we(),hma));d(f)},function(){var f=kQ(jQ().Db(3),31).build();f=krh(f).build();var h=void 0===h?jh(rrh):h;h=new qrh(h);f=Dh(h,2,f).build();e(f)})})})}
function Nrh(a,b,c){return new Sm(function(d,e){Aw(c,function(){wH(a,"/dbx/validateCalculatedColumn",[],b.qb(),function(f){f=ih(f5e,JSON.stringify(f.we()));d(f)},function(){var f=kQ(jQ().Db(3),31).build();f=g5e(f).build();e(f)})})})}function Orh(a){return a.D["ritz-DisplayCountBigsheetsPromo"]}function Prh(a){a.ma&&a.ma.fd(a.La(),a.ea?5:1,new rq(0,a.ea?50:0,12,a.ea?0:50))}
function Qrh(a,b,c,d,e,f,h,k,l){vJ.call(this,a,b,c,d,e,l);this.F=new Unc(h,d.qc(),k,l);this.Ia(this.F,!0);this.H=f;this.D=null}v(Qrh,vJ);Qrh.prototype.Ca=function(){var a=this.qa().Ca("DIV","waffle-dbsource-container");this.mb(a)};Qrh.prototype.Ja=function(){vJ.prototype.Ja.call(this);this.D=new Bw(this.La(),this.qa());Cw(this.D)};Qrh.prototype.Cd=function(){Xf(this.D);vJ.prototype.Cd.call(this)};
Qrh.prototype.focus=function(){var a=this.F;a.D.isVisible()&&a.D.isEnabled()&&(a.D.La().focus(),a.D.Np(!0));this.H.Db(2)};function Rrh(a){var b=a.O.C.C;if(JC(b))return N().YWa()(b.gb());(b=G6e(a))||(b=(b=EEc(a))?FEc(a,b):null);if(b||(b=(b=H6e(a))?N().RZ()(b):null))return b;b=wG(a.Ta());return FEc(a,b)}function Srh(a,b){[a.O,a.Ha].forEach(function(c){return c.setPosition(b)});a.D.some(function(c){c.C.setPosition(b)})}
function Trh(){var a=vH.getInstance(),b=Urh();return new Sm(function(c){wH(a,"/dbx/getBigsheetsPromoRelevance",[],b.qb(),function(d){d=ih(mrh,JSON.stringify(d.we()));c(d)},function(){var d=void 0===d?jh(mrh):d;d=new lrh(d);d=Ch(d,1,0).build();c(d)})})}function Vrh(a){a=a||{};return v$e(a.color,a.$kc)}
function Wrh(){var a=new ox,b="Configure a project in the Google Cloud Platform console to continue. "+(a.Hc("a",{"class":"goog-inline-block",href:"https://connectedsheets.page.link/addproject",target:"_blank"})+("Learn more"+a.Gc("a")));return a.format(b)}function Xrh(a){C.call(this,a)}v(Xrh,C);function Yrh(a,b){return Ah(a,1,b)}Xrh.prototype.Gd=function(){return this.message.Gd()};function Zrh(a,b){return Ah(a,2,b)}function $rh(a){this.hb=eh(a,-1,0)}v($rh,hh);$rh.prototype.toBuilder=function(){return new Xrh(this)};
$rh.prototype.Gd=function(){return ph(this,2)};function ash(){var a=void 0===a?jh($rh):a;return new Xrh(a)}function bsh(a){C.call(this,a)}v(bsh,C);function csh(a,b){return Fh(a,2,b)}function dsh(a){this.hb=eh(a,-1,0)}v(dsh,hh);dsh.prototype.toBuilder=function(){return new bsh(this)};function esh(){var a=void 0===a?jh(dsh):a;return new bsh(a)}function fsh(a){C.call(this,a)}v(fsh,C);function gsh(a){this.hb=eh(a,500,0)}v(gsh,hh);gsh.prototype.toBuilder=function(){return new fsh(this)};
function Urh(){return jh(gsh)}function hsh(a){C.call(this,a)}v(hsh,C);function ish(a){var b=void 0===b?jh(jsh):b;b=new hsh(b);return yh(b,1,a)}function jsh(a){this.hb=eh(a,-1,0)}v(jsh,hh);jsh.prototype.toBuilder=function(){return new hsh(this)};function ksh(){var a=void 0===a?jh(orh):a;return new nrh(a)}function lsh(a){C.call(this,a)}v(lsh,C);function msh(a){this.hb=eh(a,-1,0)}v(msh,hh);msh.prototype.toBuilder=function(){return new lsh(this)};function nsh(a){C.call(this,a)}v(nsh,C);
function osh(a){this.hb=eh(a,-1,0)}v(osh,hh);osh.prototype.toBuilder=function(){return new nsh(this)};function psh(a){C.call(this,a)}v(psh,C);function qsh(a,b){return Ah(a,1,b)}function rsh(a,b){return Fh(a,2,b)}function ssh(a){this.hb=eh(a,-1,0)}v(ssh,hh);ssh.prototype.toBuilder=function(){return new psh(this)};function tsh(){var a=void 0===a?jh(ssh):a;return new psh(a)}function ush(a,b){return{title:a,body:b}}function z3(a){return ush("Query failed",a)}
function vsh(a){return a?yXb[a]||"other":"other"}
function wsh(a,b){var c=b.getErrorCode(),d=b.zj();if(0==a)return z3(ibf(d));switch(c){case 36:case 20:case 56:case 55:case 45:case 46:case 49:case 50:case 51:case 53:case 54:return z3(jbf(3,d,b));case 37:return z3(Xaf(d));case 6:return a=(new Iv("{objectType, select, chart {The data source took too long to return this chart. Please try again.} pivot_table {The data source took too long to return this pivot table. Please try again.} formula {The data source took too long to return this formula result. Please try again.} record {The data source took too long to return this extract. Please try again.} datasource_preview {The data source took too long to return this preview. Please try again.} other {The data source took too long to return data. Please try again.}}")).format({objectType:vsh(a)}),ush("Timed out",
hbf(a,d));case 8:return b=zXb.format(y(A(),"febpr")?5E4:3E4),c=zXb.format(y(A(),"femdrr")?5E4:25E3),b=(new Iv("{objectType, select, chart {Results exceed {maxRows} rows. Update this chart and try again.}pivot_table {Update the number of rows and/or columns to a maximum of {dbPivotTableMaxRows} by using filtering, grouping, or customizing number of rows and/or columns. Then, try again.}formula {Results exceed {maxRows} rows. Update this function and try again.} record {Results exceed {dbRecordMaxRows} rows. Update this extract and try again.} datasource_preview {Results exceed {maxRows} rows. Update this connected sheet and try again.} other {Results exceed {maxRows} rows. Update this query and try again.}}")).format({objectType:vsh(a),
maxRows:AXb,dbPivotTableMaxRows:b,dbRecordMaxRows:c}),ush(1==a?"Rows and/or columns exceed limit":"Too many rows",hbf(b,d));case 18:return ush("Unsupported type",wV("The query returns a type which is currently not supported."));case 19:return z3($af());case 22:return z3(abf());case 26:return z3(wV("The column type of connected data is not compatible with the operation."));case 30:return z3(wV("Sorting by an array column is not supported for connected sheets and extracts."));case 32:return ush("Too many customized number of rows & columns",
wV("Your pivot table contains one or more array database columns. Only one can have customized number of rows or columns."));case 33:return z3(cbf());case 35:return(d=b.sb(13,Zqh))&&qh(d,1)&&0<qh(d,1).Gb().length?(d=qh(d,1).Gb()[0],a=(new Iv('{objectType, select, chart {The column named "__ITALICS_START_MARKER'+(d+('__ITALICS_END_MARKER" referenced by this chart is not available.} pivot_table {The column named "__ITALICS_START_MARKER'+(d+('__ITALICS_END_MARKER" referenced by this pivot table is not available.} formula {The column named "__ITALICS_START_MARKER'+
(d+('__ITALICS_END_MARKER" referenced by this formula is not available.} record {The column named "__ITALICS_START_MARKER'+(d+('__ITALICS_END_MARKER" referenced by this extract is not available.} datasource_preview {The column settings do not match the data source. Try removing sorts, filters and calculated columns that reference the column named "__ITALICS_START_MARKER'+(d+('__ITALICS_END_MARKER" and try again.} other {The column named "__ITALICS_START_MARKER'+(d+'__ITALICS_END_MARKER" referenced by this object is not available.}}'))))))))))))).format({objectType:vsh(a)}),
d=new ox,a=d.format(a.replace("__ITALICS_START_MARKER",d.Hc("i")).replace("__ITALICS_END_MARKER",d.Gc("i")))):a=(new Iv("{objectType, select, chart {A column referenced by this chart is not available.} pivot_table {A column referenced by this pivot table is not available.} formula {A column referenced by this formula is not available.} record {A column referenced by this extract is not available.} datasource_preview {The column settings do not match the data source. Try removing sorts, filters and calculated columns and try again.} other {A column referenced by this object is not available.}}")).format({objectType:vsh(a)}),
a=wV(a),z3(a);case 34:return a=(new Iv("{objectType, select, chart {A calculated column referenced by this chart no longer exists. Update and try again.} pivot_table {A calculated column referenced by this pivot table no longer exists. Update and try again.} formula {A calculated column referenced by this formula no longer exists. Update and try again.} record {A calculated column referenced by this extract no longer exists. Update and try again.} datasource_preview {A calculated column referenced by this preview no longer exists. Update and try again.} other {A calculated column referenced by this object no longer exists. Update and try again.}}")).format({objectType:vsh(a)}),
a=wV(a),z3(a);case 38:return z3(ibf(null));case 39:return z3(bbf());case 40:return z3(wV("A calculated column has an invalid formula. Update and try again."));case 15:return z3(Yaf(ph(b,6).toUpperCase()));case 14:return z3(Zaf(ph(b,6).toUpperCase()));case 42:return z3(dbf());case 43:return z3(ebf());case 44:return z3(fbf());case 47:return z3(wV("The delegated access settings are invalid. The delegated access has been disabled. Please refresh again."));case 48:return z3(wV("Refresh using delegation is unavailable now. Please disable delegated access in connection settings or try again later."));
case 52:return z3(wV("You can not refresh with delegated credentials because you are not in the same organization as the credential owner."))}return z3(ibf(d))}
function xsh(a,b){a=wsh(a,b);var c;if(lh(b,11)&&lh(b.sb(11,Dpa),5)){var d=b.sb(11,Dpa);if((c=ph(d.Cf(),2))&&0!=c.length){var e=ph(d.sb(8,Bpa),2),f=!!e&&0<e.length,h=lh(b,8)&&0<rh(b,8),k=new Date(rh(b,8)),l=(new jx(1)).format(k);k=(new jx(5)).format(k);2==th(d,1,0)?d=h?"A scheduled refresh created by "+(c+(" failed at "+(k+(" on "+(l+". \n\n"))))):"A scheduled refresh created by "+(c+" failed. \n\n"):(d=h?f?"A query created by "+(c+(" using "+(e+("'s credentials failed at "+(k+(" on "+(l+". \n\n"))))))):
"A query created by "+(c+(" failed at "+(k+(" on "+(l+". \n\n"))))):f?"A query created by "+(c+(" using "+(e+"'s credentials failed. \n\n"))):"A query created by "+(c+" failed. \n\n"),b=b.getErrorCode(),h=y(A(),"fedbvs")&&53==b,f&&(37==b||52==b||h)&&c!=e&&Wx.isEnabled()&&y(A(),"fedd")&&(d+="To attempt refreshing using your own credentials, disable delegated access in connection settings and try again. \n\n"));c=df("span",{"class":"waffle-dataconnector-error-user"},cf(d))}else c=null}else c=null;if(!c)return a;
c=ef([c,a.body]);return{title:a.title,body:c}}function ysh(a,b,c,d){this.D=a;this.C=b;this.F=c;this.H=d}ysh.prototype.Sl=g("D");ysh.prototype.gb=g("H");function zsh(a){var b=rV(a);a=ph(b,5);b=b.sb(4,hV);var c=ph(b,3)||"";b=c+(c?".":"")+ph(b,2)+"."+b.getName();b=N9e("select * from `"+b+"`");a=Ah(b,5,a).build();b=taf();b=Ch(b,2,2);return raf(b,a).build()}
function Ash(){var a='<div class="'+U("waffle-bigquerydbsourcesettingsdialog-project-section")+'"><div class="'+U("waffle-bigquerydbsourcesettingsdialog-project-heading")+'"><h3 class="'+U("waffle-bigquerydbsourcesettingsdialog-project-title")+'">';a=a+'Choose a cloud project</h3></div><div class="'+(U("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper")+'"></div></div>');return T(a)}
function Bsh(){var a='<div class="'+U("waffle-bigquerydbsourcesettingsdialog-footer-wrapper")+'"><p class="'+U("waffle-bigquerydbsourcesettingsdialog-footer-message")+'">';return T(a+'Your use of BigQuery is governed by the <a href="https://cloud.google.com/terms/" target="_blank">Google Cloud Platform Terms of Service</a>.</p></div>')}
function Csh(a,b,c,d){xW.call(this,"waffle-bigquerydbsourcesettingsdialog",d);d=c?"Edit data connection":"Add data connection";this.setTitle(this.qa().Ca("SPAN",void 0,d));this.L=a;this.J=b;this.O=c||null;this.C=new tjf(void 0,this.qa());this.Ia(this.C);this.F=null;this.D=new Mjf(this.qa());this.D.Ob("waffle-bigquerydbsourcesettingsdialog-info-icon");this.D.setVisible(!1);this.Ia(this.D)}v(Csh,xW);
Csh.prototype.Ca=function(){xW.prototype.Ca.call(this);Er(this.zb(),Ash);qW(this).appendChild(Gr(Bsh));var a=this.D.C;a.Ob("waffle-bigquerydbsourcesettingsdialog-info-bubble");a.setPosition(2,2,0,-8);var b="Displaying the top "+(KVb.format(1E4)+" projects. To use an unlisted project, enter the full project ID in the search bar and press enter.");a.setContent(af(b));this.D.render(this.$a("waffle-bigquerydbsourcesettingsdialog-project-heading"));gs(this.D.La(),b);this.C.render(this.$a("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper"));
(this.C.cj||null).setAttribute("placeholder","Search projects");this.qa().Kh(this.C.La(),!1)};Csh.prototype.Ja=function(){var a=this;xW.prototype.Ja.call(this);this.C.Ll(!0);Zif(this.L).then(function(b){a.yb()&&(b&&0!=b.length||a.J.C(36566),Dsh(a,b),a.C.Ll(!1))},function(){a.yb()&&(a.J.C(36685),bv.getInstance().postMessage(dv("Could not connect to BigQuery","error",!0)),Dsh(a,[],!0),a.C.Ll(!1))})};
function Dsh(a,b,c){c=void 0===c?!1:c;a.D.setVisible(!0);if(arh()){var d=new tZd;K(d,1,b.length);var e=new nj;Pi(e,43,d);a.J.C(116185,tq(xq(new sq,e),19).build())}0!=b.length||c?(a.C.D9(b),a.getHandler().listen(a.C,"action",function(f){return Esh(a,f,b)})):(c=a.qa(),d=zk(c,Wrh()),Q(a.Da("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper"),!1),c.appendChild(a.Da("waffle-bigquerydbsourcesettingsdialog-project-section"),c.Ca("DIV","waffle-bigquerydbsourcesettingsdialog-error-caption",d)))}
function Esh(a,b,c){b=b.target.Ta();var d=b instanceof ajf?b.bR:b.getValue();ks(a.La(),"waffle-bigquerydbsourcesettingsdialog-transition-out");pjf(a.C).then(function(){return a.resolve(new Yif(c,d,d,"db-source-table",a.O))})}
function Fsh(a){a.F=new Gw("Pick your GCP project","Get started by selecting the Google Cloud project containing the dataset you need. You may change the billing project in the next step.",a.Da("waffle-bigquerydbsourcesettingsdialog-project-section"),a.qa(),"waffle-bigquerydbsourcesettingsdialog-tooltip");a.F.setPosition(0,2);Kt(a.F,!1);a.F.render(a.zb());a.getHandler().Ue(a.F.cJ(),Hm,function(){a.F.setVisible(!1)})}
function Gsh(){var a='<div class="'+U("waffle-bigquerywrongskudialog-message")+'">';return T(a+"Thank you for your interest in connected sheets. Unfortunately, you don't have the required G Suite license to gain access.</div>")}function Hsh(){return T('<div class="'+U("waffle-bigquerywrongskudialog-learn-more-wrapper")+'"></div>')}
function Ish(a){pW.call(this,"waffle-bigquerywrongskudialog",a);this.setTitle(this.qa().Ca("SPAN",void 0,"Upgrade to get access"));this.C=new Ow("Learn more",this.qa());this.Ia(this.C)}v(Ish,pW);
Ish.prototype.Ca=function(){pW.prototype.Ca.call(this);Er(this.zb(),Gsh);qW(this).appendChild(Gr(Hsh));this.C.render(this.Da("waffle-bigquerywrongskudialog-learn-more-wrapper"));this.getHandler().listen(this.C,"action",function(){zr("https://connectedsheets.page.link/support")});var a=this.Da("waffle-bigquerywrongskudialog-message");a.id=vr(this,"waffle-bigquerywrongskudialog-message");ds(this.La(),"describedby",a.id)};
function Jsh(a,b,c,d,e,f,h,k,l){qV.call(this,d,h,k,l);this.F=a;this.ma=b;this.Aa=c;this.Ea=f;this.xa=e}v(Jsh,qV);Jsh.prototype.Ca=function(){qV.prototype.Ca.call(this);this.mb(Gr(kbf,{sO:!1}))};Jsh.prototype.Ja=function(){qV.prototype.Ja.call(this);null!=this.ma&&(this.C.setValue(N().ZNb()(this.ma.qb(),this.F)),this.canEdit&&this.iU())};Jsh.prototype.k_a=function(){return this.xa.getRitzFormulaValidationResultForCalculatedColumn(this.F,naf(this),MWb(this.Aa))};
Jsh.prototype.rcb=function(a){var b=this;this.J=!0;this.$qa();a=mbf(nbf(pbf(),this.F),a).build();Nrh(vH.getInstance(),a,this.Ea).then(function(c){c=c.qf();3==c.getState()?(c="BigQuery error: "+c.zj(),laf(b,!1,c)):laf(b,!0,null);maf(b)},function(){laf(b,!1,null);maf(b)})};function Ksh(a,b,c){yV.call(this,a,b,c)}v(Ksh,yV);Ksh.prototype.Ja=function(){yV.prototype.Ja.call(this)};Ksh.prototype.Saa=function(){this.C.Ob("waffle-calculated-columns-tooltip-help-bubble");yV.prototype.Saa.call(this)};
Ksh.prototype.J=function(){tbf(this,"https://connectedsheets.page.link/calccolhelp");var a="="+(N().vq()("RIGHT")+"(orderId, 4)");var b="="+(N().vq()("YEAR")+"(startDate)");var c="="+(N().vq()("IF")+"(units > 0, total/units, 0)");this.C.setContent(this.qa().Ca("DIV",void 0,zV("waffle-db-object-formula-tooltip-help-bubble-title","Try these formulas"),zV("waffle-db-object-formula-tooltip-help-bubble-subtitle","Do basic math"),zV("waffle-db-object-formula-tooltip-help-bubble-example","=price * quantity"),
zV("waffle-db-object-formula-tooltip-help-bubble-subtitle","Manipulate text"),zV("waffle-db-object-formula-tooltip-help-bubble-example",a),zV("waffle-db-object-formula-tooltip-help-bubble-subtitle","Use dates"),zV("waffle-db-object-formula-tooltip-help-bubble-example",b),zV("waffle-db-object-formula-tooltip-help-bubble-subtitle","Apply conditional logic"),zV("waffle-db-object-formula-tooltip-help-bubble-example",c),this.KO))};function Lsh(a){C.call(this,a)}v(Lsh,C);Lsh.prototype.Gd=function(){return this.message.Gd()};
Lsh.prototype.Pl=function(){return this.message.Pl()};function Msh(a){this.hb=eh(a,-1,0)}v(Msh,hh);Msh.prototype.toBuilder=function(){return new Lsh(this)};Msh.prototype.Gd=function(){return ph(this,1)};Msh.prototype.Pl=function(){return ph(this,3)};function Nsh(a,b,c,d,e){PG.call(this,153);this.D=a;this.J=b;this.C=c||"";this.O=d;this.L=e}v(Nsh,PG);
Nsh.prototype.Nd=function(){var a=void 0===a?jh(Msh):a;a=new Lsh(a);a=Ah(a,1,this.D);a=Ah(a,4,this.J);a=Ah(a,3,this.C);a=Ah(a,2,this.O);return zh(a,5,this.L).build()};function Osh(a,b,c){Cm.call(this,a);this.hn=b;this.C=c}v(Osh,Cm);
function Psh(a,b,c,d,e,f,h,k,l,n,q){oV.call(this,a,null==b,e,f,n,q);this.sf=new Ksh(n,q,this.qa());this.Ia(this.sf);this.xa=b;null==b?b=null:(e=Xpa(),e.oi(1,2),b=Ah(e,2,b).build());this.R=b;this.Wa=c;this.Ra=d;this.F=new Jsh(a,this.R,d,f,k,l,n,q,this.qa());this.Ia(this.F);this.Sa=h}v(Psh,oV);p=Psh.prototype;p.Na=function(){oV.prototype.Na.call(this)};
p.Ca=function(){oV.prototype.Ca.call(this);var a=null==this.xa?"Add calculated column":this.canEdit?"Edit calculated column":"View calculated column";this.setTitle(a);var b=dYa(this);b&&gs(b,a);a=Gr(rbf,{canEdit:this.canEdit,BUa:"Calculated column name",description:"Calculated columns let you create new columns for better analysis by using Sheets functions and the current data in your connected sheet."});b=this.zb();this.qa().appendChild(b,a);this.sf.render(this.Da(nV.TOOLTIP));this.F.render(this.Da(nV.IJa))};
p.Ja=function(){oV.prototype.Ja.call(this);null!=this.R&&(this.C.setValue(aG(this.R,this.hn)),this.KAa());this.Mba();this.getHandler().listen(this.F,"validation-update",this.Mba)};p.Cd=function(){oV.prototype.Cd.call(this)};p.w$a=function(){for(var a=[],b=ha(this.Wa),c=b.next();!c.done;c=b.next())c=c.value,lh(fH(c),2)||a.push(c);U$e(this,a)};p.aHa=function(){var a=hWb(this.ea,!1,!1,!0,!1);S$e(this.L,a)};
p.a2a=function(){var a=this,b=naf(this.F);if(!$d(b)){var c=null==this.xa;b=new Nsh(this.hn,B4e(this.C.getValue()),this.xa,b,brh(this.Ra));var d=c?36645:36647,e=c?36644:36646;QG(b,function(f){a.ma.C(f?e:d,a.Sk);f&&a.dispatchEvent(new Osh("update",a.hn,c))});this.Sa.C(b)}};p.e0a=function(a){a=a.target.getValue();a=QVb(a,this.hn);oaf(this.F,a)};p.N0a=function(a){a=a.target.getValue().getName();paf(this.F,a)};
p.Zqa=function(){if(rf(this.C.getValue()))var a=null;else a:{var b=this.Ra,c=this.C.getValue();a=this.R;c=B4e(c);if($d(c))a="Calculated column name cannot be empty";else{for(var d=ha(b.C.keys()),e=d.next();!e.done;e=d.next())if(e=e.value,Zd(e,c))if(d=null!=a,b=b.C.get(e),d&&a.equals(b))break;else{a="A column named "+(c+" already exists");break a}a=null}}return a};p.d4a=function(){return this.F.L};
function Qsh(){var a='<div class="'+U("waffle-dbanswers-answers-bar")+'"><div class="'+U("waffle-dbanswers-answers-bar-controls")+'"><div class="'+U("waffle-dbanswers-answers-bar-input")+'"></div><div class="'+U("waffle-dbanswers-answers-bar-enable-button")+'">';a=a+'Enable</div></div><div class="'+(U("waffle-dbanswers-answers-bar-message")+'"></div></div>');return T(a)}
function Rsh(){var a='<div class="'+U("waffle-dbanswers-answers-bar-enable-answers-popup")+'">',b='To perform natural language queries on this data, ask the table owner or admin to follow the <div class="'+(U("waffle-dbanswers-answers-bar-enable-answers-popup-setup-link")+'">setup instructions.</div>');return T(a+b+"</div>")}function Ssh(a,b){S.call(this,b);this.F=a;this.C=new Gt;Ht(this.C,0);vZa(this.C,5,5,5,5);Vpe(this.C,!0);this.oa(this.C);this.D=new Mt(null,new GO,this.qa());this.Ia(this.D)}
v(Ssh,S);p=Ssh.prototype;p.Ca=function(){var a=Gr(Rsh);this.mb(a);ds(a,"hidden",!0);Q(a,!1);this.C.hv(a);this.D.Va(this.$a("waffle-dbanswers-answers-bar-enable-answers-popup-setup-link"))};p.Ja=function(){S.prototype.Ja.call(this);this.getHandler().listen(this.D,"action",this.Efc)};p.wi=function(a){this.C.setPosition(new Xt(a,0,!0))};p.setVisible=function(a){this.C.setVisible(a);a&&this.D.La().focus()};p.isVisible=function(){return this.C.isVisible()};p.fd=function(){this.C.fd()};
p.Efc=function(a){a.stopPropagation();a.preventDefault();a=tq(new sq,75).build();this.F.C(36761,a);y(A(),"docs-idu")?pf("https://sites.google.com/corp/google.com/data-qna#h.p_Vf6xbc97l9jL"):pf("https://docs.google.com/document/u/1/d/e/2PACX-1vRNytdUb20j3I6WPQXLmmIfOHkWR3a0iPg4ck1AdXzSznrW3USl3NtYGIk34sBQaxl_fSiUPclFqJK4/pub?urp=gmail_link#h.ng0zmdirli5c")};
function Tsh(a,b,c,d,e,f){zW.call(this,a,b,c,sXb.getInstance(),"db",d,e,f);this.D="";this.R=0;this.xa=new nP(void 0,this.qa());this.Ia(this.xa);this.ea=new Ssh(b,this.qa());this.Ia(this.ea);this.ma=null}v(Tsh,zW);p=Tsh.prototype;p.Ic=function(a){this.mb(a);var b=Gr(Qsh);this.qa().appendChild(a,b);a=this.$a("waffle-dbanswers-answers-bar-input");this.H.render(a);this.xa.Va(this.$a("waffle-dbanswers-answers-bar-enable-button"));this.ea.render();this.ea.wi(this.xa.La())};
p.Ja=function(){zW.prototype.Ja.call(this);this.c0()};p.c0=function(){zW.prototype.c0.call(this);this.getHandler().listen(this.xa,"action",this.r4b)};p.pI=function(){return VF(this.J.C)&&y(A(),"feda")&&!et().C?zW.prototype.pI.call(this):!1};p.Oa=function(a){this.yb()&&(0!=this.R&&y(A(),"fedaic")?(zW.prototype.Oa.call(this,!1),Ush(this,!0)):(Ush(this,!1),zW.prototype.Oa.call(this,a)))};p.eQ=function(){zW.prototype.eQ.call(this);this.ea.isVisible()&&this.ea.fd()};
p.N2a=function(a){q$e(a,null,this.D,this.F)};p.Fba=function(){this.D?Vsh(this):this.WB();r$e(null,this.D,this.F)};p.WB=function(){zW.prototype.WB.call(this);this.D="";r$e(null,null,this.F)};p.ria=function(){return Wsh(this.R)};p.sHa=m(!0);
function Xsh(a,b){a.D!=b&&(a.D=b,y(A(),"fedaic")?(a.ma&&a.ma.cancel(),a.ma=wrh(vH.getInstance(),a.D),$m(a.ma.then(function(c){a.R=c.getError();c=0==a.R;a.Oa(c);c?a.pI()&&a.Fba():a.WB()},function(c){c instanceof an||(a.R=4,a.Oa(!1),a.WB())}),function(){a.ma=null})):a.pI()&&a.Fba())}function Vsh(a){if(Njf(a)){var b=a.O;b.D=a.D;b.EL();Krh(b);b.RP([]);var c=a.J;mn(function(){a.D&&XH(c.ea,a.D,!0).then(function(d){return Ysh(a,d,a.D)})},3E3)}}
function Ysh(a,b,c){b.forEach(function(d){var e=QVb(d,c);if(null!=e){var f=a.O;a:{if(d.hasType())switch(d.getType()){case 1:case 2:case 4:case 5:case 6:case 7:d="$dim";break a;case 3:d="$met";break a}d="$unu"}iXb(f,e,d)}})}function Ush(a,b){a.xa.setVisible(1==a.R);var c=a.$a("waffle-dbanswers-answers-bar-message");b=b?Wsh(a.R):"";a.qa().Ee(c,b)}p.r4b=function(){this.L.C(36760,Ojf(this));this.ea.setVisible(!0)};
function Wsh(a){switch(a){case 1:return"The admin for this table hasn't enabled Answers yet.";case 2:return"Answers is not yet supported for data sets created by custom query.";case 3:return"The admin for this table hasn't enabled Answers yet.";case 4:return"Answers is unavailable at the moment, please try again later.";case 5:return"This data table is being setup for Answers in the background. Please try again in some time.";default:return""}}
function Zsh(){return T('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#5f6368" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-2-3.5l6-4.5-6-4.5z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>')}
function $sh(){return T('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#5f6368" d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17l-.59.59-.58.58V4h16v12zm-9-4h2v2h-2zm0-6h2v4h-2z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>')}function ath(){var a='<div class="'+U("waffle-dbsource-pill-menuitem")+'">'+IVb();return T(a+"Learn more about BigQuery</div>")}
function bth(){var a='<div class="'+U("waffle-dbsource-pill-menuitem")+'">'+$sh();return T(a+"Send feedback</div>")}function cth(){var a='<div class="'+U("waffle-dbsource-pill-menuitem waffle-dbsource-configbar-watch-tutorial-menuitem")+'">'+Zsh()+"<div>";a=a+'Watch tutorial<div class="'+(U("waffle-dbsource-configbar-watch-tutorial-menuitem-caption")+'">');return T(a+"Learn the ins and outs of Connected Sheets</div></div></div>")}
function dth(){return T('<div class="'+U("waffle-dbsource-configbar-actions")+'"><div class="'+U("waffle-dbsource-configbar-columns-menu-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-chart-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-pivot-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-function-button-wrapper")+
'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-table-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-calculated-column-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-column-insights-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-answers-wrapper")+'"></div></div>')}
function eth(){var a='<div class="'+U("waffle-dbsource-configbar-wrapper")+'"><div class="'+U("waffle-dbsource-configbar")+'"><div class="'+U("waffle-dbsource-configbar-header")+'"><div class="'+U("waffle-dbsource-configbar-header-icon")+'">'+t$e(24)+'</div><div class="waffle-dbsource-configbar-header-title" role="textbox" tabindex="0" aria-label="';a+=Qr("Connected sheet name");a+='"></div><div class="'+U("waffle-dbsource-configbar-separator")+'"></div><div class="'+U("waffle-dbsource-configbar-header-subtitle")+
'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-refresh-options-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-options-wrapper")+'"><div class="'+U("waffle-dbsource-configbar-watch-tutorial-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-send-feedback-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-connection-settings-button-wrapper")+'"></div></div></div>'+dth()+'</div></div><div class="'+
U("waffle-dbsource-configbar-preview-bar-wrapper")+'"></div>';return T(a)}
function fth(){var a='<div class="'+U("waffle-dbsource-configbar-wrapper")+'"><div class="'+U("waffle-dbsource-configbar")+'"><div class="'+U("waffle-dbsource-configbar-header")+'"><div class="'+U("waffle-dbsource-configbar-header-icon")+'">'+t$e(24)+'</div><div class="waffle-dbsource-configbar-header-title" role="textbox" tabindex="0" aria-label="';a+=Qr("Connected sheet name");a+='"></div><div class="'+U("waffle-dbsource-configbar-separator")+'"></div><div class="'+U("waffle-dbsource-configbar-header-subtitle")+
'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-refresh-options-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-schedules-widget-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-options-wrapper")+'"><div class="'+U("waffle-dbsource-configbar-connection-settings-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-auxiliary-menu-button-wrapper")+'"></div></div></div>'+dth()+'</div></div><div class="'+
U("waffle-dbsource-configbar-preview-bar-wrapper")+'"></div>';return T(a)}
function gth(){var a=T('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="#188038" fill-rule="nonzero"><path d="M14.5263158 2C15.3368421 2 16 2.7 16 3.55555556V14.4444444C16 15.3 15.3368421 16 14.5263158 16H3.47368421C2.66315789 16 2 15.3 2 14.4444444V3.55555556C2 2.7 2.66315789 2 3.47368421 2H14.5263158zM3.5 3.5v11h11v-11h-11z"/><path d="M6.75 12.75h-1.5V7.5h1.5zM9.75 12.75h-1.5v-7.5h1.5zM12.75 12.75h-1.5v-3h1.5z"/></g></svg>');return T(a+"<span>Chart</span>")}
function hth(){var a=T('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="#188038" fill-rule="evenodd" d="M10 13h1.185c.9975 0 1.815-.81 1.815-1.815V10h-2.25l3-3 3 3H14.5v1.185c0 1.83-1.485 3.315-3.315 3.315H10v2.25l-3-3 3-3V13zM8 6V2h6.5454545C15.3454545 2 16 2.72 16 3.6V6H8zM2 6V3.6C2 2.72 2.72 2 3.6 2H6v4H2zm1.6 10c-.88 0-1.6-.6545455-1.6-1.4545455V8h4v8H3.6z"/></svg>');return T(a+"<span>Pivot table</span>")}
function ith(){var a=Pjf()+"<span>";return T(a+"Extract</span>")}function jth(){var a=T('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="#188038" d="M15 2H3v1.75L8.143 9 3 14.25V16h12v-2.625H7.286L11.571 9 7.286 4.625H15z"/></svg>');return T(a+"<span>Function</span>")}function kth(a){a=a.label;return T('<span class="'+U("waffle-dbsource-configbar-column-insights-icon")+'">'+tw("docs-icon-img docs-icon-insights")+"</span><span>"+Jr(a)+"</span>")}
function lth(){var a=T('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" fill-rule="evenodd"><path fill="#188038" d="M20 13h-7v7h-2v-7H4v-2h7V4h2v7h7v2z"/></g></svg>');return T(a+"<span>Calculated column</span>")}function mth(){var a='<span class="'+U("waffle-dbsource-configbar-secondary-button-content")+'">'+Zsh()+"<span>";return T(a+"Watch tutorial</span></span>")}
function nth(){var a='<span class="'+U("waffle-dbsource-configbar-secondary-button-content")+'">'+$sh()+"<span>";return T(a+"Send feedback</span></span>")}function oth(){var a='<span class="'+U("waffle-dbsource-configbar-secondary-button-content")+'">'+tw("docs-icon-img docs-icon-info-outline-grey","waffle-dbsource-configbar-secondary-button-icon")+"<span>";return T(a+"Learn more</span></span>")}
function pth(){var a='<span class="'+U("waffle-dbsource-configbar-secondary-button-content")+'">'+tw("docs-icon-img docs-icon-settings","waffle-dbsource-configbar-secondary-button-icon")+"<span>";return T(a+"Connection settings</span></span>")}
function qth(){return T('<div class="'+U("waffle-dbsource-configbar-schedules-widget")+'"><div class="'+U("waffle-dbsource-configbar-schedules-widget-content")+'"><div class="'+U("waffle-dbsource-configbar-schedules-widget-last-refresh")+'"><span class="'+U("waffle-dbsource-configbar-schedules-widget-last-refresh-content")+'"></span><span class="'+U("waffle-dbsource-configbar-schedules-widget-last-refresh-divider")+'"></span></div><div class="'+U("waffle-dbsource-configbar-schedules-widget-next-refresh")+
'"><span class="'+U("waffle-dbsource-configbar-schedules-widget-next-refresh-content")+'"></span><span class="'+U("waffle-dbsource-configbar-schedules-widget-edit-button-wrapper")+'"></span></div></div><div class="'+U("waffle-dbsource-configbar-schedules-widget-main-button-wrapper")+'"></div></div>')}
function rth(a,b){pL.call(this,Fr(oth),new Vt(b),Wsd.getInstance(),b);this.C=a;this.D=new Map([["bigquery-helpdoc",wgb],["send-feedback",this.C.Fa("docs-feedback")],["watch-tutorial",Dhb]]);this.jd(new Qt(Gr(bth),"send-feedback",this.qa()));this.jd(new Ut(this.qa()));this.jd(new Qt(Gr(cth),"watch-tutorial",this.qa()));this.jd(new Ut(this.qa()));this.jd(new Qt(Gr(ath),"bigquery-helpdoc",this.qa()))}v(rth,pL);
rth.prototype.Ja=function(){pL.prototype.Ja.call(this);ks(this.Bb().getElement(),"waffle-dbsource-pill-menu");ks(this.Bb().getElement(),"docs-gm");this.getHandler().listen(this.Bb(),"action",this.F)};rth.prototype.F=function(a){a=a.target.Ta();a=this.D.get(a);if(a.isEnabled()){var b;a==this.C.Fa("docs-feedback")&&(b={source:"big-sheets-feedback"});a.kb(b)}};
function sth(a){var b=a.label;a=a.jj;return T((a?'<div class="'+U("goog-menuitem-icon")+" "+U("waffle-charteditor-column-filtered-menu-item-icon")+" "+U(a)+'"></div>':"")+'<span class="'+U("waffle-datasource-configbar-columns-menu-item-label")+'">'+Jr(b)+"</span>")}function tth(){return T('<div class="'+U("waffle-datasource-configbar-columns-menu-spinner-container")+'"></div>')}
function uth(a){Vt.call(this,a);this.D=new HV(!1);this.oa(this.D);this.C=new Qt(Gr(tth),void 0,this.qa());this.C.uB(!1);this.Ia(this.C)}v(uth,Vt);uth.prototype.Ja=function(){Vt.prototype.Ja.call(this);ks(this.La(),"waffle-datasource-configbar-columns-menu")};uth.prototype.Ca=function(){Vt.prototype.Ca.call(this);this.C.render(this.La());this.D.render(this.C.Da("waffle-datasource-configbar-columns-menu-spinner-container"))};
uth.prototype.gI=function(a,b){a=ha(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=QVb(c,b);null!==d&&this.addColumn(d,SU(c.getType()))}};uth.prototype.addColumn=function(a,b){this.Ia(new Qt(Gr(sth,{label:a,jj:b}),void 0,this.qa()),!0)};function vth(a,b){var c=a.C.getElement();c&&(os(c,"waffle-datasource-configbar-columns-menu-loading",b),Q(c,b),a.D.setActive(b))}function wth(){Vt.apply(this,arguments)}v(wth,Vt);wth.prototype.Ja=function(){Vt.prototype.Ja.call(this);ks(this.La(),"waffle-datasource-configbar-formula-menu")};
wth.prototype.iI=function(a){var b=this;this.Ia(a,!0);this.getHandler().listen(a,"action",function(){var c=new WD("insert-formula-function");c.Mha=a.getValue();b.dispatchEvent(c)})};
function xth(a,b,c,d){S.call(this,d);this.J=a;this.O=b;this.R=c;this.H=!1;this.F=null;this.D=new Mt("Edit",dH.getInstance(),d);this.Ia(this.D);this.C=new nL("Schedule refresh");this.C.Ob("waffle-dbsource-configbar-schedules-widget-main-button");this.C.Ob("waffle-dbsource-flat-default");this.Ia(this.C);this.L=new Du(this);this.oa(this.L);this.L.Ab(Xx,zp,this.refresh)}v(xth,S);p=xth.prototype;p.Ca=function(){S.prototype.Ca.call(this);this.mb(Gr(qth))};
p.Ja=function(){S.prototype.Ja.call(this);this.D.render(this.Da("waffle-dbsource-configbar-schedules-widget-edit-button-wrapper"));this.C.render(this.Da("waffle-dbsource-configbar-schedules-widget-main-button-wrapper"));Q(this.La(),!1);this.getHandler().listen(this.C,"action",this.k9b).listen(this.D,"action",this.fab).listen(LG,"load-schedules-on-config-bar",this.sDa);this.sDa()};
p.refresh=function(){if(!this.isDisposed())if(!this.H||this.R.Ye())Q(this.La(),!1);else{var a=this.qa(),b=Xx.isEnabled();if(null==this.F)this.C.setVisible(!0),Q(this.Da("waffle-dbsource-configbar-schedules-widget-content"),!1),ms(this.La(),"waffle-dbsource-configbar-schedules-widget-highlight"),fu(this.C.La(),"Schedule a refresh for all connected objects associated with this sheet",void 0);else{this.C.setVisible(!1);Q(this.Da("waffle-dbsource-configbar-schedules-widget-content"),!0);ks(this.La(),
"waffle-dbsource-configbar-schedules-widget-highlight");fu(this.D.La(),"Refresh time for all objects related to current datasource",void 0);var c=this.F.getStatus();if(lh(c,4)){Q(this.Da("waffle-dbsource-configbar-schedules-widget-last-refresh"),!0);var d=new Date(1E3*rh(c,4)),e=!1,f=!0;e=void 0===e?!0:e;f=void 0===f?!1:f;var h=new ox;var k=Qjf(this.J);d=(e||d.getDate()!=(new Date).getDate()?$sd.format(d,k)+(f?", ":" "):"")+Xsd.format(d,k);h=h.format(d);d=this.Da("waffle-dbsource-configbar-schedules-widget-last-refresh-content");
a.od(d);a.appendChild(d,zk(a,ef(df("SPAN",{"class":"waffle-dbsource-configbar-schedules-widget-header-label"},"Updated: "),df("span",void 0,h))))}else Q(this.Da("waffle-dbsource-configbar-schedules-widget-last-refresh"),!1);nh(HU(this.F),1)?(h=new Date(1E3*rh(c,2)),d=new Date(1E3*rh(c,3)),h=Tjf(h,d,this.J,!1,!1,!1,!0,!0)):h="Paused";d=this.Da("waffle-dbsource-configbar-schedules-widget-next-refresh-content");a.od(d);a.appendChild(d,zk(a,ef(df("SPAN",{"class":"waffle-dbsource-configbar-schedules-widget-header-label"},
lh(c,4)?"Next: ":"Next refresh: "),df("span",void 0,h))));this.D.setVisible(b)}Q(this.La(),!0)}};p.sDa=function(){var a=this;x5e().then(function(b){a.isDisposed()||(b=uh(b,1,b5e).Gb(),0==b.length?a.F=null:a.F=b[0],a.H=!0,a.refresh())},function(){bv.getInstance().postMessage(dv("Error loading schedule configuration.","error",!0));a.H=!1;a.refresh()})};p.k9b=function(){this.sDa();this.fab()};p.fab=function(){var a=tq(new sq,109).build();this.O.C(116123,a);nSb(!0)};
function yth(a,b,c,d,e,f,h,k,l){h=void 0===h?null:h;k=void 0===k?null:k;l=void 0===l?null:l;Vw.call(this,a,b,c,d);e||(e=new L$a,this.oa(e));this.J=e;this.F=f;this.Ig=h;this.ea=k;this.R=l;this.C=0;this.O=new y8a(this.gj.hia(),!0,!0);this.F&&this.F.Zg(this.O)}v(yth,Vw);p=yth.prototype;p.T8=function(a){this.gj.isVisible()&&!this.isDismissed()&&this.F&&kw(this.F,this.O);this.C=1;Vw.prototype.T8.call(this,a);this.C=0};
p.b9=function(a){Vw.prototype.b9.call(this,a);this.J.xl()?Ww(this):Om(this.H,this.J.XT(),w(this.Mjb,this))};p.Mjb=function(){this.J.xl()&&(Ww(this),this.Ky())};p.Dna=function(){this.gj.render(this.Ig)};p.show=function(){this.isDismissed()||this.gj.isVisible()||this.Dna()};p.Q8=function(a){this.C=2;Vw.prototype.Q8.call(this,a);this.C=0};p.jka=function(a){this.C=3;Vw.prototype.jka.call(this,a);this.C=0};p.jy=function(){var a=this.isDismissed();Vw.prototype.jy.call(this);!a&&this.ea&&this.ea(this.C)};
p.c9=function(a){Vw.prototype.c9.call(this,a);this.R&&this.R()};p.fd=function(){!this.isDismissed()&&this.gj.isVisible()&&this.gj.hia().fd()};function zth(){var a='<div class="'+U("waffle-dbsource-previewbar")+'"><div class="'+U("waffle-dbsource-previewbar-content")+'"><span class="'+U("waffle-dbsource-previewbar-text")+'">';a=a+'Preview</span><span class="'+(U("waffle-dbsource-previewbar-info-icon-wrapper")+'"></span></div></div>');return T(a)}
function Ath(a){var b=a.woc;a='<div class="'+U("waffle-dbsource-previewbar-info-bubble-content")+'"><div class="'+U("waffle-dbsource-previewbar-info-bubble-title")+'">';b="This sheet shows a preview of up to "+(Jr(b)+" rows");a=a+b+('</div><div class="'+U("waffle-dbsource-previewbar-info-bubble-body")+'"><span>'+arc()+' </span><span class="'+U("waffle-dbsource-previewbar-info-bubble-link-button")+" "+U("goog-link-button")+'">'+brc()+'</span></div><div class="'+U("waffle-dbsource-previewbar-info-bubble-button-wrapper")+
'"></div></div>');return T(a)}function Bth(a,b){S.call(this,b);this.H=a;this.C=new Mjf(this.qa(),2,Gr(Vrh,{color:"#5f6368",$kc:10}));this.Ia(this.C);this.D=new nL("Create extract",this.qa());this.D.Ob("waffle-dbsource-flat-default");this.Ia(this.D)}v(Bth,S);Bth.prototype.Ca=function(){this.mb(Gr(zth));var a=this.C.C;a.Ob("waffle-dbsource-previewbar-info-bubble");a.jo(!0);Jt(a,!1);a.setPosition(1,2);a.setContent(Gr(Ath,{woc:500}))};
Bth.prototype.Ja=function(){var a=this;S.prototype.Ja.call(this);var b=this.Da("waffle-dbsource-previewbar-info-icon-wrapper");this.C.render(b);var c=this.C.C;this.D.render(c.Da("waffle-dbsource-previewbar-info-bubble-button-wrapper"));var d=c.Da("jfk-bubble-closebtn");d.appendChild(Gr(vif));m_a(d,fs(d));fu(this.C.yF().La(),"Show information about this preview",void 0);var e=new Bw(c.La(),this.qa());Cw(e);this.oa(e);if(e=L$e())ks(b,e),ks(d,e);this.getHandler().listen(this.D,"action",function(){a.getHandler().Jc(c,
"hide",a.F);a.C.C.setVisible(!1);a.dispatchEvent("create-extract-button-action")}).listen(this.H,"N",function(){mn(function(){return a.C.C.fd()})}).listen(this.C.La(),"keydown",function(f){var h=a.C.C;h.isVisible()&&9===f.keyCode&&(f.preventDefault(),f.stopPropagation(),f=h.Da("waffle-dbsource-previewbar-info-bubble-link-button"),a.qa().Pv(f).focus())}).listen(c.La(),"keydown",function(f){27===f.keyCode&&c.setVisible(!1)}).listen(c,"beforeshow",function(){a.getHandler().Nc(c,"hide",a.F)})};
Bth.prototype.F=function(){var a=this.C.yF().getElement();a&&a.focus()};var Cth={enabled:!0,selected:!0,visible:!0},Dth={enabled:!0};function Eth(){Cm.call(this,"configbar-dom-focus-out")}v(Eth,Cm);function Fth(a,b){Cm.call(this,"datasheet-rename");this.ih=a;this.name=b}v(Fth,Cm);
function Gth(a,b,c,d,e,f,h,k,l,n,q){S.call(this,q);q=y(A(),"fdsrfu");this.Ra=a;this.C=b;this.R=c;this.vd=d;this.Qa=b.ea;this.Eb=k;this.Cb=l;this.Kb=n;this.bd=f;this.Wc=0;this.Pa=new Fu;this.oa(this.Pa);this.H=new pL("Columns",new uth(this.qa()),void 0,this.qa());this.H.Ob("waffle-dbsource-configbar-columns-menu-button");this.H.Lh(!0);this.Ia(this.H);this.Za=Hth(this,"waffle-dbsource-configbar-chart-button",Gr(gth));this.ib=Hth(this,"waffle-dbsource-configbar-pivot-button",Gr(hth));this.Ma=Hth(this,
"waffle-dbsource-configbar-table-button",Gr(ith));a=Gr(jth);this.ea=new bu(a,new wth(this.qa()),Csd.getInstance(),this.qa());this.ea.Ob("waffle-dbsource-configbar-function-button");this.ea.Lh(!0);this.ea.Kl(!0);this.Ia(this.ea);this.Ha=Hth(this,"waffle-dbsource-configbar-calculated-column-button",Gr(lth));this.Aa=this.D=this.xa=null;y(A(),"fedciv")&&(this.D=Hth(this,"waffle-dbsource-configbar-column-insights-button",Gr(kth,{label:"Column stats"})),this.xa=new uye,this.oa(this.xa));this.L=new nL("Refresh options");
this.L.Ob("waffle-dbsource-configbar-refresh-options-button");this.L.Ob("waffle-dbsource-flat-default");this.Ia(this.L);this.F=null;q?(this.F=Hth(this,"waffle-dbsource-configbar-secondary-button",Gr(pth)),this.Wa=new rth(this.Cb,this.qa()),this.Wa.Ob("waffle-dbsource-configbar-secondary-button"),this.Wa.Lh(!0),this.Ia(this.Wa),this.jb=new xth(h,this.R,this.C,this.qa())):(this.ub=Hth(this,"waffle-dbsource-configbar-secondary-button",Gr(mth)),this.pb=Hth(this,"waffle-dbsource-configbar-secondary-button",
Gr(nth)),this.F=new nL(Gr(sw,{icon:"docs-icon-img docs-icon-settings"}),this.qa()),this.F.Ob("waffle-dbsource-configbar-connection-settings-button"),this.Ia(this.F));this.ma=new Bth(e,this.qa());this.Ia(this.ma);this.Dd=new Map([[this.H,""],[this.Za,"chart"],[this.ib,"pivot table"],[this.Ma,"table"],[this.ea,"function"],[this.Ha,""],[this.L,""],[this.F,""]]);this.Mc=new Map([[this.Za,1],[this.ib,2],[this.Ma,4],[this.ea,3],[this.Ha,5]]);this.D&&this.Mc.set(this.D,6);this.Kc=new Set;y(A(),"fedsccm")||
this.Kc.add(this.H);this.xc=new Map([[this.L,Tx],[this.F,Zx],[this.Ha,Ux]]);this.O=null;y(A(),"feda")&&!et().C&&(this.O=new Tsh(this.C,this.R,this.vd,e,75,this.qa()),this.Ia(this.O));this.bb=this.J=null;this.xb=!1;this.Ea=null;this.Sa=new Set}v(Gth,S);p=Gth.prototype;p.Ca=function(){var a=y(A(),"fdsrfu");this.mb(Gr(a?fth:eth))};
p.Ja=function(){var a=this;S.prototype.Ja.call(this);var b=y(A(),"fdsrfu");this.H.render(this.Da("waffle-dbsource-configbar-columns-menu-button-wrapper"));this.Za.render(this.Da("waffle-dbsource-configbar-chart-button-wrapper"));this.ib.render(this.Da("waffle-dbsource-configbar-pivot-button-wrapper"));this.Ma.render(this.Da("waffle-dbsource-configbar-table-button-wrapper"));this.ea.render(this.Da("waffle-dbsource-configbar-function-button-wrapper"));this.Ha.render(this.Da("waffle-dbsource-configbar-calculated-column-button-wrapper"));
this.D&&(this.D.render(this.Da("waffle-dbsource-configbar-column-insights-button-wrapper")),this.xa.Qf(this.D.La()));this.L.render(this.Da("waffle-dbsource-configbar-refresh-options-button-wrapper"));this.F.render(this.Da("waffle-dbsource-configbar-connection-settings-button-wrapper"));b?(this.Wa.render(this.Da("waffle-dbsource-configbar-auxiliary-menu-button-wrapper")),this.jb.render(this.Da("waffle-dbsource-configbar-schedules-widget-wrapper"))):(this.ub.render(this.Da("waffle-dbsource-configbar-watch-tutorial-button-wrapper")),
this.pb.render(this.Da("waffle-dbsource-configbar-send-feedback-button-wrapper")),Hu(this.Pa,this.ub,Dhb,Cth),Hu(this.Pa,this.pb,this.Cb.Fa("docs-feedback"),Cth,function(){return{source:"big-sheets-feedback"}}));this.O&&this.O.Va(this.Da("waffle-dbsource-configbar-answers-wrapper"));this.ma.render(this.Da("waffle-dbsource-configbar-preview-bar-wrapper"));this.getHandler().listen(this.ma,"create-extract-button-action",function(){return Ith(a,111)});Hu(this.Pa,this.L,Tx);Hu(this.Pa,this.Ha,Ux);Hu(this.Pa,
this.F,Zx,Dth,function(){return new vjf(Jth(a),"show-current-source")});this.J=this.Da("waffle-dbsource-configbar-header-title");this.getHandler().listen(this.Za,"action",this.B_b).listen(this.ib,"action",this.lcc).listen(this.Ma,"action",function(){return Ith(a,109)}).listen(this.ea,"show",this.q2b).listen(this.Ha,"action",this.c_b).listen(this.L,"action",this.Gdc).listen(this.H,"show",this.O0b).listen(this.Ra,"ua",this.Sjb).listen(this.J,["focus","mousedown"],this.Z$b).listen(this.C,"external_datasource_status",
this.Pec);this.Mc.forEach(function(c,d){a.getHandler().listen(d.La(),"mouseenter",function(){a.Wc=Date.now()});a.getHandler().listen(d.La(),"mouseleave",function(){switch(c){case 6:var e=Kth(a);break;default:e=A3()}e=yq(e);var f=e.D,h=new vZd,k=Date.now()-a.Wc;k=lj(new kj,1E3*k);K(h,1,c);var l=d.isEnabled();K(h,2,l);Pi(f,47,h);a.R.C(116245,vq(xq(e,f),k).build())})});this.D&&this.getHandler().listen(this.D.La(),["mouseenter","focus"],this.XBc).listen(this.D,"action",this.L0b);this.getHandler().listen(this.ma.La(),
"keydown",this.m8b);y(A(),"fedsccm")||this.H.setVisible(!1);et().C&&(b?(this.L.setVisible(!1),this.F.setVisible(!1),this.Wa.setVisible(!1)):(this.ub.setVisible(!1),this.pb.setVisible(!1),this.F.setVisible(!1)));this.refresh()};p.m8b=function(a){9===a.keyCode&&(a.preventDefault(),this.dispatchEvent(new Eth))};
p.setVisible=function(a){Q(this.La(),a);if(this.O&&a){var b="",c=bN(this.Ra);c&&c.Gd()&&(b=c.Gd());Xsh(this.O,b)}a||(b=this.ma.C.C,b.setVisible(!1),b.fd());!this.Ea||this.Ea.isDismissed()||a||this.Ea.jy();!this.Aa||this.Aa.isDismissed()||a||this.Aa.jy()};p.isVisible=function(){return ir(this.La())};
p.refresh=function(){Lth(this,bN(this.Ra).Ud());var a=this.Da("waffle-dbsource-configbar-header-subtitle"),b=Mth(this),c=this.qa();b?c.Ee(a,b+" Rows"):c.Ee(a,"");a=!(this.C.Ye()||this.C.D.wg());Nth(this,a,r5e(this.Qa,Jth(this)),this.C.Qd());this.jb&&this.jb.refresh();this.H.ld(!1);Oth(this);this.O&&Xsh(this.O,Jth(this));this.bb&&(nn(this.bb),this.bb=null)};function Hth(a,b,c){c=new nP(c,a.qa());c.Ob(b);a.Ia(c);return c}p.B_b=function(){w3b(this.Qa);OG(null,void 0,Jth(this));this.R.C(36528,A3())};
p.lcc=function(){w3b(this.Qa);var a=D9e(),b=Jth(this);a=Ah(a,1,b).build();a=J9e(a);a=new QV(null,TOb(a),void 0);dSb(a);this.R.C(36527,A3())};function Ith(a,b){w3b(a.Qa);mSb(Jth(a));a.R.C(36529,A3(b))}p.q2b=function(){var a=this.ea.Bb();if(a&&0==a.jc()){a=this.ea.Bb();var b=Aye(new zye(this.C.Qa,a,this.bd,this.C.D.Le()),void 0,!0);b=ha(b);for(var c=b.next();!c.done;c=b.next())a.iI(c.value)}w3b(this.Qa)};p.c_b=function(){this.R.C(36748,A3())};p.Gdc=function(){this.R.C(36749,A3())};
p.L0b=function(){yib.kb(this.D,Kth(this))};p.Z$b=function(a){if(!this.J.isContentEditable&&!lJ(this.C)){this.J.contentEditable=!0;if("focus"===a.type){a=window.getSelection();var b=document.createRange();b.selectNodeContents(this.J);a.removeAllRanges();a.addRange(b)}this.getHandler().listen(this.J,"keydown",this.Rjb).listen(this.J,"blur",this.hgc)}};p.Rjb=function(a){switch(a.keyCode){case 13:this.J.blur();break;case 27:Pth(this,!0)}};
p.hgc=function(){var a=this;this.xb||(window.getSelection().removeAllRanges(),this.bb=mn(function(){a.dispatchEvent(new Fth(bN(a.Ra).gb(),qk(a.J)));Pth(a,!1)}))};function Pth(a,b){a.J.contentEditable=!1;Km(a.J,"keydown");Km(a.J,"blur");b&&Lth(a,bN(a.Ra).Ud())}p.O0b=function(){var a=this,b=this.H.Bb();vth(b,!0);var c=Jth(this);XH(this.Qa,c).then(function(d){Oth(a);0<d.length?b.gI(d,c):(a.H.ld(!1),a.refresh())})};p.Sjb=function(a){Lth(this,a.Dm)};p.Pec=function(){null!=yOb(this.C.C)&&this.refresh()};
function Lth(a,b){var c=a.Da("waffle-dbsource-configbar-header-title");a.qa().Ee(c,b)}p.XBc=function(){1!=this.xa.ea&&(wye(this.xa),Rgb.kb(this.xa,Kth(this)))};
function Nth(a,b,c,d){var e=b&&!d,f=null==Qth(c);a.Dd.forEach(function(h,k){var l=!a.Kc.has(k),n=!a.xc.has(k)||a.xc.get(k).isEnabled();k==a.L?k.Oa(b&&l&&n):k!=a.F&&(l=e&&f&&l&&n,k.Oa(l),k==a.Ma&&a.ma.D.Oa(l));l=Qth(c);n=Mth(a);var q;k.isEnabled()&&k==a.Ma?q=y(A(),"femdrr")?"Insert an extract of up to 50k rows":"Insert an extract of up to 25k rows":k.isEnabled()&&k==a.Ha?q="Add a calculated column":k.isEnabled()&&k==a.L?q="Refresh options for all connections and associated objects":k.isEnabled()&&
k==a.F?q="Update connection settings":q=k.isEnabled()&&n&&h?"Insert "+(h+(" based on "+(n+" rows"))):k.isEnabled()&&h?"Insert "+h:k.isEnabled()||null!=l?k.isEnabled()||37!=l?k.isEnabled()||null==l?"":"There was an error fetching the database schema.":"You don't have access to refresh or edit analysis with this connected data.":"You don't have permission to edit this sheet.";Rth(k.La(),q);k==a.Ma&&Rth(a.ma.D.La(),q)});a.O&&a.O.Oa(b&&f);a.D&&a.D.Oa(b&&f)}
function Rth(a,b){fu(a,b,void 0);b&&eS(a,"waffle-dbsource-configbar-db-object-creation-button-tooltip")}function Jth(a){return bN(a.Ra).Gd()}function Oth(a){a=a.H.Bb();for(vth(a,!1);1<a.jc();)a.En(1,!0)}
function Sth(a){if(y(A(),"fedciv")&&y(A(),"fedcivp")&&a.isVisible()&&a.D&&a.D.isEnabled()&&!a.Aa&&!Tth(a)){var b=a.C.F,c=Ru(b.C,"ritz-ap"),d=!!kt(c).C.dbColumnStatsPromo;b=b.D["ritz-SessionCountBigsheetsConfigbarColumnStatsPromo"];var e=b.getValue();3<=e||(d&&0===e?b.setValue(2):b.setValue(Math.min(e+1,2147483647)),d=a.D.La(),b=new Gw("Discover data insights","Now you can quickly learn about data distribution, frequency, and more for any column",d,a.qa()),a.oa(b),a.Aa=new yth(b,d,!1,a.qa(),a.C.R,
a.Kb,a.La(),function(){Xw(c,"dbColumnStatsPromo",!0)}),a.oa(a.Aa),a.Sa.add(a.Aa),a.Aa.show(),a.R.C(116197,A3()))}}function Tth(a){for(var b=ha(a.Sa),c=b.next();!c.done;c=b.next())c=c.value,c.isDismissed()&&a.Sa.delete(c);return 0<a.Sa.size||a.ma.C.C.isVisible()?!0:!1}function Mth(a){return(a=N().Yha()(Jth(a)))?Snc.format(parseInt(a,10)):null}function Qth(a){return a&&lh(a,1)&&!a.Bg()?a.getErrorCode():null}
function Kth(a){var b=yq(A3());b=Jye(Iye(new Dye(a.Eb,b)),0<Nye(sJ(a.Eb)).length);var c=a.xa.ea,d=a.xa.Aa;d=void 0===d?null:d;Fye(b)&&(Eye(b),a=new xZd,K(a,1,c),d&&(c=lj(new kj,1E3*d),vq(b.F,c)),Pi(b.C,4,a));return b.build().build()}function A3(a){a=void 0===a?109:a;var b=pj(new nj,!0);return xq(tq(new sq,a),b).build()}
function Uth(a,b,c,d,e,f,h,k,l,n,q){Lm.call(this);this.D=a;this.F=b;this.xa=l;this.R=c;this.Ea=d;this.O=e;this.H=f;this.L=h;this.Aa=k;this.J=new Pm(this);this.oa(this.J);this.ma=n;this.ea=q;this.C=null;this.J.listen(this.D,["na","Fa"],this.t2a).listen(this.D,["oa","Ea"],this.Tfc).listen(this.F,["acl_change","offline_status","readonly_status"],this.UXb);this.t2a()}v(Uth,Lm);p=Uth.prototype;
p.t2a=function(){var a=bN(this.D);if(a&&JC(a)&&(this.C?(this.C.refresh(),this.C.xb=!1):(this.C=new Gth(this.D,this.F,this.R,this.Ea,this.Aa,this.xa,this.ma,this.H,this.ea,this.O),a=this.C.qa(),this.C.render(a.getElement("waffle-dbsource-configbar-id")),this.C.Wd(this),this.J.listen(this.C,"insert-formula-function",this.Jgc).listen(this.C,"datasheet-rename",this.f2b).listen(this.C,"configbar-dom-focus-out",this.g1b)),this.C.setVisible(!0),xxe(),a=this.C,!Tth(a))){if(a.F&&a.F.isEnabled()&&y(A(),"fedda")&&
Wx.isEnabled()&&!a.Ea&&!et().C){var b=a.C.F.D["ritz-SessionCountBigsheetsDelegateAccessPromo"];var c=b.getValue();b.setValue(Math.min(c+1,2147483647));3>c||6==c+1?(b=a.F.La(),c=new Gw("Delegate access","Allow collaborators of this spreadsheet to refresh and analyze this connected data using your credentials. Go to the connection settings to enable.",b,a.qa()),a.oa(c),a.Ea=new yth(c,b,!1,a.qa(),a.C.R,a.Kb,a.La()),a.oa(a.Ea),a.Sa.add(a.Ea),a.Ea.show(),a.R.C(116174,A3()),b=!0):b=!1}else b=!1;b||null===
Mth(a)||(b=a.C.F,3<=wbc(b).getValue()||(b=b.D["ritz-ViewCountDatasourceSheetPreviewBar"],c=b.getValue(),1>c&&(b.setValue(c+1),a=a.ma.C.C,a.setVisible(!0),a.fd())))}};p.f2b=function(a){var b=this;a=new xGc(a.ih,a.name);QG(a,function(c){c||Pth(b.C,!0)});this.L.C(a)};p.g1b=function(){iM(qJ(this.H))};
p.Jgc=function(a){var b=this,c=bN(this.D),d=c.Gd();if(d){var e=c.Ud(),f=a.Mha;I6e(this.O,function(h,k){var l=N().Wha()(e,null);Wm([XH(b.F.ea,d),qn(1E3)]).then(function(){return Vth(b,f,l,k)})},"Insert Formula");this.R.C(36535,A3())}};function Vth(a,b,c,d){if(d)a.F.C.Sz(d.Dh,function(){var f=XF(a.F.C),h=new Ej(d.C,d.qj);AG(f,h);Wth(a,b,c,h)});else{var e=new $qe(QF(a.F.C)+1);QG(e,function(f){f&&Wth(a,b,c,new Ej)});a.L.C(e)}}
function Wth(a,b,c,d){MF(sJ(a.H).C,RC(d)).addCallback(function(){Cte(qJ(a.H),b,c)})}p.Tfc=function(){this.C&&(this.C.setVisible(!1),this.C.xb=!0)};p.UXb=function(){var a=bN(this.D);a&&JC(a)&&this.C&&this.C.refresh()};p.Na=function(){Lm.prototype.Na.call(this);Xf(this.C)};
function Xth(){var a='<div class="'+U("waffle-create-datasheet-welcome-dialog-section")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/bigSheets_welcome.png" class="'+U("waffle-create-datasheet-welcome-dialog-image")+'" alt=""><h3 class="'+U("waffle-create-datasheet-welcome-dialog-welcome-message")+'"><span>';a=a+'Connect and analyze big data in Sheets</span></h3><div class="'+(U("waffle-create-datasheet-welcome-dialog-welcome-description")+'">');a=a+"Connect to BigQuery, Google's cloud data warehouse, to analyze and share billions of rows of data with your colleagues - all within Sheets</div><div class=\""+
(U("waffle-create-datasheet-welcome-dialog-button-wrapper")+'"></div></div>');return T(a)}function Yth(a){xW.call(this,"waffle-create-datasheet-welcome-dialog",a);this.D=new nP("Learn the basics",this.qa());this.Ia(this.D);this.C=new Ow("Get connected",this.qa());this.Ia(this.C)}v(Yth,xW);p=Yth.prototype;
p.Ca=function(){xW.prototype.Ca.call(this);Er(this.zb(),Xth);this.D.render(this.Da("waffle-create-datasheet-welcome-dialog-button-wrapper"));this.getHandler().listen(this.D,"action",this.Tjb);this.C.render(this.Da("waffle-create-datasheet-welcome-dialog-button-wrapper"));this.getHandler().listen(this.C,"action",this.PLa);cs(this.Da("waffle-dataconnector-modal-title"));var a=this.Da("waffle-create-datasheet-welcome-dialog-welcome-message");a.id=vr(this,"waffle-create-datasheet-welcome-dialog-welcome-message");
bs(a,"heading");ds(this.La(),"labelledby",a.id);a=this.Da("waffle-create-datasheet-welcome-dialog-welcome-description");a.id=vr(this,"waffle-create-datasheet-welcome-dialog-welcome-description");ds(this.La(),"describedby",a.id)};p.Tjb=function(){zr("https://connectedsheets.page.link/support")};p.PLa=function(){this.resolve(!0)};p.aBa=function(a){13==a.keyCode&&this.PLa()};p.U8=function(){xgb.kb();this.reject()};p.VB=function(){xgb.kb();this.reject()};
function Zth(a){a=a.uAa;a='<div class="'+U("waffle-create-datasource-sheet-loading-dialog-section")+'"><img class="'+U("waffle-create-datasource-sheet-loading-dialog-image")+'" src="'+U(Tr(a))+'" alt=""><div class="'+U("waffle-create-datasource-sheet-loading-dialog-tip")+'">';return T(a+"Connecting data\u2026</div></div>")}function $th(a,b,c){pW.call(this,"waffle-create-datasource-sheet-loading-dialog",c);this.D=a;this.C=b}v($th,pW);
$th.prototype.Ca=function(){pW.prototype.Ca.call(this);Er(this.zb(),Zth,{uAa:this.D});cs(this.Da("waffle-dataconnector-modal-title"));var a=this.Da("waffle-create-datasource-sheet-loading-dialog-tip");a.id=vr(this,"waffle-create-datasource-sheet-loading-dialog-tip");bs(a,"heading");ds(this.La(),"labelledby",a.id)};$th.prototype.Ja=function(){pW.prototype.Ja.call(this);this.C.C(36758,auh())};$th.prototype.Na=function(){pW.prototype.Na.call(this);this.C.C(36759,auh())};
function auh(){var a=pj(new nj,!0);return xq(tq(new sq,75),a).build()}
function buh(){var a='<div class="'+U("waffle-create-datasource-sheet-success-dialog-section")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/bigSheets_success_2.gif" class="'+U("waffle-create-datasource-sheet-success-dialog-image")+'" alt=""><h5 class="'+U("waffle-create-datasource-sheet-success-dialog-success-message")+'">';a=a+'Success! Your data is connected</h5><div class="'+(U("waffle-create-datasource-sheet-success-dialog-metadata-wrapper")+" "+U("waffle-create-datasource-sheet-success-dialog-datasource-info")+
'"></div><div class="'+U("waffle-create-datasource-sheet-success-dialog-success-description")+'">');a=a+'Create connected charts, pivot tables, and functions that work on the entire dataset, or extract a subset of the raw data directly into Sheets.</div><div class="'+(U("waffle-create-datasource-sheet-success-dialog-start-analyze-button-wrapper")+'"></div><div class="'+U("waffle-create-datasource-sheet-success-dialog-watch-tutorial")+" "+U("goog-link-button")+'"><span>');return T(a+"Watch video tutorial</span></div></div>")}
function cuh(a,b){a=(new Iv("{NUM_COLUMNS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_COLUMNS:a});return b?b+" rows \u2022 "+a:a}function duh(a,b,c){pW.call(this,"waffle-create-datasource-sheet-success-dialog",c);this.F=a;this.H=b;this.C=new Ow("Get started",this.qa());this.Ia(this.C);this.D=new Mt(void 0,dH.getInstance(),this.qa());this.Ia(this.D)}v(duh,pW);
duh.prototype.Ca=function(){var a=this;pW.prototype.Ca.call(this);Er(this.zb(),buh);var b=this.Da("waffle-create-datasource-sheet-success-dialog-metadata-wrapper");this.qa().Ee(b,cuh(this.F,this.H));this.C.render(this.Da("waffle-create-datasource-sheet-success-dialog-start-analyze-button-wrapper"));this.D.Va(this.Da("waffle-create-datasource-sheet-success-dialog-watch-tutorial"));cs(this.Da("waffle-dataconnector-modal-title"));b=this.Da("waffle-create-datasource-sheet-success-dialog-success-message");
b.id=vr(this,"waffle-create-datasource-sheet-success-dialog-success-message");bs(b,"heading");ds(this.La(),"labelledby",b.id);b=this.Da("waffle-create-datasource-sheet-success-dialog-success-description");b.id=vr(this,"waffle-create-datasource-sheet-success-dialog-success-description");ds(this.La(),"describedby",b.id);this.getHandler().listen(this.C,"action",function(){return a.VB()}).listen(this.D,"action",function(){return Dhb.kb()})};
function euh(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E){qlf.call(this,new xlf(n.getType(),l,"filter_db_sheet",E),a,b,c,d,e,f,h,k,l,z,E);this.H=fH(n);this.vd=n;this.Wc=q;this.Rd=t;this.Vd=u;this.Kd=!lh(this.H,2)&&M$e(n)}v(euh,qlf);p=euh.prototype;p.Ca=function(){qlf.prototype.Ca.call(this);var a=TK(this.C,this.lh());Srh(this.F.C,500<a.left?0:3)};
p.w2a=function(){var a=this.Ta().Ib(),b=N().Xha()(a,this.H.qb()),c=null,d=null;0<b.length&&(c=ih(yD,b[0]),d=JW(a));Zkf(this.F,c,d,this.Rd,this.Vd,this.Wc,this.H,this.vd.getType());a=this.Ma;b=this.Ra;c=this.Ta().Ib();c=N().uya()(c,this.H.qb());os(a.La(),"waffle-datasourcesheet-sort-selected",0==c);os(b.La(),"waffle-datasourcesheet-sort-selected",1==c);a.Oa(null!=c||!this.Kd);b.Oa(null!=c||!this.Kd);a=this.D;b=a.Bb().La();ks(b,"waffle-datasourcesheet-filterbox-container");nU(a);er(b,"");a.Jl()};
p.d0a=function(a){if("filtering_cancelled"==a.type)this.Qa();else if("filtering_open_filter_by_value_sidebar"==a.type){a=this.Ta().Ib();a=N().Xha()(a,this.H.qb());var b=null;0<a.length&&(b=ih(yD,a[0]));a=b?ED(sqe(dEb(),this.H),b).build():null;a=new NW(this.Wc,4,this.H,this.vd.getType(),a,null,null,null,null);cib.kb(a);this.Ha.C(116098,this.Eb);this.Qa()}else if(a=this.lh(),a=this.F.Co(this.Ta().Ib(),a.y,a.x,!1,!1),!Akf(this.F.C)){b=this.Ta().Ib();var c=N().Xha()(b,this.H.qb());b=null;0<c.length&&
(b=ih(yD,c[0]));c=b&&0<mh(b,9);if(null!=a||c){var d=new LW("filterUpdate");d.C=a;c&&(d.F=b.sx(),d.Ra=uh(b,9,Ih).Gb())}else d=new LW("filterClear");d.R=this.H;this.dispatchEvent(d);this.Qa()}};p.xBa=function(a){var b=new LW("filterSort");b.R=this.H;b.Aa=a?1:0;this.dispatchEvent(b)};p.zCa=m(!1);
p.Xua=function(a){var b=this.C,c=b.getDepthAt("r",a.y),d=b.C,e=2*d.C,f=this.Ta().Yf(a.y,a.x).wl();c=-c-e;a="rtl"==(f.D||null)||"auto-rtl"==(f.D||null)?e:b.getDepthAt("c",a.x)-16*d.C-e;d=d.C;this.yz(new Ej(a/d,c/d))};function fuh(a){C.call(this,a)}v(fuh,C);fuh.prototype.gb=function(){return this.message.gb()};fuh.prototype.C=function(a){return this.message.C(a)};function guh(a){this.hb=eh(a,-1,0)}v(guh,hh);guh.prototype.toBuilder=function(){return new fuh(this)};
guh.prototype.gb=function(){return ph(this,1)};guh.prototype.C=function(a){return vh(this,3,a,yD)};function huh(a,b,c,d,e,f){d=void 0===d?null:d;e=void 0===e?!1:e;f=void 0===f?!1:f;PG.call(this,147);this.L=a.Ib();this.J=b;this.D=c||[];this.C=d;this.O=e;this.R=f}v(huh,PG);huh.prototype.Nd=function(){var a=void 0===a?jh(guh):a;a=new fuh(a);a=Ah(a,1,this.L);a=Fh(a,7,this.J);this.O?xh(a,5,!0):Eh(a,3,this.D);this.R?xh(a,6,!0):null!=this.C&&Ch(a,4,this.C);return a.build()};
huh.prototype.equals=function(a){return this.L==a.L&&this.J.equals(a.J)&&this.O==a.O&&this.R==a.R&&this.C==a.C&&Rd(this.D,a.D,function(b,c){return b.equals(c)})};function iuh(a,b,c,d,e,f,h){B.call(this);this.J=a;this.O=h;this.ma=b;this.D=c;this.ea=d;this.R=e;this.L=f;this.F=new Pm(this);this.oa(this.F);this.C=null;this.H=new Du(this);this.oa(this.H);this.F.listen(this.D,"filter-triggered",this.RLa);this.H.subscribe(sy,"action",this.RLa);this.H.subscribe(bib,"action",this.Wjb)}v(iuh,B);p=iuh.prototype;
p.RLa=function(){var a=bN(this.ma);if(a&&JC(a)){var b=qJ(this.D),c=juh(this),d=xG(c),e=vG(juh(this));d=new Ej(d.x,e.y);e=rS(c,d.x);this.C&&(this.C.dispose(),this.C=null);this.C=new euh(c,this.R,b.R,b.C,b.F,new BJ(d),!1,!1,this.ea,e,a.Gd(),this.J.H,this.J.Ea,this.O);this.oa(this.C);bL(LEc(b),this.C);this.F.listen(this.C,"filterClear",this.Vjb).listen(this.C,"filterSort",this.Xjb).listen(this.C,"filterUpdate",this.yfc);this.C.Xua(d);this.C.Sc();this.C.D.ld(!0);b=fH(e);a=N().uya()(a.gb(),b.qb());b=Tj("waffle-autofilter-sort waffle-datasourcesheet-sort-selected");
null!=a&&b&&(gs(b,b.innerText+" selected"),os(b,"hc-enabled-focus","black"==ju()))}};p.Vjb=function(a){a=new huh(juh(this),a.R,null,null,!0);kuh(this,a)};p.yfc=function(a){var b=zD();a.C&&CD(b,a.C);a.Ra&&0<a.Ra.length&&BD(Eh(b,9,a.Ra),a.F);a=new huh(juh(this),a.R,[b.build()],null);kuh(this,a)};
p.Wjb=function(a){if(4==a.C){var b=zD(),c=a.Ada;Eh(b,9,c);BD(b,a.sx());c=0<c.length;var d=!1;if(a.JH){var e=a.JH.C();e.tx()&&(d=!0,CD(b,e.Co()))}b=c||d?[b.build()]:null;a=new huh(juh(this),a.D,b,null,!b);kuh(this,a)}};p.Xjb=function(a){var b=juh(this).Ib(),c=a.R;b=N().uya()(b,c.qb());var d=!1;switch(a.Aa){case 1:d=0==b;break;case 0:d=1==b}a=d?new huh(juh(this),c,null,null,void 0,!0):new huh(juh(this),c,null,1==a.Aa?0:1);kuh(this,a)};function kuh(a,b){a.L.C(b);z6e(LEc(qJ(a.D)));Xf(a.C);a.C=null}
function juh(a){return XF(a.J.C)}function luh(a,b,c,d,e,f,h){B.call(this);var k=this;this.L=new Pm(this);this.oa(this.L);this.J=a.L;this.F=b;this.C=c;this.ma=e;this.O=f;this.ea=new Du(this);this.oa(this.ea);this.xa=h;this.H=this.D=null;muh(this);nuh(this,d);this.R=new Nm;this.oa(this.R);this.R.wb(this.J.H,function(l){var n=ouh(k);n&&(l.D||l.C.has(n))&&puh(k,n)});this.H$()}v(luh,B);function muh(a){var b=new Dq(["waffle-dbsheet-or-dbobject-pill-active"]);a.O.C(thb,b)}
function nuh(a,b){var c=SD(a.F.Qa);a.L.listen(b,"P",a.Qhc).listen(c,"gc",a.$jb).listen(c,["Qb","cc"],a.H$).listen(a.F,"na",a.H$).listen(a.C,"activeCellChange valueChange blurEmbeddedObject embeddedObjectMouseEnter embeddedObjectMouseLeave focusEmbeddedObject".split(" "),a.H$).listen(a.C,"inputBoxActivate",a.Ika).listen(a.C,"mouseover",a.Zjb).listen(a.C,"refresh-db-object-request",a.O1a).listen(a.F,"oa",a.axa).listen(a.C,"db-connection-settings",a.k0a);a.ea.subscribe(thb,"action",a.Yjb)}p=luh.prototype;
p.Na=function(){this.axa();B.prototype.Na.call(this)};p.$jb=function(){var a=qJ(this.C);a&&rJ(this.C)&&fEc(a)};p.axa=function(){Yf(quh(this),ruh(this),this.D);this.H=this.D=null};p.Qhc=function(){this.D&&Prh(this.D)};
p.H$=function(){var a=qJ(this.C),b=bN(this.F);if(a&&b){b=!!a.Sa;var c=!!GEc(a);b||!c||a.Sa||(a.Sa=new Qrh(a.Ta(),a.R,a.C,a.F,new BJ(BEc(a),new Ej(0,0)),a.Aa,a.Za,a.Cb,a.ob),mM(a.ea,"dbCellPill",a.Sa),a.oa(a.Sa),a.Sa.setVisible(!0));b=a.Ta();a=GEc(a)||xG(b);(a=jG(cG(b,a),a,b.Ib()))&&(a.C||a.D)?this.Ika():(a=ouh(this),(a!=this.H||suh(this,a))&&puh(this,a))}else this.axa()};
function suh(a,b){if(!b||2!=N().uF()(b))return!1;var c=qJ(a.C);if(!c)return!1;b=H6e(c);c=F6e(c);if(b==c)return!1;a=quh(a);return b&&null==c&&a&&a.isVisible()&&null!=a.C.Bb()&&a.C.Bb().isVisible()?!1:!0}function puh(a,b){if(b){a.Ika();var c=tuh(a);if(c){var d=IU(a.J,b);var e=bN(a.F).gb();var f=N().uF()(b),h=N().LN()(b),k=null;h&&(k=(h=N().Yha()(h))?parseInt(h,10):null);e=new ysh(b,f,k,e);Znc(c,d,e);4==e.C&&Prh(c);uuh(a,b,c,d);a.H=b}}else a.Ika()}
p.Ika=function(){var a=quh(this);a&&a.setVisible(!1);(a=ruh(this))&&a.setVisible(!1);this.H=null};p.Yjb=function(){var a=tuh(this);a&&(a.La().focus(),this.ma.Db(2))};p.O1a=function(){var a=ouh(this);if(a)switch(N().uF()(a)){case 1:zgb.kb(a);break;case 5:Bgb.kb(a);break;case 3:Ggb.kb(a);break;case 2:Agb.kb(a);break;case 4:whb.kb(a)}};p.k0a=function(){var a=ouh(this);if(a){var b=N().LN()(a);b&&(a=N().qT()(b))&&dN(this.F,a,function(){Zx.kb(new vjf(b,"show-current-source"))})}};
p.Zjb=function(a){var b=bN(this.F),c=qJ(this.C);c&&b&&3!=b.getSheetType()&&(a=a.Kj)&&tcc(a)&&(this.H$(),fEc(c))};
function tuh(a){var b=ouh(a);if(!b)return null;var c=N().uF()(b);if(4==c)if(3!=bN(a.F).getSheetType())a=null;else{if(!a.D){c=qJ(a.C);b=c.Ze();a.D=new Unc(a.xa,b,a.O.ud());a.L.listen(a.D,"refresh-db-object-request",a.O1a).listen(a.D,"db-connection-settings",a.k0a);c=new as(c.Ha.J,b?5:1);a.D.render();var d=a.D;d.ma=c;d.ea=b}a=a.D}else if(2==c)if(a=qJ(a.C))a:if(c=a.J.C,G6e(a)==b)b=A6e(a.J).Pd().getId(),a=VEc(a,b);else{for(d=c.length-1;0<=d;d--){var e=c[d];if(e&&N().RZ()(e)==b){a=VEc(a,e);break a}}a=
null}else a=null;else a=ruh(a);return a}function quh(a){return(a=qJ(a.C))?UEc(a):null}function ruh(a){a=qJ(a.C);return a?(a=a.Sa)?a.F:null:null}function ouh(a){return(a=qJ(a.C))?Rrh(a):null}function uuh(a,b,c,d){(Xx.isEnabled()||$nc(c))&&vuh(d.getType())&&(c.OP(),w5e(a.J,b,function(e){return c.Zl(e)},function(e){return c.Gz(e)}))}function vuh(a){return"no-results"==a||"fetch-successful"==a||"fetch-failed"==a}function wuh(a){C.call(this,a)}v(wuh,C);wuh.prototype.Gd=function(){return this.message.Gd()};
function xuh(a){this.hb=eh(a,-1,0)}v(xuh,hh);xuh.prototype.toBuilder=function(){return new wuh(this)};xuh.prototype.Gd=function(){return ph(this,1)};function yuh(a,b){PG.call(this,154);this.C=a;this.D=b}v(yuh,PG);yuh.prototype.Nd=function(){var a=void 0===a?jh(xuh):a;a=new wuh(a);a=Ah(a,1,this.C);return zh(a,2,this.D).build()};function zuh(a,b){sP.call(this,"",a,b);this.Jb(!0)}v(zuh,sP);zuh.prototype.Pg=function(){return Auh(this)};
zuh.prototype.getContent=function(){var a=this.qa().Ca("SPAN",{"class":"waffle-filter-by-value-additional-values-item"});nk(a,Auh(this));return[a]};function Auh(a){return Snc.format(a.Ta())+" additional values in the full data set"}function Buh(a,b){this.C=a;this.D=b}Buh.prototype.getFormattedValue=g("C");Buh.prototype.Li=g("D");function Cuh(a,b){D$e.call(this,"",a,b);this.Vm(!0);this.Jb(!0)}v(Cuh,D$e);Cuh.prototype.Pg=function(){return Duh(this)};
Cuh.prototype.getContent=function(){var a=this.Ta(),b=[],c=this.qa().Ca("DIV",{"class":"goog-menuitem-checkbox"});b.push(c);c=this.qa().Ca("SPAN",{"class":"waffle-filter-by-value-item-freq"});if(a=a.Li())a=1E3>a?Snc.format(a):Tnc.format(a),nk(c,a);b.push(c);c=this.qa().Ca("SPAN",{"class":"waffle-filterable-by-text-contains-menu-item-label"});nk(c,Duh(this));b.push(c);return b};function Duh(a){return N().aD()(a.Ta().getFormattedValue().qb())}
function Euh(a){a=a||{};var b='<div class="'+U("waffle-filter-by-value-sidebar-header-wrapper")+'"><div class="'+U("waffle-filter-by-value-sidebar-column-info")+'" id="'+U("waffle-filter-by-value-sidebar-column-info")+'"></div><div class="'+U("waffle-filter-by-value-search-container")+'">'+tw("docs-icon-img docs-icon-search-this-document")+qbf(void 0,"waffle-filter-by-value-search-input",void 0,void 0,void 0,void 0,void 0,void 0,void 0,Pr('tabindex="0" role="textbox"'))+'</div><div class="'+U("waffle-filter-by-value-menu-title")+
'"><div class="'+U("waffle-filter-by-value-menu-title-primary")+'" id="'+U("waffle-filter-by-value-menu-title-primary")+'">';b=b+'Most frequent values</div><div class="'+(U("waffle-filter-by-value-menu-title-secondary")+'" id="'+U("waffle-filter-by-value-menu-title-secondary")+'"></div><div class="'+U("waffle-filter-by-value-menu-title-info-icon")+'">'+tw("docs-icon-img docs-icon-info_14")+'</div></div><div class="'+U("waffle-filter-by-value-menu-top-buttons")+'"><div class="'+U("waffle-filter-by-value-menu-sort-buttons")+
'"><div class="'+U("waffle-filter-by-value-sort-by-frequency-desc-button")+" "+U("goog-inline-block")+'"></div><div class="'+U("waffle-filter-by-value-sort-by-frequency-asc-button")+" "+U("goog-inline-block")+'"></div><div class="'+U("waffle-filter-by-value-sort-by-value-asc-button")+" "+U("goog-inline-block")+'"></div><div class="'+U("waffle-filter-by-value-sort-by-value-desc-button")+" "+U("goog-inline-block")+'"></div></div><div class="'+U("waffle-filter-by-value-menu-checked-buttons")+'"><div class="'+
U("waffle-filter-by-value-select-all-button")+" "+U("goog-inline-block")+'"></div><div class="'+U("waffle-filter-by-value-clear-button")+" "+U("goog-inline-block")+'"></div></div></div><div class="'+U("waffle-filter-by-value-menu-filter-disclaimer")+'">');b=b+'This list does not reflect existing filters affecting this column</div><div class="'+(U("waffle-filter-by-value-menu-empty-search-results")+'"></div></div>');var c='<div class="'+U("waffle-filter-by-value-sidebar-content-container")+'"><div class="'+
U("waffle-filter-by-value-sidebar-content-loading")+'"></div><div class="'+U("waffle-filter-by-value-sidebar-content-unavailable")+'">';var d='<div class="'+U("waffle-filter-by-value-content-unavailable-alert-icon")+'">'+Blf()+'</div><div class="'+U("waffle-filter-by-value-content-unavailable-alert-message")+'">';d=d+'Values unavailable</div><div class="'+(U("waffle-filter-by-value-content-unavailable-refresh-message")+'">');d=d+'Values could not be retrieved at this time. Try again by refreshing.</div><div class="'+
(U("waffle-filter-by-value-content-unavailable-refresh-button-wrapper")+'"></div>');d=T(d);c=c+d+'</div><div class="'+U("waffle-filter-by-value-sidebar-content-loaded")+'"><div class="'+U("waffle-filter-by-value-menu")+'" aria-labelledby="waffle-filter-by-value-sidebar-column-info waffle-filter-by-value-menu-title-primary waffle-filter-by-value-menu-title-secondary" tabindex="0" role="menu"></div><h2 class="'+U("waffle-filter-by-value-additional-values-menu-title")+'"><span tabindex="0">';c=c+'Values beyond top 500</span></h2><div class="'+
(U("waffle-filter-by-value-additional-values-menu")+'"></div></div></div>');a=""+nW(Kr({Cs:"waffle-filter-by-value-sidebar",title:"Filter by value",Ez:Or(""+tw("docs-icon-img docs-icon-filter-control")),IJ:Or(b),gq:Or(c),tF:Or('<div class="'+U("waffle-filter-by-value-sidebar-footer-wrapper")+'"><div class="'+U("waffle-filter-by-value-empty-values-wrapper")+'"><div class="'+U("waffle-filter-by-value-empty-values-menu")+'"></div></div><div class="'+U("waffle-filter-by-value-last-updated-time")+'" tabindex="0"></div><div class="'+
U("waffle-filter-by-value-sidebar-footer-button-bar")+'"><div class="'+U("waffle-filter-by-value-cancel-button-wrapper")+'"></div><div class="'+U("waffle-filter-by-value-ok-button-wrapper")+'"></div></div></div>')},a));return T(a)}function Fuh(){return T('<div class="'+U("waffle-filter-by-value-sidebar-header")+'"><div class="'+U("waffle-filter-by-value-sidebar-header-icon")+'"></div><div class="'+U("waffle-filter-by-value-sidebar-header-column-name")+'"></div></div>')}
function Guh(a){S.call(this,a)}v(Guh,S);Guh.prototype.Ca=function(){this.mb(Gr(Fuh))};function Huh(a,b){sP.call(this,"",a,b);this.Jb(!0)}v(Huh,sP);Huh.prototype.Pg=function(){return Iuh(this)};Huh.prototype.getContent=function(){var a=this.qa().Ca("SPAN",{"class":"waffle-filter-by-value-empty-values-item"});nk(a,Iuh(this));return[a]};function Iuh(a){return Snc.format(a.Ta())+" empty values in the full data set"}
function Juh(a,b){RV.call(this,b);this.D=a;this.Sa=new Guh;this.oa(this.Sa);this.xb=new Pv("Search from list of most frequent values");this.ub=null;this.oa(this.ub);this.Zc=new Vt;this.Ia(this.Zc);this.C=new Vt;this.Ia(this.C);this.F=new Vt;this.Ia(this.F);this.L=new nL(Gr(sw,{icon:"docs-icon-img docs-icon-trending-up-18"}),this.qa());this.Ia(this.L);this.J=new nL(Gr(sw,{icon:"docs-icon-img docs-icon-trending-down-18"}),this.qa());this.Ia(this.J);this.O=new nL(Gr(sw,{icon:"docs-icon-img docs-icon-sort_az"}),
this.qa());this.Ia(this.O);this.R=new nL(Gr(sw,{icon:"docs-icon-img docs-icon-sort_za"}),this.qa());this.Ia(this.R);this.ma=null;this.Za=new Mt("Select all",dH.getInstance(),this.qa());this.Ia(this.Za);this.Ha=new Mt("Clear all",dH.getInstance(),this.qa());this.Ia(this.Ha);this.xa=new Ow("OK",this.qa());this.xa.Ob("waffle-filter-by-value-ok-button");this.Ia(this.xa);this.Ea=new nP("Cancel",this.qa());this.Ea.Ob("waffle-filter-by-value-cancel-button");this.Ia(this.Ea);this.bb=this.jb=this.Pa=this.Ra=
this.Ma=this.ea=this.ib=null;this.Eb=new Bnc;this.pb=new zlf;this.Ia(this.pb);this.Cb=!1;this.Aa=new Ow("Refresh",this.qa());this.Ia(this.Aa)}v(Juh,RV);p=Juh.prototype;p.Ca=function(){this.mb(Gr(Euh,{id:this.getId()}))};
p.Ja=function(){RV.prototype.Ja.call(this);this.Sa.render(Tj("waffle-filter-by-value-sidebar-column-info"));var a=this.qa().Da("waffle-filter-by-value-search-input");this.xb.Va(a);this.ub=new mw(a);this.Zc.render(this.$a("waffle-filter-by-value-menu"));ks(this.Zc.La(),"docs-material");this.C.render(this.$a("waffle-filter-by-value-additional-values-menu"));ks(this.C.La(),"docs-material");this.F.render(this.$a("waffle-filter-by-value-empty-values-menu"));ks(this.F.La(),"docs-material");this.L.render(this.$a("waffle-filter-by-value-sort-by-frequency-desc-button"));
this.J.render(this.$a("waffle-filter-by-value-sort-by-frequency-asc-button"));this.O.render(this.$a("waffle-filter-by-value-sort-by-value-asc-button"));this.R.render(this.$a("waffle-filter-by-value-sort-by-value-desc-button"));fu(this.L.La(),"Sort by most frequent values",void 0);fu(this.J.La(),"Sort by least frequent values",void 0);fu(this.O.La(),"Sort by ascending values",void 0);fu(this.R.La(),"Sort by descending values",void 0);Kuh(this,!1);this.Za.render(this.$a("waffle-filter-by-value-select-all-button"));
this.Ha.render(this.$a("waffle-filter-by-value-clear-button"));fu(this.Za.La(),"Select all items below",void 0);fu(this.Ha.La(),"Unselect all items below",void 0);this.xa.render(this.Da("waffle-filter-by-value-ok-button-wrapper"));this.Ea.render(this.Da("waffle-filter-by-value-cancel-button-wrapper"));this.pb.render(this.Da("waffle-filter-by-value-sidebar-content-loading"));this.Aa.render(this.$a("waffle-filter-by-value-content-unavailable-refresh-button-wrapper"));a=this.Da("waffle-sidebar-title-close");
ku(a,"waffle-filter-by-value");this.getHandler().listen(this.xa,"action",this.ekb).listen(this.Ea,"action",this.akb).listen(this.Za,"action",this.gkb).listen(this.Ha,"action",this.bkb).listen(this.O,"action",this.phc).listen(this.R,"action",this.qhc).listen(this.L,"action",this.ohc).listen(this.J,"action",this.nhc).listen(this.Aa,"action",this.fkb).listen(this.ub,"input",this.dkb)};
p.dkb=function(){var a=this.xb.getValue();Luh(this,a);var b=0==Muh(this.Zc);Kuh(this,b);a&&!this.Cb&&(this.D.C(116107),this.Cb=!0);0<this.C.jc()&&Nuh(this,!a)};function Luh(a,b){a.Zc.ze(function(c){c.R5(b)})}
p.refresh=function(a){var b=a.D,c=a.Gd(),d=aG(b,c);this.ib=c;c=this.Sa;var e=c.Da("waffle-filter-by-value-sidebar-header-column-name");c.qa().Ee(e,d);gs(e,d);this.Ma=c=a.getColumnType();d=this.Sa.Da("waffle-filter-by-value-sidebar-header-icon");is(d,"waffle-filter-by-value-sidebar-header-icon");(c=SU(c))&&ks(d,c);this.Ra=a.C;this.Pa=b;this.ea=a.JH;this.jb=a.F;this.bb=a.QLa;Kuh(this,!1);a=N().VNb()(this.ib);b=this.Da("waffle-filter-by-value-menu-filter-disclaimer");Q(b,a);this.focus()};
function Ouh(a,b,c){Puh(a,"loading");c.addCallback(function(d){if(d&&b.equals(a.Pa)){a.Zc.od(!0);a.C.od(!0);a.F.od(!0);var e=uh(d,18,hU).Gb(),f=sh(d,10),h=a.Da("waffle-filter-by-value-menu-title-secondary"),k=500<f,l=k?"showing up to 500":"showing "+(f+" total");nk(h,"("+l+")");gs(h,l);h=a.Da("waffle-filter-by-value-menu-title-info-icon");Q(h,k);k&&(fu(h,"This list shows max 500 most frequent values from the full data set. Scroll to bottom to choose to include or exclude remaining values.",void 0),
hu(h,2,2),eS(h,"waffle-filter-by-value-menu-title-info-icon-tooltip"));k=a.Da("waffle-filter-by-value-menu-empty-search-results");h=500<f?"No values found in top 500 values":"No values found";nk(k,h);gs(k,h);d=sh(d,11);f=(k=500<f)?f-500:null;for(h=0;h<e.length;h++){l=e[h];var n=l.getFormattedValue(),q=n.getValue();0==q.ls()||2==q.ls()&&""==q.getStringValue()||(l=new Cuh(new Buh(n,l.Ld()),a.qa()),a.Zc.Ia(l,!0),l.Ob("apps-menuitem"),ok(l.getElement(),!0),Quh(a,l),l=l.Da("waffle-filter-by-value-item-freq"),
fu(l,"Number of instances of this value in the column",void 0))}e=null;a.ea&&lh(a.ea,2)&&0<mh(a.ea.C(),9)&&(e=a.ea.C());null!=e?Ruh(a,e,k,f,d):Suh(a,k,!0,f,!0,d);Tuh(a);Puh(a,"loaded");a.focus()}})}
function Ruh(a,b,c,d,e){var f=b.sx(),h=uh(b,9,Ih).Gb(),k=[];a.Zc.ze(function(u){var z=u.Ta().getFormattedValue().getValue();k.push(z);z=Uuh(h,z);f&&(z=!z);u.Jb(z)});for(var l=b=!1,n=0;n<h.length;n++){var q=h[n],t=0==q.ls();t&&(b=!0);t||Uuh(k,q)||(c=!0,l=N().fOb()(a.Ma),l=ih(Jh,l),q=r0e(Vpa().setValue(q),l).build(),q=new Cuh(new Buh(q,null),a.qa()),q.Jb(!f),a.C.Ia(q,!0),q.Ob("apps-menuitem"),Quh(a,q),ok(q.getElement(),!0),l=!0)}Suh(a,c,f,d,f&&!b||!f&&b,e);l&&a.D.C(116087)}
function Uuh(a,b){for(var c=0;c<a.length;c++)if(b.equals(a[c]))return!0;return!1}function Suh(a,b,c,d,e,f){d&&(d=new zuh(d,a.qa()),d.Jb(c),a.C.Ia(d,!0),d.Ob("apps-menuitem"),Quh(a,d),ok(d.getElement(),!0));Nuh(a,b);b&&a.D.C(116088);if(b=0<f)f=new Huh(f,a.qa()),f.Jb(e),a.F.Ia(f,!0),f.Ob("apps-menuitem"),Quh(a,f),ok(f.getElement(),!0);a=a.Da("waffle-filter-by-value-empty-values-wrapper");Q(a,b)}
function Nuh(a,b){a.C.setVisible(b);(a=a.$a("waffle-filter-by-value-additional-values-menu-title"))&&Q(a,b)}function Puh(a,b){a.xb.reset();var c=a.Da("waffle-filter-by-value-sidebar-header-wrapper");Q(c,"loaded"==b);c=a.Da("waffle-filter-by-value-sidebar-content-loaded");Q(c,"loaded"==b);c=a.Da("waffle-filter-by-value-sidebar-footer-wrapper");Q(c,"loaded"==b);c=a.Da("waffle-filter-by-value-sidebar-content-unavailable");Q(c,"unavailable"==b);Alf(a.pb,"loading"==b)}
function Vuh(a){Puh(a,"unavailable");fu(a.Aa.La(),"Estimating\u2026",void 0)}function Kuh(a,b){var c=a.Da("waffle-filter-by-value-menu-empty-search-results");Q(c,b);b=!b;c=a.isEnabled();try{a.Oa(!0),a.L.Oa(b),a.J.Oa(b),a.O.Oa(b),a.R.Oa(b),b&&a.ma?Wuh(a.ma):Xuh(a)}finally{a.Oa(c)}}p.Zl=function(a){a=a?are(a):"";fu(this.Aa.La(),a,void 0)};
p.Z9a=function(a){var b=this.Da("waffle-filter-by-value-last-updated-time");a="Updated: "+this.Eb.format(a);nk(b,a);fu(b,"Last time the values were retrieved",void 0);gs(b,a+" Last time the values were retrieved");hu(b,2,2);xS(b,18)};
p.ekb=function(){var a=Yuh(this),b=[];this.Zc.ze(function(e){a^e.isChecked()&&b.push(e.Ta().getFormattedValue().getValue())});this.C.ze(function(e){a^e.isChecked()&&(e instanceof zuh||b.push(e.Ta().getFormattedValue().getValue()))});if(1==this.F.jc()){var c=this.F.Bc(0),d=Kpa(0).build();a^c.isChecked()&&(b.push(d),this.D.C(116094))}bib.kb(new NW(null,this.Ra,this.Pa,this.Ma,this.ea,this.jb,this.bb,a,b));Zuh(this)};
function Yuh(a){var b=!0,c=!0;if(a.C.isVisible()&&0<a.C.jc()){var d=a.C.Bc(a.C.jc()-1);d instanceof zuh&&(c=!1,b=d.isChecked(),a.D.C(b?116108:116109))}c&&$uh(a.Zc)<a.Zc.jc()/2&&(b=!1);return b}function Quh(a,b){a.getHandler().listen(b,"action",a.LDa).listen(b.La(),"keydown",function(c){32!=c.keyCode&&13!=c.keyCode||b.Jb(!b.isChecked())})}p.LDa=function(){var a=0<$uh(this.Zc)+$uh(this.C)+$uh(this.F);this.xa.Oa(a)};function $uh(a){var b=0;a.ze(function(c){c.isChecked()&&b++});return b}
function Muh(a){var b=0;a.ze(function(c){c.isVisible()&&b++});return b}function Zuh(a){var b=null;switch(a.Ra){case 2:b=116090;break;case 1:b=116093;break;case 4:b=116091;break;case 5:b=116092}a.D.C(b)}p.akb=function(){this.D.C(116089);this.dispatchEvent("close-sidebar")};p.gkb=function(){this.D.C(116102);avh(this,!0);this.LDa()};p.bkb=function(){this.D.C(116101);avh(this,!1);this.LDa()};p.fkb=function(){cib.kb(new NW(this.ib,this.Ra,this.Pa,this.Ma,this.ea,this.jb,this.bb,null,null));this.D.C(116147)};
function avh(a,b){a.Zc.ze(function(c){c.isVisible()&&c.Jb(b)});a.C.ze(function(c){c.isVisible()&&c.Jb(b)});a.F.ze(function(c){c.isVisible()&&c.Jb(b)})}p.phc=function(){this.D.C(116105);bvh(this,this.scb,!1);Wuh(this.O);this.ma=this.O};p.qhc=function(){this.D.C(116106);bvh(this,this.scb,!0);Wuh(this.R);this.ma=this.R};p.ohc=function(){this.D.C(116104);Tuh(this)};function Tuh(a){bvh(a,a.oWa,!0);Wuh(a.L);a.ma=a.L}p.nhc=function(){this.D.C(116103);bvh(this,this.oWa,!1);Wuh(this.J);this.ma=this.J};
p.scb=function(a,b){var c=a.Ta().getFormattedValue().getValue(),d=b.Ta().getFormattedValue().getValue();c.ls();d.ls();return 3==c.ls()?c.Ov()-d.Ov():Xd(Duh(a),Duh(b))};p.oWa=function(a,b){return a.Ta().Li()-b.Ta().Li()};function bvh(a,b,c){Xuh(a);var d=cvh(a);a.Zc.od();Nd(d,b);if(c)for(b=d.length-1;0<=b;b--)a.Zc.Ia(d[b],!1);else for(b=0;b<d.length;b++)a.Zc.Ia(d[b],!1)}function Wuh(a){ks(a.La(),"waffle-filter-by-value-active-sort-button")}
function Xuh(a){ms(a.L.La(),"waffle-filter-by-value-active-sort-button");ms(a.J.La(),"waffle-filter-by-value-active-sort-button");ms(a.O.La(),"waffle-filter-by-value-active-sort-button");ms(a.R.La(),"waffle-filter-by-value-active-sort-button")}function cvh(a){var b=[];a.Zc.ze(function(c){b.push(c)});return b}
function dvh(a,b,c,d){OU.call(this,a,d);var e=this;this.C=b;this.F=c;Rp(this.J,cib,function(f){return evh(e,f.data)});Rp(this.J,bib,function(){return e.Ys()});this.D.listen(this.C.C,"na",this.ikb).listen(this.F,"selectionChange",this.hkb)}v(dvh,OU);p=dvh.prototype;p.Bf=function(){return Zhb};p.wm=function(){return $hb};p.ikb=function(){this.Ys()};p.hkb=function(){this.Ys()};p.Ys=function(){this.fc.Oa(!1);OU.prototype.Ys.call(this)};
function evh(a,b){a.fc.refresh(b);a.Wo(!0);var c=ol(),d=b.D;Ouh(a.fc,d,c);var e=b.Gd();u5e(a.C.Ea,e,d).then(function(f){c.callback(f.C);a.fc.Z9a(f.D)},function(){c.callback(null);a.fc&&(Vuh(a.fc),nse(a.C.Ea,e,d).then(function(f){a.fc&&a.fc.Zl(f)},function(){a.fc&&a.fc.Zl(null)}))})}function fvh(a,b){this.D=a;this.C=b}function gvh(a){this.D=a;this.C={}}
function hvh(a,b){if(b){var c=y(A(),"feds")?N().vya()(b):[],d=new Set(c),e=(new Date).getTime();b.forEach(function(f){if(a.C[f]){var h=B3b(f),k=h?h.getState():null;if(h&&k&&(2==k||3==k)){h=e-a.C[f].D;if(k=d.has(f)?itd[k]:gtd[k]){h=lj(new kj,1E3*h);var l=a.C[f].C;var n=new PYd;l=K(n,2,l);if(n=N().aOb()(f))K(l,5,n.columns),K(l,4,n.rows);l=pj(C0e(l),!0);h=xq(vq(tq(new sq,41),h),l);a.D.C(k,h.build())}delete a.C[f]}}})}}function ivh(a){C.call(this,a)}v(ivh,C);ivh.prototype.Gd=function(){return this.message.Gd()};
function jvh(a){this.hb=eh(a,-1,0)}v(jvh,hh);jvh.prototype.toBuilder=function(){return new ivh(this)};jvh.prototype.Gd=function(){return ph(this,1)};function kvh(a){C.call(this,a)}v(kvh,C);kvh.prototype.Gd=function(){return this.message.Gd()};function lvh(a){this.hb=eh(a,-1,0)}v(lvh,hh);lvh.prototype.toBuilder=function(){return new kvh(this)};lvh.prototype.Gd=function(){return ph(this,1)};function mvh(a,b){PG.call(this,139);this.C=a||"";this.D=b}v(mvh,PG);
mvh.prototype.Nd=function(){var a=void 0===a?jh(jvh):a;a=new ivh(a);a=Ah(a,1,this.C);return Fh(a,2,this.D).build()};mvh.prototype.Ry=function(){return kh(jh(lvh))};
function nvh(){var a='<div class="'+U("waffle-targeted-cs-promo-content")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/connectedSheetsPromoOnboardingImage.jpg" class="'+U("waffle-targeted-cs-promo-image")+'"><div class="'+U("waffle-targeted-cs-promo-text")+'"><div class="'+U("waffle-targeted-cs-promo-title")+'" id="'+U("waffle-targeted-cs-promo-title")+'">';a=a+'Analyze billions of rows of BigQuery data in Sheets</div><div class="'+(U("waffle-targeted-cs-promo-body")+'"><span id="'+U("waffle-targeted-cs-promo-body-text")+
'">');a=a+'Create charts, pivot tables and functions over the entire dataset, or extract a subset of the dataset directly into Google Sheets.</span> <span class="'+(U("waffle-targeted-cs-promo-link-button")+" "+U("goog-link-button")+'"><a href="https://cloud.google.com/blog/products/g-suite/connected-sheets-is-generally-available" target="_blank">');return T(a+"Learn more</a></span></div></div></div>")}
function ovh(){return T(L6a({Tf:"docs-material waffle-targeted-cs-promo-close",hidden:!1,enabled:!0}))}function pvh(a,b){OW.call(this,a,{Uwa:!1,Vwa:!1,PBa:!1,jo:!1},b);this.D.setContent("Try it now");this.setPosition(2,1);this.Ob("waffle-targeted-cs-promo-base");Jt(this,!1);this.J=new Mt(void 0,rw.getInstance(),b);this.Ia(this.J)}v(pvh,OW);p=pvh.prototype;
p.Ca=function(){OW.prototype.Ca.call(this);var a=this.La(),b=Gr(ovh),c=fs(b);fu(b,c,void 0);dk(a,b);this.J.Va(b);b=Gr(nvh);this.setContent(b);bs(a,"alertdialog");ds(a,"labelledby","waffle-targeted-cs-promo-title");ds(a,"describedby","waffle-targeted-cs-promo-body-text")};p.Ja=function(){var a=this;OW.prototype.Ja.call(this);os(this.Da("docs-icon-close-white"),"waffle-targeted-cs-promo-hc","white"==ju());this.getHandler().listen(this.J,"action",function(){return a.Bda()})};
p.render=function(){OW.prototype.render.call(this);var a=this.Da("jfk-bubble-arrow-id");Q(a,!1)};p.IAa=function(){this.setVisible(!1);hpb.kb();zr("https://docs.google.com/spreadsheets/create?fbpf=true")};p.Bda=function(){this.setVisible(!1);ipb.kb()};
function qvh(a,b,c,d){B.call(this);var e=this;this.C=a.F;this.H=b;this.L=c;this.eb=d;this.J=!1;this.D=-1;this.F=new Pm(this);this.oa(this.F);this.F.listen(LG,"trigger-targeted-bigsheets-promo",function(f){if(rvh(e)&&1==e.D){var h=Orh(e.C);h.setValue(h.getValue()+1);e.J=!0;h=e.eb.getElement("waffle-assistant-entry-button-icon");h=new pvh(h,e.eb);var k=new y8a(h,!0,!0,!0);e.L.Zg(k);h.render();h=new tZd;K(h,4,f.trigger);f=new nj;Pi(f,43,h);e.H.C(116141,tq(xq(new sq,f),19).build())}})}v(qvh,B);
function svh(a){(y(A(),"fedt")||y(A(),"fdsvo"))&&rvh(a)?Trh().then(function(b){a.D=sh(b,1);if(1==a.D){b=new tZd;var c=Orh(a.C).getValue();K(b,3,c);c=new nj;Pi(c,43,b);a.H.C(116155,tq(xq(new sq,c),19).build())}}):a.D=0}function rvh(a){var b=a.C.F["ritz-HasCreatedDatasheet"].getValue(),c=Orh(a.C).getValue();return!b&&3>=c&&!a.J}
function tvh(){var a='<div class="'+U("waffle-dataconnector-delegation-banner-wrapper")+'"><div class="'+U("waffle-dataconnector-delegation-banner")+'" tabindex="0" role="complementary"><div class="'+U("waffle-dataconnector-delegation-banner-info-icon")+'">'+tw("docs-icon-img docs-icon-info")+'</div><div class="'+U("waffle-dataconnector-delegation-banner-header")+'">';a=a+'Delegated access</div><div class="'+(U("waffle-dataconnector-delegation-banner-info")+'"></div><div class="'+U("waffle-dataconnector-delegation-banner-close-button-wrapper")+
'"></div></div></div>');return T(a)}function uvh(a,b){S.call(this,b);this.C=null;this.F=a;this.D=new nL(Gr(sw,{icon:"docs-icon-img docs-icon-close"}),this.qa());this.D.Ob("waffle-dataconnector-delegation-banner-close-button");this.Ia(this.D)}v(uvh,S);p=uvh.prototype;p.Ca=function(){S.prototype.Ca.call(this);this.mb(Gr(tvh));this.D.render(this.Da("waffle-dataconnector-delegation-banner-close-button-wrapper"))};
p.Ja=function(){S.prototype.Ja.call(this);Q(this.La(),!0);this.getHandler().listen(this.D,"action",this.kkb);vvh(this)};
p.refresh=function(){if(!this.isDisposed()){var a=!!this.C&&nh(U4e(this.C),1),b=a?ph(this.C.sb(3,R4e),1):null;a&&b?(a=new ox,b="This sheet is associated with "+(a.Hc("strong")+(b+(a.Gc("strong")+("'s credentials. Any BigQuery-related activity will be billed to their account. "+(a.Hc("a",{href:"https://connectedsheets.page.link/delegate",target:"_blank"})+("Learn more"+a.Gc("a"))))))),b=a.format(b),a=this.Da("waffle-dataconnector-delegation-banner-info"),hf(a,b),this.setVisible(!0)):this.setVisible(!1)}};
function vvh(a){var b=bN(a.F);b&&b.Gd()&&(b=b.Gd(),b=ish(b).build(),Irh(b).then(function(c){a.isDisposed()||(c=uh(c,1,T4e).Gb(),0==c.length?a.C=null:a.C=c[0],a.refresh())}))}p.setVisible=function(a){Q(this.La(),a);xxe()};p.kkb=function(){this.setVisible(!1)};function wvh(a){B.call(this);this.D=a;this.F=new Pm(this);this.oa(this.F);this.C=null;this.F.listen(this.D,["na"],this.H).listen(this.D,["oa"],this.J)}v(wvh,B);
wvh.prototype.H=function(){var a=bN(this.D);a&&JC(a)&&(this.C?this.C.refresh():(this.C=new uvh(this.D),a=this.C.qa(),this.C.render(a.getElement("waffle-db-delegation-banner-id"))))};wvh.prototype.J=function(){this.C&&this.C.setVisible(!1)};wvh.prototype.Na=function(){B.prototype.Na.call(this);Xf(this.C)};function xvh(a){B.call(this);this.C=U4e(a);this.F=ph(a,1)||null;this.D=new Hif(500,500,"dbxScheduleOnCompleteAuth");this.oa(this.D)}v(xvh,B);
function yvh(a,b,c){c=void 0===c?!0:c;nh(a.C,1);var d=csh(esh(),a.C);b&&Ah(d,3,b);xrh(vH.getInstance(),d.build()).then(function(e){zvh(a,e.getStatus(),ph(e,2),!0,c)},function(){return Avh()})}function Bvh(a,b,c){c=void 0===c?!0:c;var d=rsh(qsh(tsh(),a.F),a.C);b&&Ah(d,3,b);yrh(vH.getInstance(),d.build()).then(function(e){zvh(a,e.getStatus(),ph(e,2),!1,c)},function(){return Avh()})}
function zvh(a,b,c,d,e){switch(b){case 2:if(!e){Avh();break}Iif(a.D,c,function(f){d?yvh(a,f,!1):Bvh(a,f,!1)});break;case 3:bv.getInstance().postMessage(dv("You do not have permission to delegate access for this BigQuery project. The delegated access settings were not saved. Contact your admin or check BigQuery project settings.","error",!0))}}function Avh(){bv.getInstance().postMessage(dv("There was a problem saving the delegated access settings. Please check connection settings.","error",!0))}
function Cvh(a){switch(a){case 1:return 3;case 2:return 2;case 3:return 4;case 4:return 1;case 5:return 5;case 6:return 6;case 0:return 0}}var Dvh={ok:"OK",cancel:"Learn more"};
function Evh(a,b,c,d,e,f,h,k,l,n,q,t,u){Djf.call(this,a,b,d,f,h,k,l);var z=this;this.Ea=Oj("docs-chrome")?new Uth(b,this.D,l,q,f,c,n,d,u,t,k.ud()):null;this.oa(this.Ea);this.bb=f;this.xa=new Pm(this);this.oa(this.xa);this.pb=new luh(a,b,c,d,e,k,l);this.oa(this.pb);this.O=n;this.Aa=a.D.C;this.Sa=new gvh(l);this.Za=t;this.Wa=c;y(A(),"febsfbv")&&(d=new Juh(l),d.render(),d.setVisible(!1),this.xb=new dvh(d,a,c,e),this.oa(this.xb));this.jb=new iuh(a,b,c,l,e,n,u);this.oa(this.jb);this.R=new Set;this.ea=
new Set;if(c=y(A(),"fetbp"))this.Pa=new qvh(a,l,this.Ha,Lj()),this.oa(this.Pa),svh(this.Pa);this.Ra=!1;y(A(),"feddab")&&(this.ub=new wvh(b),this.oa(this.ub));(b=Lw.getInstance().C.newDatasourceIdFromOnboarding)?Fvh(this,b):$qh()?Gvh(this,new tW(null,ih(saf,$qh())),!1):Lw.getInstance().C.showBigSheetsOnboardingDialogOnStart&&Yx.isEnabled()?y(A(),"fdcws")?Hvh(this):this.U$a():arh()&&Yx.isEnabled()&&c&&(y(A(),"fdcws")?Hvh(this):this.Xaa());this.xa.listen(this.D,"db-execution-status-updated",this.lkb).listen(this.D,
"datasources-changed",this.t0b).listen(this.F,"na",this.h9b).listen(this.F,"na",this.nbb).listen(this.F,"na",this.e1b);this.Ma=new Nm;this.oa(this.Ma);this.Ma.wb(a.L.H,function(E){z.nbb();Ivh(z,E)})}v(Evh,Djf);p=Evh.prototype;
p.oSa=function(a){a.C(shb,mP).D(shb,mP).C(vhb,mP).C(Zx,ssd).D(Zx,ssd).C(Wx,mP).D(Wx,mP).C(whb,mP).C(Ugb,ssd).C(Zkb,ssd).C(yhb,mP).C(zhb,mP).C(Ahb,mP).C(Bhb,mP).C(Xx,mP).C(xhb,mP).C(Ux,mP).C(Vx,mP).C(phb,mP).C(Chb,mP).C(Dhb,tsd).D(Dhb,tsd).C(qhb,rsd).C(rhb,mP).D(rhb,mP);var b=y(A(),"feds");a.C(zgb,b?usd:mP);a.C(Bgb,b?usd:mP);a.C(Agb,b?usd:mP);a.C(Ggb,mP);a.C(Sx,b?usd:mP)};
p.Nab=function(){var a=this;this.ma.subscribe(vhb,"action",this.Qa).subscribe(shb,"action",this.C1b).subscribe(Wx,"action",this.pjc).subscribe(Zx,"action",this.Tyc).subscribe(whb,"action",function(b){return Jvh(a,4,b)}).subscribe(Agb,"action",function(b){return Kvh(a,b)}).subscribe(Bgb,"action",function(b){return Jvh(a,5,b)}).subscribe(zgb,"action",function(b){return Jvh(a,1,b)}).subscribe(Ggb,"action",function(b){return Jvh(a,3,b)}).subscribe(Ugb,"action",this.Dgc).subscribe(yhb,"action",this.Xaa).subscribe(zhb,
"action",this.ygc).subscribe(Zkb,"action",this.Mgc).subscribe(Ahb,"action",this.V$a).subscribe(Bhb,"action",this.Myc).subscribe(Sx,"action",function(b){Lvh(a,b.C)}).subscribe(Chb,"action",this.qjc).subscribe(Dhb,"action",this.hkc).subscribe(Ux,"action",function(){return Mvh(a,null,!0)}).subscribe(Vx,"action",this.kLb).subscribe(phb,"action",this.UJb).subscribe(qhb,"action",this.JCc).subscribe(rhb,"action",this.F1b)};p.lkb=function(a){a=a.D;hvh(this.Sa,a);Nvh(this,a)};
function Nvh(a,b){b&&b.forEach(function(c){var d=B3b(c);2===(d?d.getState():null)&&4===N().uF()(c)&&(c=N().LN()(c))&&(d=a.D.ea,d.C.delete(c),XH(d,c))})}p.pjc=function(a){Ovh(this,a.Gd(),a.C,a.D)};
p.Tyc=function(a){var b=this,c=a.Gd(),d=a.C;if("pick-new source"==d||"change-cloud-project"==d)this.Xaa(a);else{var e=ih(saf,N().XWa()(c)),f=new vW(vH.getInstance());this.L.addCallback(function(h){if(y(A(),"fdcws")&&lh(e,3)&&lh(rV(e),4)){var k=h.$Mb(c,e);b.oa(k);oW(b.C,k)}else if(!Wx.isEnabled()&&lh(e,3)&&lh(rV(e),4))k=h.ZMb(c,e),b.oa(k),oW(b.C,k);else{var l=Gjf("Connecting to BigQuery\u2026");k=Zif(f);var n=Pvh(c);Xm([k,n]).then(function(q){cv(bv.getInstance(),l);q=h.Zxa(c,e,q[0],void 0,q[1]||void 0);
b.oa(q);oW(b.C,q)},function(){cv(bv.getInstance(),l);b.V8();var q=h.Zxa(c,e,[],!0);b.oa(q);oW(b.C,q)})}})}};p.V$a=function(a){var b=this;this.L.addCallback(function(c){var d=a.F,e=d?d.C:null,f=d?d.Gd():null;d=d?d.D:null;if(f&&e){var h=lh(rV(e),4)?zsh(e):e;Pvh(f,d).then(function(k){k=c.Zxa(f,h,a.C,void 0,k||void 0);b.oa(k);oW(b.C,k)})}else f?Pvh(f,d).then(function(k){k=c.hWa(a,k||void 0);b.oa(k);oW(b.C,k)}):(e=c.hWa(a),b.oa(e),oW(b.C,e))})};
p.Myc=function(a){var b=this;this.L.addCallback(function(c){var d=Gjf("Connecting to BigQuery\u2026");Zif(new vW(vH.getInstance())).then(function(e){cv(bv.getInstance(),d);e=c.iWa(a,e);b.oa(e);oW(b.C,e)},function(){cv(bv.getInstance(),d);b.V8();var e=c.iWa(a,[]);b.oa(e);oW(b.C,e)})})};function Pvh(a,b){b=void 0===b?null:b;if(!y(A(),"fedd"))return Tm(null);if(b)return Tm(prh(ksh(),b).build());a=ish(a).build();return Irh(a).then(aa(),m(null))}p.C1b=function(a){Ovh(this,null,a.C,a.D)};
function Ovh(a,b,c,d){var e=null==b,f=new mvh(b,c);e&&(a.H.C(lh(c,3)&&lh(rV(c),4)?116023:116024),c=a.D.F.F["ritz-HasCreatedDatasheet"],c.getValue()||c.setValue(!0),arh()&&a.H.C(116186));QG(f,function(h,k){if(h){h=k.Gd();Qvh(a,h,d,e);k=N().WNb()(h);var l=N().PNb()(k,h);Rvh(a,l,4,[k]);e?Fvh(a,h):XH(a.D.ea,b)}});a.O.C(f);e||kif(a.C)}p.qjc=function(a){Qvh(this,a.Gd(),a.D,!1,a.C);kif(this.C)};
function Qvh(a,b,c,d,e){e=void 0===e?null:e;y(A(),"fedda")&&d&&(c&&nh(U4e(c),1)?a.H.C(116204):a.H.C(116205));y(A(),"fedd")&&c&&(a.H.C(116192),ph(c,1)||nh(U4e(c),1))&&(d=uaf().wc(b),e?Fh(d,2,e):(b=ih(saf,N().XWa()(b)),Fh(d,2,b)),b=vaf().Oa(nh(U4e(c),1)),d=Fh(b,2,d),d=V4e(d),ph(c,1)&&(c=ph(c,1),Ah(d,1,c)),c=new xvh(d.build()),a.oa(c),c.F?Bvh(c,null):yvh(c,null))}
p.U$a=function(){var a=this,b=this.D.F.D["ritz-DisplayCountBigsheetsWelcomeDialog"],c=b.getValue();if(1<=c)this.Xaa();else{b.setValue(Math.min(c+1,2147483647));var d=new Yth;this.oa(d);oW(this.C,d);d.getResult().then(function(e){e?a.Xaa():Xf(d)},function(){Xf(d)})}};function Fvh(a,b){var c=Lw.getInstance().C.transientErrorFromOnboarding;c?(Svh(a),mn(function(){kif(a.C);Ugb.kb(new VH("",ih(Gh,c)))},3E3)):(a.R.add(b),Svh(a))}
function Svh(a){var b=new $th("//ssl.gstatic.com/docs/spreadsheets/bigsheets_loading_3.gif",a.H);a.oa(b);oW(a.C,b)}function Mvh(a,b,c){var d=bN(a.F);if(d&&JC(d)){var e=d.Gd();XH(a.D.ea,e).then(function(f){var h=new KWb(f,e),k=tq(new sq,103).build();f=new Psh(e,b,f,h,a.D.Qa,c,a.O,a.Za,a.Aa,a.H,k);a.oa(f);a.xa.listen(f,"update",a.d_b);oW(a.C,f)})}}function Hvh(a){var b=new Ish;a.oa(b);oW(a.C,b)}p.kLb=function(){var a=bN(this.F);a&&JC(a)&&(a=Tvh(a),Mvh(this,a[0],!0))};
p.JCc=function(){var a=bN(this.F);a&&JC(a)&&(a=Tvh(a),Mvh(this,a[0],!1))};p.UJb=function(){var a=this,b=bN(this.F);if(b&&JC(b)){var c=Tvh(b),d=c.length;d=(new Iv("{NUM_COLUMNS, plural,=1 {Are you sure you want to delete this calculated column?}other {Are you sure you want to delete {NUM_COLUMNS} calculated columns?}}")).format({NUM_COLUMNS:d});aN(this.bb,d,function(){return Uvh(a,b.Gd(),c)})}};function Uvh(a,b,c){b=new yuh(b,c);QG(b,function(d){a.H.C(d?36648:36649)});a.O.C(b)}
p.d_b=function(a){var b=bN(this.F);b&&JC(b)&&b.Gd()==a.hn&&a.C&&(a=b.Ac(),b=a.Uf(),OF(a,XNb(a,EG(a,b-1,b))))};function Tvh(a){a=a.Ac();var b=tG(a);return qnc(a,b).map(function(c){return ph(c,2)})}p.t0b=function(){var a=this.D.L;a.O&&a.D.clearCache()};p.h9b=function(){Frh(this.D.L,bN(this.F))};p.e1b=function(){if(this.Ea&&!jif(this.C)){var a=this.Ea;a.C&&Sth(a.C)}};
p.nbb=function(){var a=bN(this.F);if(a&&JC(a)){var b=a.Gd();if(this.R.has(b)){var c=N().YWa()(a.gb());if(c)if(c=IU(this.D.L,c),"fetch-successful"==c.getType()){a=a.Ac().Uf();var d=N().Yha()(b);c=null;null!==d&&(d=parseInt(d,10),0<d&&(c=Snc.format(d)));a=new duh(a,c);this.oa(a);oW(this.C,a,!0);this.R.delete(b)}else"fetch-failed"==c.getType()&&(jif(this.C)instanceof $th&&lif(this.C),this.R.delete(b))}}};
p.Xaa=function(a){var b=this,c=void 0;a&&(c=new tW(a.Gd(),null));var d=new Csh(new vW(vH.getInstance()),this.H,c);this.oa(d);oW(this.C,d);arh()&&!this.Ra&&(Fsh(d),this.Ra=!0);Jjf(d.La());d.getResult().then(function(e){if(a&&"change-cloud-project"==a.C){var f=a.D;e=new Yif(f.C,f.H,"db-source-table"===e.D?e.J:null,e.D,e.F)}b.V$a(e)},function(e){e&&b.V8();Xf(d)})};p.ygc=function(a){Gvh(this,a,!0)};function Gvh(a,b,c){a.L.addCallback(function(d){d=d.YMb(b,c);a.oa(d);oW(a.C,d)})}
p.V8=function(){this.H.C(36685);Ijf("Could not connect to BigQuery")};function Jvh(a,b,c){var d=a.D.L,e=IU(d,c).C;a.H.C(36985);null!=e&&lh(e,2)&&37==e.getErrorCode()?Hrh(d,c,function(){Vvh(a,b,[c])},function(f){f=f.C;null!=f&&lh(f,2)&&37==f.getErrorCode()?(a.H.C(36986),f=xsh(b,f),Wvh(a,f.body,f.title)):Vvh(a,b,[c])}):Vvh(a,b,[c])}
function Lvh(a,b){if(0!==b.length){a.H.C(36985);var c=Xvh(a,b);0<c.length?Grh(a.D.L,c,function(){Vvh(a,null,b)},function(d){d=Yvh(a,d);0<d.length?(a.H.C(36986),d="You do not have access to the following BigQuery connection(s): \n\n"+(d.join(", ")+" \n\n Contact the owner(s) of the BigQuery connections(s) or your admin to request access. \n\n"),d=cf(d),Wvh(a,d,"Refresh failed")):Vvh(a,null,b)}):Vvh(a,null,b)}}
function Xvh(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d],f=IU(a.D.L,e).C;null!=f&&lh(f,2)&&37==f.getErrorCode()&&c.push(e)}return c}function Yvh(a,b){var c=[];b.forEach(function(d){var e=d.qf();lh(d,1)&&lh(e,2)&&37==e.getErrorCode()&&(d=N().LN()(d.Sl()),d=N().qT()(d),d=LF(a.D.C,d).Ud(),c.push(d))});Kd(c);return c}
function Vvh(a,b,c){y(A(),"fedd")&&Crh(a.D.L,c);var d=y(A(),"feds")?N().vya()(c):[],e=rd(c,function(f){return!yd(d,f)});zd(d)||Zvh(a,N().QNb()(d),b,d);zd(e)||Rvh(a,N().ONb()(e),b,c);$vh(a,c)}
function Zvh(a,b,c,d){a.H.C(116188);b=ih(osh,b);var e=(new Date).getTime();Brh(a.D.L,d);Lrh(vH.getInstance(),b,a.Aa).then(function(f){var h=uh(f,1,jrh);awh(a,h.Gb(),d,e,c);for(var k={},l=ha(h),n=l.next();!n.done;n=l.next())n=n.value,lh(n.qf(),2)||(k[n.Sl()]=n.Rf());oe(k)||(k=N().SNb()(k),k=ih(PQc,k),a.O.C(new RQc(k)));bwh(a,h.Gb());return f},function(f){f=f.UT(0).qf();S3b(a.D.L,new Set(d),f)})}
function Rvh(a,b,c,d){b=ih(msh,b);var e=(new Date).getTime();Brh(a.D.L,d);Mrh(vH.getInstance(),b,a.Aa).then(function(f){var h=uh(f,2,jrh).Gb();awh(a,h,d,e,c);bwh(a,h);return f},function(f){f=f.UT(0).qf();S3b(a.D.L,new Set(d),f)})}function awh(a,b,c,d,e){c=1==c.length?c[0]:null;!lh(b[0].qf(),2)&&c&&e&&(a.Sa.C[c]=new fvh(d,Cvh(e)))}function bwh(a,b){b=ha(b);for(var c=b.next();!c.done;c=b.next()){var d=c.value;c=d.qf();3===c.getState()&&(d=d.Sl(),S3b(a.D.L,new Set([d]),c))}}
function $vh(a,b){if(0!=b.length){var c=new Iv("{numObjects, plural, =1 {Refreshing object} other {Refreshing # objects}}");NG(c.format({numObjects:b.length}));b.forEach(function(d){return a.ea.add(d)})}}function Ivh(a,b){0!=a.ea.size&&(b.C.forEach(function(c){var d=IU(a.D.L,c);"loading"!=d.getType()&&"fetching-results"!=d.getType()&&a.ea.delete(c)}),0==a.ea.size&&"dbobjectmodel-event-update"==b.getType()&&NG("Refresh complete"))}
p.Dgc=function(a){if(a){var b=N().$ha()(a.Sl())?N().uF()(a.Sl()):0;a=xsh(b,a.C);Wvh(this,a.body,a.title)}};p.Mgc=function(){clb.setVisible(!0)};function Wvh(a,b,c){ZRb(b,ba(),c,Dvh,a.mkb,void 0,void 0,!1,"big-sheets-feedback")}p.hkc=function(){zr("https://connectedsheets.page.link/tutorial",{target:"_blank"})};p.mkb=function(){zr("https://connectedsheets.page.link/support")};p.F1b=function(){var a=bN(this.F);a&&JC(a)&&(w3b(this.D.ea),mSb(a.Gd()))};
function Kvh(a,b){var c=qJ(a.Wa),d=a.D.C.C,e=N().LN()(b),f=null;c?f=F6e(c)||H6e(c):d&&1==d.getSheetType()&&(f=d.F);y(A(),"fedcsdl")&&f&&"no-results"==IU(a.D.L,b).getType()&&(c=Zrh(Yrh(ash(),f),e).build(),Jrh(c).then(function(h){var k=a.H,l=k.C,n=f;var q=new XLd;var t=sh(h,1);q=K(q,1,t);t=sh(h,2);q=K(q,2,t);t=sh(h,3);q=K(q,3,t);t=sh(h,4);q=K(q,4,t);t=sh(h,5);q=K(q,5,t);t=h.getStatus();q=K(q,6,t);t=cwh(h.Fe());q=K(q,7,t);t=h.getNumberOfColumns();q=K(q,8,t);t=h.getNumberOfRows();q=K(q,9,t);n=K(q,10,
parseInt(n,10));q=th(h,10,0);n=K(n,11,q);q=sh(h,11);n=K(n,12,q);y(A(),"fesfcsdl")?(q=sh(h,12),n=K(n,13,q),q=sh(h,13),n=K(n,14,q),q=sh(h,14),n=K(n,15,q),q=sh(h,15),n=K(n,16,q),q=sh(h,16),n=K(n,17,q),q=th(h,17,0),n=K(n,18,q),q=th(h,18,0),n=K(n,19,q),h=sh(h,19),h=K(n,20,h)):h=n;n=new Yi;h=Pi(n,132,h);h=uq(tq(new sq,75),h).build();l.call(k,116028,h)},ba()));Jvh(a,2,b)}
function cwh(a){switch(a){case 0:return 0;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5;case 5:return 6;case 6:return 7;case 7:return 8;case 8:return 9;case 9:return 10;case 10:return 14;case 11:return 6;case 12:return 17;case 13:return 15;case 14:return 11;case 15:return 18;case 16:return 12;case 17:return 20;case 18:return 21;case 19:return 22;case 20:return 23;case 21:return 25;case 22:return 26;default:return 0}}function dwh(){B.call(this)}v(dwh,Tn);dwh.prototype.C=function(){return Evh};Fo("dbsource",dwh);
