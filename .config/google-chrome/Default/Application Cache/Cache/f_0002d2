function Eoh(a){C.call(this,a)}v(Eoh,C);Eoh.prototype.getStatus=function(){return this.message.getStatus()};function Foh(a){this.hb=eh(a,-1,0)}v(Foh,hh);Foh.prototype.toBuilder=function(){return new Eoh(this)};Foh.prototype.getStatus=function(){return th(this,1,0)};function Goh(a){C.call(this,a)}v(Goh,C);Goh.prototype.getStatus=function(){return this.message.getStatus()};function Hoh(a){this.hb=eh(a,-1,0)}v(Hoh,hh);Hoh.prototype.toBuilder=function(){return new Goh(this)};
Hoh.prototype.getStatus=function(){return th(this,1,0)};function Ioh(a,b){return new Sm(function(c,d){wH(a,"/dbx/createSchedule",[],b.qb(),function(e){c(ih(Foh,JSON.stringify(e.we())))},d)})}function Joh(a,b){return new Sm(function(c,d){wH(a,"/dbx/updateSchedule",[],b.qb(),function(e){c(ih(Hoh,JSON.stringify(e.we())))},d)})}function Koh(a){if(!N().$ha()(a)||N().lOb()(a))return!1;a=N().uF()(a);return X3b.has(a)}
function Loh(a){var b=[];a=ha(a.C.keys());for(var c=a.next();!c.done;c=a.next())c=c.value,Koh(c)&&b.push(c);return b}function Moh(a){if(a.L.Ye())return[];var b=[];a.C.forEach(function(c,d){K3b.has(c.D)&&Koh(d)&&b.push(d)});return b}function Noh(a){a.yb()&&u4e(a.F)}function Ooh(){var a=void 0===a?jh(J4e):a;return new I4e(a)}function Poh(){var a=void 0===a?jh(L4e):a;return new K4e(a)}function Qoh(a){C.call(this,a)}v(Qoh,C);function Roh(a,b){return Fh(a,1,b)}function Soh(a){this.hb=eh(a,-1,0)}
v(Soh,hh);Soh.prototype.toBuilder=function(){return new Qoh(this)};function Toh(){var a=void 0===a?jh(Soh):a;return new Qoh(a)}function Uoh(a){C.call(this,a)}v(Uoh,C);function Voh(a,b){return Ah(a,1,b)}function Woh(a,b){return Fh(a,2,b)}function Xoh(a){this.hb=eh(a,-1,0)}v(Xoh,hh);Xoh.prototype.toBuilder=function(){return new Uoh(this)};function Yoh(){var a=void 0===a?jh(Xoh):a;return new Uoh(a)}
function w3(a,b,c,d){S.call(this,d);this.Za=c;this.Wa=a;this.state=3;this.C=null;this.Ra=this.ma=!1;this.bb=new Du(this);this.oa(this.bb);this.Sa=new Hif(500,500,"dbxScheduleOnCompleteAuth");this.oa(this.Sa);Zoh(this)}v(w3,S);function Zoh(a){a.bb.Ab(khb,Ap,function(b){b=b.data;$oh(a,36713,b);aph(a,b,null)}).Ab(lhb,Ap,function(b){b=b.data;$oh(a,36714,b);bph(a,b,null)}).Ab(mhb,Ap,a.pb).Ab(nhb,Ap,a.jb).Ab(Xx,zp,a.refresh)}
function aph(a,b,c,d){d=void 0===d?!0:d;var e=Roh(Toh(),b);c&&Ah(e,2,c);Ioh(vH.getInstance(),e.build()).then(function(f){return cph(a,b,f.getStatus(),ph(f,2),!0,d)},function(){a.Jma()})}function bph(a,b,c,d){d=void 0===d?!0:d;var e=Woh(Voh(Yoh(),a.C.getId()),b);c&&Ah(e,3,c);Joh(vH.getInstance(),e.build()).then(function(f){return cph(a,b,f.getStatus(),ph(f,2),!1,d)},function(){a.Jma()})}
w3.prototype.pb=function(){if(Xx.isEnabled()){var a=HU(this.C);$oh(this,36715,a);a=a.toBuilder().Oa(!0).build();bph(this,a,null)}};w3.prototype.jb=function(){if(Xx.isEnabled()){var a=HU(this.C);$oh(this,36716,a);a=a.toBuilder().Oa(!1).build();bph(this,a,null)}};function $oh(a,b,c){var d=new PYd;c=dph(c.Li());d=K(d,10,c);d=C0e(d);d=xq(tq(new sq,75),d).build();a.Za.C(b,d)}function dph(a){switch(a.Li()){case 4:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 0:return 0}}
function eph(a){a.state=3;a.refresh();x5e().then(function(b){a.isDisposed()||(b=uh(b,1,b5e).Gb(),0==b.length?(a.state=1,a.C=null):(a.state=4,a.C=b[0]),a.Ra?(a.Ra=!1,a.show()):a.refresh())},function(){bv.getInstance().postMessage(dv("Error loading schedule configuration.","error",!0))})}function fph(a){return a.C&&nh(HU(a.C),1)?(rh(a.C.getStatus(),1),!0):!1}
function cph(a,b,c,d,e,f){a.UGa(!0);switch(c){case 1:a.focus();eph(a);LG.dispatchEvent("load-schedules-on-config-bar");break;case 2:if(!f)break;Iif(a.Sa,d,function(h){a.isDisposed()||(a.UGa(!1),e?aph(a,b,h,!1):bph(a,b,h,!1))});break;default:a.Jma()}}w3.prototype.show=function(){3==this.state?this.Ra=!0:(this.Za.C(116122),this.state=1==this.state?2:5,this.refresh())};function gph(a,b){wyf.call(this,a,b)}v(gph,wyf);gph.prototype.O=function(){this.refresh()};gph.prototype.refresh=function(){if(this.yb()){var a=Xx.isEnabled();a=this.J&&this.L&&a&&0<Moh(this.H).length;this.C.Oa(a)}};gph.prototype.R=m("Refresh all");function hph(a){a=a||{};var b=Mr(void 0,null)?18:void 0;b='<svg xmlns="http://www.w3.org/2000/svg" width="'+U(b)+'px" height="'+U(b)+'px" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-2 -2)"><polygon points="0 0 24 0 24 24 0 24"/><path fill="'+U(Mr(void 0,null)?"#188038":void 0)+'" fill-rule="nonzero" d="M22,4 L22,10 L16,10 L16,8 L18.91,8 C17.53,5.61 14.96,4 12,4 C7.58,4 4,7.58 4,12 C4,16.42 7.58,20 12,20 C16.42,20 20,16.42 20,12 L22,12 C22,17.52 17.52,22 11.99,22 C6.47,22 2,17.52 2,12 C2,6.48 6.47,2 11.99,2 C15.27,2 18.17,3.58 20,6.01 L20,4 L22,4 Z M13,12 L13,6 L11,6 L11,13 L15.97,16.49 L17.23,14.94 L13,12 Z"/></g></svg>';
b=T(b);a=""+nW(Kr({title:"Refresh options",Cs:"waffle-dataconnector-refresh-sidebar",Ez:Or(""+b),gq:Or('<div class="'+U("waffle-dataconnector-refresh-sidebar-container")+'"><div class="'+U("waffle-dataconnector-refresh-sidebar-refresh-widget")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-sidebar-backdrop")+'"></div>'),uN:!0,tF:Or('<div class="'+U("waffle-dataconnector-refresh-sidebar-footer-wrapper")+'"></div>')},a));return T(a)};function iph(){}v(iph,Zt);iph.prototype.kc=m("docs-calendar-select");iph.prototype.Qn=function(a){a=a.Ca("DIV",["docs-calendar-select-dropdown","docs-gm-arrow","goog-inline-block"],a.Ca("DIV",["docs-icon","goog-inline-block"],a.Ca("DIV",["docs-icon-img-container","docs-icon-img","docs-icon-arrow-dropdown"])));ks(a,"docs-material");return a};Ca(iph);function jph(){return T('<div><div class="'+U("waffle-dataconnector-refresh-date-input-date-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-date-input-date-picker")+'"></div>')};function kph(a,b,c){void 0===b&&oP.getInstance();S.call(this,c);this.D=new nL("",c);this.Ia(this.D);this.C=null;this.setDate(new Date)}v(kph,S);p=kph.prototype;p.Ca=function(){S.prototype.Ca.call(this);this.mb(Gr(jph))};p.Ja=function(){S.prototype.Ja.call(this);this.D.render(this.Da("waffle-dataconnector-refresh-date-input-date-select"));this.setDate(this.F);this.getHandler().listen(this.D,"action",this.Asb)};p.getDate=g("F");
p.Asb=function(){var a=this;null==this.C?lph(this,function(){return mph(a)}):mph(this)};function mph(a){a.C.position(a.La());a.C.Da("goog-date-picker").focus();null!=a.D.getValue()&&a.C.Uxc(a.getDate())}function lph(a,b){Do("datepicker",function(){var c=Go("datepicker");a.C=c.C(a.qa());a.Ia(a.C);a.C.render(a.Da("waffle-dataconnector-refresh-date-input-date-picker"));a.C.opb();a.getHandler().listen(a.C,"change",a.g2b);b()})}p.g2b=function(a){this.setDate(new Date(a.C.getTime()));this.C.hide();this.D.La().focus()};
p.setDate=function(a){this.F=new Date(a);this.F.setMinutes(0);this.F.setSeconds(0);this.F.setMilliseconds(0);var b=this.D,c=b.setValue;a=(new jx(lx.MONTH_DAY_YEAR_MEDIUM)).format(a);c.call(b,a);this.yb()&&(nk(this.D.La(),""+this.D.getValue()),gs(this.D.La(),"Start date:"+this.D.getValue()))};var nph=new Iv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function oph(a,b){a=void 0===a?uD.getInstance():a;for(var c=new Vt,d=1;28>=d;d++)c.Ia(new Qt(nph.format({DAY:d}),d),!0);fV.call(this,c,a,b)}v(oph,fV);function pph(){var a='<div class="'+U("waffle-dataconnector-refresh-day-of-month-widget")+'"><div><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-day-of-month-widget-label")+'"></div><div class="'+U("waffle-dataconnector-refresh-day-of-month-widget-add-day-select")+'" aria-label="';a+=Qr("Add day to repeat on");a+='"></div></div><div class="'+U("waffle-dataconnector-refresh-day-of-month-widget-chip-container")+'"></div></div>';return T(a)};var qph=new Iv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function rph(a){S.call(this,a);this.D=new S;this.Ia(this.D);this.C=new oph(Lt.getInstance(),a);su(this.C,"Add day");this.Ia(this.C);this.F=new sph}v(rph,S);p=rph.prototype;p.Ca=function(){S.prototype.Ca.call(this);this.mb(Gr(pph));this.D.Va(this.Da("waffle-dataconnector-refresh-day-of-month-widget-chip-container"));this.C.render(this.Da("waffle-dataconnector-refresh-day-of-month-widget-add-day-select"))};
p.Ja=function(){S.prototype.Ja.call(this);nk(this.Da("waffle-dataconnector-refresh-day-of-month-widget-label"),"Repeat on");this.getHandler().listen(this.C,"change",this.Nqc).listen(this,"Ee",this.Wsc)};p.Nqc=function(){var a=this.C.getValue();B_a(this.C.ck,null);tph(this,a);this.dispatchEvent("change")};p.Wsc=function(a){a=a.target;var b=yr(this.D,a);this.F.remove(b)&&(this.D.removeChild(a,this.yb()),this.dispatchEvent("change"))};
function tph(a,b){if(!a.F.has(b)){var c=new Fif(qph.format({DAY:b}),a.qa());b=a.F.add(b);a.D.Af(c,b,a.yb())}}p.Jd=function(){return this.F.C};function uph(a,b){for(var c=0;c<b.length;c++)tph(a,b[c])}function sph(){this.C=[]}sph.prototype.add=function(a){var b=Ld(this.C,a);Cd(this.C,a,-b-1);return-b-1};sph.prototype.has=function(a){return-1<od(this.C,a)};sph.prototype.remove=function(a){return Fd(this.C,a)};function vph(){}v(vph,Ssd);vph.prototype.Ca=function(a){return a.qa().Ca("INPUT",{type:"number",max:"100",min:"1"})};Ca(vph);function wph(){var a='<div class="'+U("waffle-dataconnector-refresh-schedules-new-widget")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-header")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-top-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-header-title")+'"><span tabindex="0" class="'+U("waffle-dataconnector-refresh-schedules-new-title")+'"></span></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-enable-switch")+'"></div></div><div class="'+
U("waffle-dataconnector-refresh-schedules-new-spinner")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-setup-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-overview-section")+'"><span class="'+U("waffle-dataconnector-refresh-schedules-new-overview-text")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-new-label-separator")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-new-edit-btn")+'"></span></div><div class="'+
U("waffle-dataconnector-refresh-schedules-new-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-new-fullview-text"></div><div><span class="'+U("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn")+'"></span> - ';a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(U("waffle-dataconnector-refresh-schedules-new-edit-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-schedules-new-repeat-every-label")+
'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+U("waffle-dataconnector-refresh-schedules-new-justify-content")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-interval-input")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-frequency-select")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+U("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget")+
'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-day-of-month-widget")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-weekday-select")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-schedules-new-repeat-at-label")+
'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+U("waffle-dataconnector-refresh-schedules-new-time-select-label")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-time-select")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-schedules-new-start-date-label")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+
" "+U("waffle-dataconnector-refresh-schedules-new-justify-content")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-start-date-select")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-start-time-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-owner-info")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-btns")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-cancel-btn")+'"></div><div class="'+
U("waffle-dataconnector-refresh-schedules-new-save-btn")+'"></div></div></div></div>');return T(a)};function xph(){for(var a='<div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-weekday-select-label")+'"></div><div style="display: flex">',b=0;7>b;b++)a+='<div data-index="'+U(b)+'" class="'+U("waffle-dataconnector-refresh-weekday-select")+'"></div>';return T(a+"</div>")};function yph(a){a=a.name;return T('<div class="'+U("waffle-dataconnector-refresh-weekday-toggle")+'">'+Jr(a)+"</div>")};function zph(a,b,c,d){Mt.call(this,void 0,Aph.getInstance(),d);this.F=a;this.D=c;this.C=b;this.Pf(16,!0)}v(zph,Mt);zph.prototype.Go=function(a){Mt.prototype.Go.call(this,a);this.isEnabled()&&this.dispatchEvent("change")};zph.prototype.getName=g("F");zph.prototype.getFullName=g("D");function Aph(){}v(Aph,Lt);Aph.prototype.Ca=function(a){var b=Gr(yph,{name:a.getName()});ls(b,this.Ao(a));return b};Aph.prototype.kc=m("waffle-dataconnector-refresh-weekday-toggle");Ca(Aph);function Bph(a){S.call(this,a);this.C=Cph(this,a)}v(Bph,S);Bph.prototype.Ca=function(){S.prototype.Ca.call(this);this.mb(Gr(xph))};Bph.prototype.Ja=function(){var a=this;S.prototype.Ja.call(this);nk(this.Da("waffle-dataconnector-refresh-weekday-select-label"),"Repeat on");this.C.forEach(function(b,c){b.render(a.tf("waffle-dataconnector-refresh-weekday-select")[c]);gs(b.La(),b.getFullName())})};Bph.prototype.Jd=function(){return this.C.filter(function(a){return a.isChecked()}).map(function(a){return a.C})};
function Cph(a,b){var c=(ex.FIRSTDAYOFWEEK+1)%7,d=ex.NARROWWEEKDAYS.map(function(e,f){return new zph(e,(f+6)%7+1,ex.WEEKDAYS[f],b)});d=d.slice(c).concat(d.slice(0,c));d.forEach(function(e){return a.Ia(e)});return d};var Dph=new Iv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function Eph(a,b,c,d){w3.call(this,a,b,c,d);this.R=new wjf(0,vph.getInstance(),d);this.R.setValue("1");this.Ia(this.R);a=new Vt;a.Ia(new Qt("hours",4),!0);a.Ia(new Qt("days",1),!0);a.Ia(new Qt("weeks",2),!0);a.Ia(new Qt("months",3),!0);this.D=new fV(a,iph.getInstance(),d);this.D.jf(0);this.D.wc("waffle-dataconnector-refresh-schedule-frequency");this.Ia(this.D);this.L=new rph(d);this.Ia(this.L);this.Ea=new Bph(d);this.Ia(this.Ea);this.F=new fV(Fph(),iph.getInstance(),d);this.F.jf((new Date).getHours());
this.F.wc("waffle-dataconnector-refresh-schedule-time");this.Ia(this.F);this.Aa=new kph(0,Ssd.getInstance(),d);this.ea=new fV(Fph(),iph.getInstance(),d);this.ea.jf((new Date).getHours());this.Ia(this.Aa);this.J=new nP("Cancel");this.Ia(this.J);this.xa=new Ow("Save",d);this.Ia(this.xa);this.Ha=new Mt("",dH.getInstance(),d);this.Ia(this.Ha);this.Qa=new Mt("Setup now",dH.getInstance(),d);this.Ia(this.Qa);this.Pa=new Mt("",dH.getInstance(),d);this.Ia(this.Pa);this.H=new GS(d);this.H.Yd("Enable schedule");
this.Ia(this.H);this.Ma=b;this.O=new Mjf(d);this.O.Ob("waffle-dataconnector-refresh-schedules-new-info-icon");this.O.setVisible(!1);this.ib=new HV(!0,"#0f9d58")}v(Eph,w3);p=Eph.prototype;
p.Ca=function(){w3.prototype.Ca.call(this);this.mb(Gr(wph));var a=this.Da("waffle-dataconnector-refresh-schedules-new-title");a.id=vr(this,"waffle-dataconnector-refresh-schedules-new-title");ds(this.La(),"labelledby",a.id);gs(a,"Scheduled refresh");nk(a,"Scheduled refresh");a=this.O.C;a.setContent(af("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.O.render(this.Da("waffle-dataconnector-refresh-schedules-new-header-title"));
a=a.zb();ds(ik(this.O.La())[0],"labelledby",a.id)};
p.Ja=function(){var a=this;w3.prototype.Ja.call(this);this.J.render(this.Da("waffle-dataconnector-refresh-schedules-new-cancel-btn"));this.Ha.render(this.Da("waffle-dataconnector-refresh-schedules-new-edit-btn"));this.H.render(this.Da("waffle-dataconnector-refresh-schedules-new-enable-switch"));this.R.render(this.Da("waffle-dataconnector-refresh-schedules-new-interval-input"));this.D.render(this.Da("waffle-dataconnector-refresh-schedules-new-frequency-select"));this.xa.render(this.Da("waffle-dataconnector-refresh-schedules-new-save-btn"));
this.Qa.render(this.Da("waffle-dataconnector-refresh-schedules-new-setup-btn"));this.Pa.render(this.Da("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn"));this.F.render(this.Da("waffle-dataconnector-refresh-schedules-new-time-select"));this.L.render(this.Da("waffle-dataconnector-refresh-schedules-new-day-of-month-widget"));this.Ea.render(this.Da("waffle-dataconnector-refresh-schedules-new-weekday-select"));this.ib.render(this.Da("waffle-dataconnector-refresh-schedules-new-spinner"));
this.Aa.render(this.Da("waffle-dataconnector-refresh-schedules-new-start-date-select"));this.ea.render(this.Da("waffle-dataconnector-refresh-schedules-new-start-time-select"));x3(this,!1);y3(this,!1);Gph(this,!0);cu(this.F,new as(null,13));cu(this.ea,new as(null,13));nk(this.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),"Repeat at");nk(this.Da("waffle-dataconnector-refresh-schedules-new-repeat-every-label"),"Repeat every");nk(this.Da("waffle-dataconnector-refresh-schedules-new-start-date-label"),
"Start date");var b=this.Da("waffle-dataconnector-refresh-schedules-new-repeat-every-label");b.id=vr(this,"waffle-dataconnector-refresh-schedules-new-repeat-every-label");ds(this.D.La(),"labelledby",b.id);ds(this.R.La(),"labelledby",b.id);b=this.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label");b.id=vr(this,"waffle-dataconnector-refresh-schedules-new-repeat-at-label");ds(this.F.La(),"labelledby",b.id);b=this.Da("waffle-dataconnector-refresh-schedules-new-start-date-label");b.id=vr(this,
"waffle-dataconnector-refresh-schedules-new-start-date-label");ds(this.Aa.La(),"labelledby",b.id);this.getHandler().listen(this.Ha,"action",this.show).listen(this.J,"action",this.Csb).listen(this.xa,"action",this.Fsb).listen(this.Qa,"action",this.show).listen(this.H,"action",this.Dsb).listen(this.D,"change",this.Esb).listen(this.L,"change",this.UH).listen(this.Ea,"change",this.UH).listen(this.L,"change",this.UH).listen(this.F,"change",this.UH).listen(this.ea,"change",this.UH).listen(this.R,"action",
this.UH).listen(this.Pa,"action",this.Gsb).listen(this.La(),"keydown",this.Bsb);[this.D,this.F,this.ea,this.J].forEach(function(c){a.getHandler().listen(c.La(),"focus",function(){var d=a.Aa;d.C&&d.C.isVisible()&&d.C.hide()})});0<Array.from(this.Wa.C.keys()).length?(Q(this.La(),!0),eph(this)):Q(this.La(),!1)};
p.refresh=function(){if(!this.isDisposed()){var a=this.Da("waffle-dataconnector-refresh-schedules-new-edit-section"),b=this.Da("waffle-dataconnector-refresh-schedules-new-overview-section"),c=this.Da("waffle-dataconnector-refresh-schedules-new-fullview-section"),d=this.Da("waffle-dataconnector-refresh-schedules-new-owner-info"),e=this.Da("waffle-dataconnector-refresh-schedules-new-setup-btn"),f=this.Da("waffle-dataconnector-refresh-schedules-new-enable-switch"),h=this.Da("waffle-dataconnector-refresh-schedules-new-spinner");
Q(e,!1);Q(f,!1);Q(a,!1);Q(b,!1);Q(c,!1);Q(d,!1);Q(h,!1);os(this.La(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!1);var k=!1;this.O.setVisible(!1);switch(this.state){case 1:Q(e,!0);break;case 2:Q(c,!0);Q(a,!0);Q(d,!0);os(this.La(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!0);k=!0;Hph(this);Iph(this);this.UH();this.J.Oa(!0);this.O.setVisible(!0);uph(this.L,[1]);break;case 3:Q(h,!0);break;case 5:Q(c,!0);Q(f,!0);Q(a,!0);Q(d,!0);os(this.La(),"waffle-dataconnector-refresh-schedules-new-widget-opened",
!0);k=!0;Jph(this);Hph(this);Iph(this);a=HU(this.C);this.H.Jb(!!nh(a,1));b=a.Li().Li();this.D.setValue(b);switch(b){case 4:y3(this,!1);x3(this,!1);break;case 1:y3(this,!1);x3(this,!1);this.F.setValue(sh(a.Li(),2));break;case 2:y3(this,!0);x3(this,!1);c=this.Ea;d=bS(a.Li(),4).Gb();e=ha(c.C);for(f=e.next();!f.done;f=e.next())f.value.Jb(!1);for(e=0;e<c.C.length;e++)f=c.C[e],0<=d.indexOf(f.C)&&f.Jb(!0);this.F.setValue(sh(a.Li(),2));break;case 3:y3(this,!1),x3(this,!0),uph(this.L,bS(a.Li(),5).Gb()),this.F.setValue(sh(a.Li(),
2))}c=lh(a.Li(),7)?new Date(rh(a.Li(),7)):new Date;this.Aa.setDate(c);4===b?this.ea.setValue(c.getHours()):this.F.setValue(sh(a.Li(),2));this.R.setValue(th(a.Li(),6,1).toString());this.UH();this.J.Oa(!0);this.O.setVisible(!0);break;case 4:Q(f,!0),Q(b,!0),Jph(this),b=this.Da("waffle-dataconnector-refresh-schedules-new-overview-text"),fph(this)?(a=this.C.getStatus(),nk(b,"Next: "),b=new Date(1E3*rh(a,2)),a=new Date(1E3*rh(a,3)),this.Ha.setContent(zk(this.qa(),Tjf(b,a,this.Ma,!0,!0))),Q(this.Da("waffle-dataconnector-refresh-schedules-new-label-separator"),
!1)):(nk(b,"Paused"),this.Ha.setContent("Edit"),Q(this.Da("waffle-dataconnector-refresh-schedules-new-label-separator"),!0))}this.ma!=k&&(this.ma=k,this.dispatchEvent(k?"Wk":"Vk"))}};function Jph(a){var b=!!nh(HU(a.C),1),c=Xx.isEnabled();a.H.Jb(b);a.H.Oa(c)}function Hph(a){var b=a.Da("waffle-dataconnector-refresh-schedules-new-owner-info"),c="Will run as you.";a.C&&(a=ph(a.C.sb(4,R4e),1))&&(c+=" Currently running as "+a);nk(b,c)}
function Iph(a){var b=a.Da("waffle-dataconnector-refresh-schedules-new-fullview-text");if(fph(a)){var c=a.C.getStatus(),d=new Date(1E3*rh(c,2));c=new Date(1E3*rh(c,3));var e=a.qa();e.od(b);e.appendChild(b,zk(e,ef(af("Next: "),Tjf(d,c,a.Ma,!1,!0))))}else nk(b,"");a.Pa.setContent(Sjf(a.Ma))}p.Csb=function(){Kph(this)};function Kph(a){a.state=2==a.state?1:4;a.refresh();a.Da("waffle-dataconnector-refresh-schedules-new-title").focus()}
p.Esb=function(){switch(this.D.getValue()){case 4:y3(this,!1);x3(this,!1);Gph(this,!0);break;case 1:y3(this,!1);x3(this,!1);Gph(this,!1);break;case 2:x3(this,!1);y3(this,!0);Gph(this,!1);break;case 3:y3(this,!1),x3(this,!0),Gph(this,!1)}this.UH()};function Gph(a,b){Q(a.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),!b);Q(a.Da("waffle-dataconnector-refresh-schedules-new-time-select"),!b);Q(a.Da("waffle-dataconnector-refresh-schedules-new-start-time-select"),b)}
p.Fsb=function(){this.xa.Oa(!1);this.J.Oa(!1);var a=this.D.getValue(),b=Ooh().HP(a);if(2===a)for(var c=ha(this.Ea.Jd()),d=c.next();!d.done;d=c.next())d=d.value,gh(b.hb,4,Koa).add(d);else if(3===a)for(c=ha(this.L.Jd()),d=c.next();!d.done;d=c.next())d=d.value,gh(b.hb,5,Koa).add(d);c=this.Aa.getDate();4===a&&c.setHours(this.ea.getValue());c=c.getTime();Bh(b,7,c);4!==a&&(a=this.F.getValue(),Ch(b,2,a));a=parseInt(this.R.getValue(),10);Ch(b,6,a);b=Ch(Poh().HP(b),3,1);2==this.state?(b.Oa(!0),khb.kb(b.build())):
(b.Oa(this.H.isChecked()),lhb.kb(b.build()))};p.Dsb=function(){var a=this;if(4==this.state){var b=this.H.isChecked();this.H.Jb(!b);this.H.Oa(!1);if(b){var c=Lph(this);c.render();c.setVisible(!0);c.getResult().then(function(){Xf(c);mhb.kb()},function(){Xf(c);Jph(a)})}else nhb.kb()}};p.Bsb=function(a){27==a.keyCode&&this.ma&&(Kph(this),a.stopPropagation())};p.Gsb=function(){AA.kb()};
p.UH=function(){var a=!!this.D.rf(),b=3!==this.D.getValue()||0<this.L.Jd().length,c=2!==this.D.getValue()||0<this.Ea.Jd().length,d=!!this.F.rf()||4===this.D.getValue(),e=!!this.ea.rf()||4!==this.D.getValue(),f=Xx.isEnabled(),h=parseFloat(this.R.getValue());h=Number.isInteger(h)&&0<h&&100>=h;this.xa.Oa(a&&b&&c&&d&&e&&f&&h)};p.focus=function(){this.Da("waffle-dataconnector-refresh-schedules-new-title").focus()};p.UGa=function(a){this.H.Oa(a)};
function x3(a,b){Q(a.Da("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget"),b)}function y3(a,b){Q(a.Da("waffle-dataconnector-refresh-schedules-new-weekday-select"),b)}
function Lph(a){var b=new sCf;b.Ob("waffle-dataconnector-refresh-schedules-new-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=HU(a.C);switch(c.Li().Li()){case 1:var d="Daily ";break;case 2:d=Mph();var e=bS(c.Li(),4).Gb();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(bS(c.Li(),5).Gb().map(function(l){return Dph.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=Qjf(a.Ma);var h=new Date(Ka()),k=new Date(1E3*rh(f,2));f=new Date(1E3*rh(f,3));d+=Rjf(k,f,c)+" ("+lab(nab(c,h))+")";a="Will run as "+ph(a.C.sb(4,R4e),1);a=ef(af("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),df("H4",void 0,"Schedule"),af(d),df("BR"),af(a));Js(b,a);return b}
p.Jma=function(){bv.getInstance().postMessage(dv("Error saving schedule.","error",!0));this.xa.Oa(!0);this.J.Oa(!0);this.H.Oa(!0)};function Mph(){var a=(ex.FIRSTDAYOFWEEK+1)%7,b=ex.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))}
function Fph(){for(var a=new Vt,b=new Date(Ka()),c=Array(24),d=0;24>d;d++){b.setHours(d,0,0,0);var e=new Date(b.getTime()),f=new Date(b.getTime());f.setHours(e.getHours()+1);f=Rjf(e,f);c[e.getHours()]={value:d,label:f}}for(b=0;24>b;b++)d=new Qt(c[b].label,c[b].value),a.Ia(d,!0);return a};function Nph(a,b,c){B.call(this);this.C=a;this.J=b;this.L=c;this.F=[];this.H=[];this.D=[]}v(Nph,B);Nph.prototype.Na=function(){Oph(this);B.prototype.Na.call(this)};function Pph(a,b,c){var d=qJ(a.C);b.forEach(function(e){var f=e.rect;f&&eD(f)&&(d&&KU(a.C)==e.gid?(e=dyc(d,f,Qph(c)),a.oa(e),e.setVisible(!0),a.F.push(e)):Rph(a,e.gid,c))})}
function Sph(a,b,c){var d=qJ(a.C);b.forEach(function(e){if(d){var f=BL(d.J,e);if(f&&f.yb()&&f instanceof GBf){a.D.push(f);ks(gY(f.D),Qph(c));return}}(e=a.L.J.yk(e))&&Rph(a,e.gb(),c)})}function Rph(a,b,c){b=M6e(a.J,b);ks(b.La(),Qph(c));a.H.push(b)}function Qph(a){return a?"waffle-dataconnector-refreshall-highlight-valid":"waffle-dataconnector-refreshall-highlight-error"}
function Oph(a){Yf(a.F);a.F=[];a.H.forEach(function(b){ns(b.La(),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.H=[];a.D.forEach(function(b){ns(gY(b.D),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.D=[]};function Tph(){return T('<div class="'+U("waffle-dataconnector-refresh-all-pane")+'"><div class="'+U("waffle-dataconnector-refresh-all-datasources-container")+'"></div></div>')}function Uph(){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-items-container")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-container")+'"></div>')}
function Vph(a,b){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title")+'"></div>'+Uph(null,b))}function Wph(){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper")+'"></div></div>')}
function Xph(a){a=a.title;a='<div class="'+U("waffle-dataconnector-refresh-all-dbobject-item")+'" tabindex="0"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-wrapper")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh")+'">'+FVb()+'</div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-title")+'" role="heading">'+Jr(a)+'</div><div class="'+
U("waffle-dataconnector-refresh-all-dbobject-item-status-wrapper")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-timestamp")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-error")+'">';a=a+'Error</div><div class="'+(U("waffle-dataconnector-refresh-all-dbobject-item-loading")+'">');a=a+'Loading\u2026</div><div class="'+(U("waffle-dataconnector-refresh-all-dbobject-item-running")+'">');return T(a+"Running\u2026</div></div></div>")};function Yph(a,b,c,d,e,f,h){S.call(this,h);this.C=a;this.ma=b;this.ea=c;this.R=d.L;this.L=e;this.D=new Nph(e,f,d);this.oa(this.D);this.O=new Bnc;this.H=new HV(!1,"#0f9d58");this.F=this.J=!0}v(Yph,S);p=Yph.prototype;p.Ca=function(){this.mb(Gr(Xph,{title:this.ma}));var a=this.Da("waffle-dataconnector-refresh-all-dbobject-item-title");a.id=vr(this,"waffle-dataconnector-refresh-all-dbobject-item-title");bs(a,"heading");ds(this.La(),"labelledby",a.id)};
p.Ja=function(){S.prototype.Ja.call(this);ks(this.La(),"waffle-dataconnector-refresh-all-dbobject-item-enabled");this.H.render(this.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"));this.getHandler().listen(this.La(),"click",this.TNa).listen(this.La(),"keydown",this.Isb).listen(this.La(),["mouseenter","focus"],this.Hsb).listen(this.La(),["mouseleave","blur"],this.q0b);Zph(this)};
function Zph(a){var b=IU(a.R,a.C),c=b.getType(),d=a.La();switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":case "offline":ys(d,"valid-highlight","error-highlight");a.F=!1;break;case "loading":case "no-results":case "fetch-successful":ys(d,"error-highlight","valid-highlight");a.F=!0;break;case "fetching-results":case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":$ph(a,
"waffle-dataconnector-refresh-all-dbobject-item-error");aqh(a);break;case "offline":aqh(a);break;case "loading":$ph(a,"waffle-dataconnector-refresh-all-dbobject-item-loading");bqh(a);break;case "fetching-results":$ph(a,"waffle-dataconnector-refresh-all-dbobject-item-running");bqh(a);break;case "no-results":cqh(a);aqh(a);break;case "fetch-successful":b=rh(b.C,8);b=a.O.format(b);nk(a.Da("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);gs(a.Da("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),
b);$ph(a,"waffle-dataconnector-refresh-all-dbobject-item-timestamp");aqh(a);break;case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}}p.Oa=function(a){this.J=a;var b=this.La();this.qa().Kh(b,a);a?ys(b,"waffle-dataconnector-refresh-all-dbobject-item-disabled","waffle-dataconnector-refresh-all-dbobject-item-enabled"):ys(b,"waffle-dataconnector-refresh-all-dbobject-item-enabled","waffle-dataconnector-refresh-all-dbobject-item-disabled")};
p.Hsb=function(){var a=this;switch(this.ea){case 1:case 3:case 5:var b=N().bXa()(this.C,KU(this.L)).map(function(c){return MD(fo(c))});Pph(this.D,b,this.F);break;case 2:b=N().aXa()(this.C);Sph(this.D,b,this.F);break;case 4:N().$Wa()(this.C).forEach(function(c){Rph(a.D,c,a.F)})}};p.q0b=function(){Oph(this.D)};function $ph(a,b){cqh(a);Q(a.Da(b),!0)}
function aqh(a){a.H.setActive(!1);Q(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!1);Q(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!0)}function bqh(a){a.H.setActive(!0);Q(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!1);Q(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!0)}p.Isb=function(a){13===a.keyCode&&this.TNa()};p.TNa=function(){if(this.J){var a=new WD("refresh-db-object-request");a.yVa=this.C;this.dispatchEvent(a)}};
function cqh(a){["waffle-dataconnector-refresh-all-dbobject-item-timestamp","waffle-dataconnector-refresh-all-dbobject-item-error","waffle-dataconnector-refresh-all-dbobject-item-loading","waffle-dataconnector-refresh-all-dbobject-item-running"].forEach(function(b){return Q(a.Da(b),!1)})};function dqh(a,b,c,d,e,f,h,k){S.call(this,k);this.O=a;this.H=new Set(b);this.xa=c;this.R=c.L;this.F=[];this.ea=f;this.ma=h;this.J=d;this.D=this.C=null;e&&(this.C=new eqh(this.qa()),this.D=new sW(this.J,this.qa(),!0));this.L=new Map([[1,0],[2,0],[3,0],[4,0],[5,0]])}v(dqh,S);p=dqh.prototype;p.Ca=function(){if(this.D){var a=Xj("DIV","waffle-dataconnector-refresh-all-dbobject-list-parent");this.mb(a);this.Ia(this.D,!0);this.D.setContent(Gr(Uph));ks(this.D.getElement(),"waffle-dataconnector-refresh-all-dbobject-list-collapsible")}else this.mb(Gr(Vph))};
p.Ja=function(){S.prototype.Ja.call(this);this.D||nk(this.Da("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),this.J);fqh(this);gqh(this);var a=this.getHandler();this.C&&(this.C.render(this.Da("waffle-dataconnector-refresh-all-dbobject-list-footer-container")),a.listen(this.C,"action",this.Edc))};function hqh(a){var b=a.getHandler();a.F.forEach(function(c){b.Jc(c,"refresh-db-object-request",a.P1a)})}
function gqh(a){var b=a.getHandler();a.F.forEach(function(c){b.listen(c,"refresh-db-object-request",a.P1a)})}function fqh(a){var b=a.Da("waffle-dataconnector-refresh-all-dbobject-list-items-container");a.H.forEach(function(c){var d=N().uF()(c);c=new Yph(c,iqh(a,d),d,a.xa,a.ea,a.ma,a.qa());a.F.push(c);c.render(b)})}
function iqh(a,b){switch(b){case 1:return"Pivot table "+jqh(a,1);case 2:return"Chart "+jqh(a,2);case 3:return"Function "+jqh(a,3);case 4:return"Preview";case 5:return"Extract "+jqh(a,5);default:throw Error("Unexpected DbObjectType");}}function jqh(a,b){var c=a.L.get(b);a.L.set(b,c+1);return 0==c?"":c.toString()}function kqh(a){a.L.forEach(function(b,c,d){return d.set(c,0)})}
p.Edc=function(){var a=this,b=Array.from(this.H).filter(function(c){return K3b.has(IU(a.R,c).D)});Sx.kb(new Oye(b,"all-objects-for-single-datasource",this.O))};p.P1a=function(a){a=a.yVa;K3b.has(IU(this.R,a).D)&&Sx.kb(new Oye([a],"specific-ids"))};function lqh(a){a.F.forEach(function(b){return Zph(b)})}function mqh(a,b){a.C&&(b=b.filter(function(c){return lh(c,3)&&a.H.has(c.Sl())}),nqh(a.C,b))}p.expand=function(){this.D.getHeader().Jb(!0)};p.Gd=g("O");
function oqh(a,b){a.J=b;a.D?a.D.getHeader().setContent(b):nk(a.Da("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),b)}p.Oa=function(a){this.C&&this.C.Oa(a);this.F.forEach(function(b){return b.Oa(a)})};function eqh(a){S.call(this,a);this.D=new nP("Refresh",this.qa());this.Ia(this.D);this.C=new vyf;this.Ia(this.C)}v(eqh,S);eqh.prototype.Ca=function(){this.mb(Gr(Wph))};
eqh.prototype.Ja=function(){S.prototype.Ja.call(this);this.D.render(this.Da("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper"));this.C.render(this.Da("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper"))};function nqh(a,b){var c=0;b.forEach(function(d){return c+=parseInt(d.Cp(),10)});z4e(a.C,c);a.D.Oa(!0)}eqh.prototype.Oa=function(a){this.D.Oa(a)};function pqh(a,b,c,d){S.call(this,d);this.F=a;this.J=a.L;this.D=new S;this.Ia(this.D);this.C=[];this.H=b;this.L=c}v(pqh,S);pqh.prototype.Ca=function(){this.mb(Gr(Tph))};pqh.prototype.Ja=function(){var a=this;S.prototype.Ja.call(this);this.D.Va(this.Da("waffle-dataconnector-refresh-all-datasources-container"));qqh(this);this.getHandler().listen(this.F.C,"ua",function(b){return rqh(a,b)})};
function qqh(a){var b=a.D.od(!0);Yf(b);a.C=[];b=sqh(a);if(1==b.size)b=b.entries().next().value,tqh(a,b[0],b[1],!1),ks(a.D.La(),"waffle-dataconnector-refresh-all-single-datasource-container");else{for(var c=ha(b.keys()),d=c.next();!d.done;d=c.next()){d=d.value;var e=b.get(d);tqh(a,d,e,!0)}ms(a.D.La(),"waffle-dataconnector-refresh-all-single-datasource-container")}1<a.C.length&&a.C[0].expand()}
function uqh(a){var b=sqh(a);1!=b.size&&1!=a.C.length||b.size==a.C.length?(a.C.forEach(function(c){var d=c.Gd();if(b.has(d)){var e=b.get(d);hqh(c);Yf(c.F);c.F=[];kqh(c);c.H=new Set(e);fqh(c);gqh(c)}else vqh(a,c);b.delete(d)}),b.forEach(function(c,d){return tqh(a,d,c,!0)})):qqh(a)}function vqh(a,b){a.C=a.C.filter(function(c){return b!=c});Xf(b)}function tqh(a,b,c,d){var e=N().qT()(b);e=LF(a.F.C,e).Ud();b=new dqh(b,c,a.F,e,d,a.H,a.L,a.qa());a.C.push(b);a.D.Ia(b,!0)}
function sqh(a){var b=new Map;Loh(a.J).forEach(function(c){var d=N().LN()(c);b.has(d)?b.get(d).push(c):b.set(d,[c])});return b}function wqh(a,b){a.C.forEach(function(c){return mqh(c,b)})}function xqh(a){a.C.forEach(function(b){b.C&&A4e(b.C.C)})}function yqh(a){a.C.forEach(function(b){b.C&&(b=b.C,u4e(b.C),b.D.Oa(!1))})}function zqh(a){a.C.forEach(function(b){return lqh(b)})}pqh.prototype.Oa=function(a){this.C.forEach(function(b){return b.Oa(a)})};
function rqh(a,b){3==LF(a.F.C,b.ih).getSheetType()&&(a=a.C.find(function(c){return c.J==b.C}))&&oqh(a,b.Dm)};function Aqh(a,b,c){b=void 0===b?tD.getInstance():b;yt.call(this,"",void 0,c);a&&Bqh(a);this.C=new Cqh(a,b,c);this.Ia(this.C)}v(Aqh,yt);p=Aqh.prototype;p.Ca=function(){this.C.Ca();this.mb(this.C.La())};p.jd=function(a){a.Vm(!0);this.C.jd(a)};p.Qs=function(a,b){a.Vm(!0);this.C.Qs(a,b)};p.Gg=function(a){return this.C.Gg(a)};p.qh=function(){return this.C.qh()};p.Jd=function(){return this.C.C.map(function(a){return a.getValue()})};
function Dqh(a,b){a=a.C;for(var c=ha(a.C),d=c.next();!d.done;d=c.next())d.value.Jb(!1);if(0==b.length)a.C=[];else{c=[];d=b.length;for(var e=0;e<a.qh();e++){var f=a.Gg(e),h=f.getValue();if(0<=b.indexOf(h)&&(f.Jb(!0),c.push(f),0==--d))break}a.C=c}a.dH()}p.Bb=function(){return this.C.Bb()};p.ue=function(a){Bqh(a);this.C.ue(a)};p.wc=function(a){this.C.wc(a)};function Bqh(a){for(var b=0;b<a.jc();b++)a.Bc(b).Vm(!0)}function Cqh(a,b,c){b=void 0===b?tD.getInstance():b;gV.call(this,a,b,c);this.C=[]}
v(Cqh,gV);Cqh.prototype.ue=function(a){gV.prototype.ue.call(this,a);this.C=[];this.dH()};Cqh.prototype.wq=function(a){a.stopPropagation();a=a.target;if(a.isChecked()){var b=this.Bb();Zea(this.C,a,function(c,d){return Md(yr(b,c),yr(b,d))})}else Ed(this.C,a);this.dH();this.dispatchEvent("change")};Cqh.prototype.J=function(){var a;0==this.C.length?a=this.H:a=this.C.map(function(b){return b.Pg()}).join(", ");return a||""};function Eqh(){var a='<div class="'+U("waffle-dataconnector-refresh-schedules-widget")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-header")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-top-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-header-title")+'"><span tabindex="0" class="'+U("waffle-dataconnector-refresh-schedules-title")+'" role="heading">';a=a+'Scheduled refresh</span></div><div class="'+(U("waffle-dataconnector-refresh-schedules-enable-switch")+
'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-spinner")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-setup-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-overview-section")+'"><span class="'+U("waffle-dataconnector-refresh-schedules-overview-text")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-edit-btn")+'"></span></div><div class="'+U("waffle-dataconnector-refresh-schedules-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-fullview-text"></div><div><span class="'+
U("waffle-dataconnector-refresh-schedules-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(U("waffle-dataconnector-refresh-schedules-edit-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-frequency-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+
" "+U("waffle-dataconnector-refresh-schedules-edit-section-row-date")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-date-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-time-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-owner-info")+'"></div><div class="'+
U("waffle-dataconnector-refresh-schedules-btns")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-cancel-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-save-btn")+'"></div></div></div></div>');return T(a)};var Fqh=new Iv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function Gqh(a,b,c,d){w3.call(this,a,b,c,d);this.Ma=y(A(),"fdsrfu")?1:4;a=new Vt;a.Ia(new Qt("Every day",1),!0);a.Ia(new Qt("Every week",2),!0);a.Ia(new Qt("Every month",3),!0);this.H=new gV(a,tD.getInstance(),d);su(this.H,"Add frequency");this.H.wc("waffle-dataconnector-refresh-schedule-frequency");this.H.setContent("Frequency");this.Ia(this.H);this.D=new Aqh(void 0,tD.getInstance(),d);su(this.D.C,"Add date");this.D.wc("waffle-dataconnector-refresh-schedule-date");this.D.C.setContent("On date");
this.Ia(this.D);var e=this.Ma;a=new Vt;var f=new Date(Ka());c=Array(24);for(var h=0;24>h;h++){f.setHours(h,0,0,0);var k=new Date(f.getTime()),l=new Date(f.getTime());l.setHours(k.getHours()+e);l=Rjf(k,l);c[k.getHours()]={value:h,label:l}}for(e=0;24>e;e++)f=new Qt(c[e].label,c[e].value),a.Ia(f,!0);this.J=new gV(a,tD.getInstance(),d);su(this.J,"Add time");this.J.wc("waffle-dataconnector-refresh-schedule-time");this.J.setContent("Between");this.Ia(this.J);this.O=new nP("Cancel");this.Ia(this.O);this.R=
new Ow("Save",d);this.R.Oa(!1);this.Ia(this.R);this.ea=new Mt("",dH.getInstance(),d);this.Ia(this.ea);this.Ea=new Mt("Setup now",dH.getInstance(),d);this.Ia(this.Ea);this.Aa=new Mt("",dH.getInstance(),d);this.Ia(this.Aa);this.F=new GS(d);this.F.Yd("Enable schedule");this.Ia(this.F);this.xa=b;this.L=new Mjf(d);this.L.Ob("waffle-dataconnector-refresh-schedules-info-icon");this.L.setVisible(!1);this.Ha=new HV(!0,"#0f9d58")}v(Gqh,w3);p=Gqh.prototype;
p.Ca=function(){w3.prototype.Ca.call(this);this.mb(Gr(Eqh));var a=this.Da("waffle-dataconnector-refresh-schedules-title");a.id=vr(this,"waffle-dataconnector-refresh-schedules-title");bs(a,"heading");ds(this.La(),"labelledby",a.id);a=this.L.C;a.setContent(af("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.L.render(this.Da("waffle-dataconnector-refresh-schedules-header-title"));a=a.zb();ds(this.L.La(),"labelledby",
a.id)};
p.Ja=function(){w3.prototype.Ja.call(this);this.O.render(this.Da("waffle-dataconnector-refresh-schedules-cancel-btn"));this.ea.render(this.Da("waffle-dataconnector-refresh-schedules-edit-btn"));this.F.render(this.Da("waffle-dataconnector-refresh-schedules-enable-switch"));this.H.render(this.Da("waffle-dataconnector-refresh-schedules-frequency-select"));this.R.render(this.Da("waffle-dataconnector-refresh-schedules-save-btn"));this.Ea.render(this.Da("waffle-dataconnector-refresh-schedules-setup-btn"));this.Aa.render(this.Da("waffle-dataconnector-refresh-schedules-timezone-setting-btn"));
this.J.render(this.Da("waffle-dataconnector-refresh-schedules-time-select"));this.D.render(this.Da("waffle-dataconnector-refresh-schedules-date-select"));this.Ha.render(this.Da("waffle-dataconnector-refresh-schedules-spinner"));Hqh(this,!1);cu(this.J,new as(null,13));this.getHandler().listen(this.ea,"action",this.show).listen(this.O,"action",this.Ksb).listen(this.R,"action",this.Nsb).listen(this.Ea,"action",this.show).listen(this.F,"action",this.Lsb).listen(this.H,"change",this.Msb).listen(this.D,
"change",this.E4).listen(this.J,"change",this.E4).listen(this.Aa,"action",this.Osb).listen(this.La(),"keydown",this.Jsb);0<Array.from(this.Wa.C.keys()).length?(Q(this.La(),!0),eph(this)):Q(this.La(),!1)};
p.refresh=function(){if(!this.isDisposed()){var a=this.Da("waffle-dataconnector-refresh-schedules-edit-section"),b=this.Da("waffle-dataconnector-refresh-schedules-overview-section"),c=this.Da("waffle-dataconnector-refresh-schedules-fullview-section"),d=this.Da("waffle-dataconnector-refresh-schedules-owner-info"),e=this.Da("waffle-dataconnector-refresh-schedules-setup-btn"),f=this.Da("waffle-dataconnector-refresh-schedules-enable-switch"),h=this.Da("waffle-dataconnector-refresh-schedules-spinner");
Q(e,!1);Q(f,!1);Q(a,!1);Q(b,!1);Q(c,!1);Q(d,!1);Q(h,!1);os(this.La(),"waffle-dataconnector-refresh-schedules-widget-opened",!1);var k=!1;this.L.setVisible(!1);switch(this.state){case 1:Q(e,!0);break;case 2:Q(c,!0);Q(a,!0);Q(d,!0);os(this.La(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);k=!0;Iqh(this);Jqh(this);this.E4();this.O.Oa(!0);this.L.setVisible(!0);break;case 3:Q(h,!0);break;case 5:Q(c,!0);Q(f,!0);Q(a,!0);Q(d,!0);os(this.La(),"waffle-dataconnector-refresh-schedules-widget-opened",
!0);k=!0;Kqh(this);Iqh(this);Jqh(this);a=HU(this.C);this.F.Jb(!!nh(a,1));b=a.Li().Li();this.H.setValue(b);switch(b){case 1:Hqh(this,!1);break;case 2:Dqh(this.D,bS(a.Li(),4).Gb());Hqh(this,!0);break;case 3:Dqh(this.D,bS(a.Li(),5).Gb()),Hqh(this,!0)}this.J.setValue(sh(a.Li(),2));this.E4();this.O.Oa(!0);this.L.setVisible(!0);break;case 4:Q(f,!0),Q(b,!0),Kqh(this),b=this.Da("waffle-dataconnector-refresh-schedules-overview-text"),fph(this)?(a=this.C.getStatus(),nk(b,"Next: "),b=new Date(1E3*rh(a,2)),a=
new Date(1E3*rh(a,3)),this.ea.setContent(zk(this.qa(),Tjf(b,a,this.xa,!0,!0)))):(nk(b,"Paused"),this.ea.setContent("Edit"))}this.ma!=k&&(this.ma=k,this.dispatchEvent(k?"Wk":"Vk"))}};function Kqh(a){var b=!!nh(HU(a.C),1),c=Xx.isEnabled();a.F.Jb(b);a.F.Oa(c)}function Iqh(a){var b=a.Da("waffle-dataconnector-refresh-schedules-owner-info"),c="Will run as you.";a.C&&(a=ph(a.C.sb(4,R4e),1))&&(c+=" Currently running as "+a);nk(b,c)}
function Jqh(a){var b=a.Da("waffle-dataconnector-refresh-schedules-fullview-text");if(fph(a)){var c=a.C.getStatus(),d=new Date(1E3*rh(c,2));c=new Date(1E3*rh(c,3));var e=a.qa();e.od(b);e.appendChild(b,zk(e,ef(af("Next: "),Tjf(d,c,a.xa,!1,!0))))}else nk(b,"");a.Aa.setContent(Sjf(a.xa))}p.Ksb=function(){Lqh(this)};function Lqh(a){a.state=2==a.state?1:4;a.refresh();a.Da("waffle-dataconnector-refresh-schedules-title").focus()}
p.Msb=function(){var a=this.H.getValue();Dqh(this.D,[]);switch(a){case 1:Hqh(this,!1);break;case 2:Hqh(this,!0);a=this.D;var b=a.ue,c=new Vt,d=Mqh();d=ha(d);for(var e=d.next();!e.done;e=d.next())e=e.value,c.Ia(new Qt(e.label,e.value),!0);a=b.call(a,c);Xf(a);break;case 3:Hqh(this,!0);a=this.D;b=a.ue;c=new Vt;for(d=1;28>=d;d++)c.Ia(new Qt(Fqh.format({DAY:d}),d),!0);a=b.call(a,c);Xf(a)}this.E4()};
p.Nsb=function(){this.R.Oa(!1);this.O.Oa(!1);var a=this.H.getValue(),b=Ooh().HP(a);if(2===a){a=ha(this.D.Jd());for(var c=a.next();!c.done;c=a.next())c=c.value,gh(b.hb,4,Koa).add(c)}else if(3===a)for(a=ha(this.D.Jd()),c=a.next();!c.done;c=a.next())c=c.value,gh(b.hb,5,Koa).add(c);a=this.J.getValue();Ch(b,2,a);b=Ch(Poh().HP(b),3,1);2==this.state?(b.Oa(!0),khb.kb(b.build())):(b.Oa(this.F.isChecked()),lhb.kb(b.build()))};
p.Lsb=function(){var a=this;if(4==this.state){var b=this.F.isChecked();this.F.Jb(!b);this.F.Oa(!1);if(b){var c=Nqh(this);c.render();c.setVisible(!0);c.getResult().then(function(){Xf(c);mhb.kb()},function(){Xf(c);Kqh(a)})}else nhb.kb()}};p.Jsb=function(a){27==a.keyCode&&this.ma&&(Lqh(this),a.stopPropagation())};p.Osb=function(){AA.kb()};p.E4=function(){var a=!!this.H.rf(),b=1===this.H.getValue()||0<this.D.Jd().length,c=!!this.J.rf(),d=Xx.isEnabled();this.R.Oa(a&&b&&c&&d)};p.focus=function(){this.Da("waffle-dataconnector-refresh-schedules-title").focus()};
p.UGa=function(a){this.F.Oa(a)};function Hqh(a,b){Q(a.Da("waffle-dataconnector-refresh-schedules-edit-section-row-date"),b)}
function Nqh(a){var b=new sCf;b.Ob("waffle-dataconnector-refresh-schedules-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=HU(a.C);switch(c.Li().Li()){case 1:var d="Daily ";break;case 2:d=Mqh();var e=bS(c.Li(),4).Gb();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(bS(c.Li(),5).Gb().map(function(l){return Fqh.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=Qjf(a.xa);var h=new Date(Ka()),k=new Date(1E3*rh(f,2));f=new Date(1E3*rh(f,3));d+=Rjf(k,f,c)+" ("+lab(nab(c,h))+")";a="Will run as "+ph(a.C.sb(4,R4e),1);a=ef(af("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),df("H4",void 0,"Schedule"),af(d),df("BR"),af(a));Js(b,a);return b}
p.Jma=function(){bv.getInstance().postMessage(dv("Error saving schedule.","error",!0));this.R.Oa(!0);this.O.Oa(!0);this.F.Oa(!0)};function Mqh(){var a=(ex.FIRSTDAYOFWEEK+1)%7,b=ex.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))};function Oqh(a,b,c,d,e,f){RV.call(this,f);this.F=b.L;this.L=a;this.R=d;this.qP=new pqh(b,c,this.R,this.qa());this.Ia(this.qP);this.D=new gph(this.F,f);this.oa(this.D);this.C=null;this.ea=y(A(),"fdsrfu");this.J=null;this.O=e}v(Oqh,RV);p=Oqh.prototype;p.Ca=function(){RV.prototype.Ca.call(this);this.mb(Gr(hph,{id:this.getId()}));this.D.render(this.Da("waffle-dataconnector-refresh-sidebar-footer-wrapper"))};
p.Ja=function(){var a=this;RV.prototype.Ja.call(this);Pqh(this);this.getHandler().listen(this,["Vk","Wk"],this.Oec);this.qP.render(this.Da("waffle-dataconnector-refresh-sidebar-refresh-widget"));Qqh(this,!0);this.getHandler().listen(this.D,"refresh-db-object-request",function(){var b=Moh(a.F);Sx.kb(new Oye(b,"all-objects-for-all-datasources"))});this.D.refresh();Q(this.Da("waffle-dataconnector-refresh-sidebar-backdrop"),!1)};function Rqh(a){null!=a.C&&(Xf(a.C),Xf(a.J),Pqh(a))}
p.Ioa=function(){null!=this.C&&this.C.show()};function Sqh(a,b){wqh(a.qP,b);var c=0;b.forEach(function(d){return c+=parseInt(d.Cp(),10)});a.D.Zl(c)}function Qqh(a,b){a.qP.Oa(b);b?a.D.refresh():a.D.C.Oa(b)}
p.Oec=function(a){var b=this;a="Wk"===a.type;Q(this.Da("waffle-dataconnector-refresh-sidebar-backdrop"),a);Qqh(this,!a);Sq(this.zb(),"overflow-y",a?"hidden":"auto");Xf(this.J);a?(Tqh(this),setTimeout(function(){if(b.C.yb()){var c=b.C.La();b.J=new Bw(c,b.qa());b.oa(b.J);Cw(b.J);c.focus()}},500)):this.resize()};function Pqh(a){a.C=a.ea?new Eph(a.F,a.L,a.O,a.qa()):new Gqh(a.F,a.L,a.O,a.qa());a.Ia(a.C);a.C.render(a.La());Q(a.Da("waffle-dataconnector-refresh-sidebar-backdrop"),!1)}
p.resize=function(){if(this.C)if(this.C.ma)Tqh(this);else{var a=fr(this.zb()).height-fr(this.C.La()).height,b=this.Da("waffle-dataconnector-refresh-sidebar-refresh-widget");er(b,a)}};function Tqh(a){var b=fr(a.La()).height-fr(a.Da("waffle-sidebar-title")).height-10;Sq(a.C.La(),"max-height",b+"px")};function Uqh(a,b,c){OU.call(this,a,b);var d=this;this.C=c;this.F=new Nm;this.oa(this.F);this.F.wb(this.C.H,function(e){if("dbobjectmodel-event-add"==e.getType()||"dbobjectmodel-event-remove"==e.getType())e=d.fc,uqh(e.qP),0<Moh(e.F).length||e.dispatchEvent("close-sidebar");Vqh(d);zqh(d.fc.qP)});this.D.listen(LG,"show-db-objects-refresh-sidebar",this.H)}v(Uqh,OU);Uqh.prototype.Bf=function(){return Vgb};Uqh.prototype.wm=function(){return Wgb};
function Vqh(a){var b=Moh(a.C),c=a.fc;0==b.length?Noh(c.D):(xqh(c.qP),xyf(c.D),qse(a.C,b,function(d){a.isDisposed()||c.isDisposed()||Sqh(c,d)},function(d){a.isDisposed()||c.isDisposed()||(d=new VH(d[0].Sl(),d[0].qf()),yqh(c.qP),c.D.Gz(d))}))}Uqh.prototype.H=function(a){var b=this;Rqh(this.fc);Vqh(this);PU(this);a.Ioa&&this.fc.Ioa();Ck(function(){b.fc.La().focus()})};function Wqh(){Tn.apply(this,arguments)}v(Wqh,Tn);Wqh.prototype.C=function(){return Uqh};Wqh.prototype.D=function(){return Oqh};Fo("dbrefresh",Wqh);
