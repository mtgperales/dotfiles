uve.prototype.yR=X(1677,function(a){this.C.C.tP(a)});Cve.prototype.yR=X(1676,function(a){this.D.yR(a)});R9d.prototype.y7=X(1334,function(){return vi(this,3)});Mde.prototype.y7=X(1333,function(){return vi(this,3)});cta.prototype.qr=X(1326,function(){return vi(this,2)});K2d.prototype.qr=X(1325,function(){return vi(this,1)});ypa.prototype.Zq=X(11,function(){return ph(this,12)});Apa.prototype.Zq=X(10,function(){return this.message.Zq()});yze.prototype.Zq=X(9,function(){return J(this,2)});
Eze.prototype.Zq=X(8,function(){return J(this,2)});function m0i(a){$M(a,function(b){b=new (b.H())(a.H,a.eb);YM(a,b);b.setVisible(!0)},"ritzmaestro")}function n0i(a,b){$M(a,function(c){c=c.C(b,this.H,this.jb,this.Ha);YM(this,c);c.setVisible(!0)},"ritzmaestro")}function o0i(a,b){$M(a,function(c){c=c.D(b,this.H,this.jb);YM(this,c);c.setVisible(!0)},"ritzmaestro")}function p0i(a,b){a.D=b}function q0i(a,b){var c=Md;Nd(a,function(d,e){return c(b(d),b(e))})}function r0i(a){C.call(this,a)}v(r0i,C);
r0i.prototype.Gd=function(){return this.message.Gd()};function s0i(a){var b=t0i();u0i(b);return Ah(b,3,a)}function u0i(a){a.oi(1,2,3,4,5,6)}function v0i(a){this.hb=eh(a,-1,0)}v(v0i,hh);v0i.prototype.toBuilder=function(){return new r0i(this)};v0i.prototype.Gd=function(){return ph(this,1)};function t0i(){var a=void 0===a?jh(v0i):a;return new r0i(a)}function w0i(a){C.call(this,a)}v(w0i,C);w0i.prototype.getFunctionName=function(){return this.message.getFunctionName()};
function x0i(a){this.hb=eh(a,-1,0)}v(x0i,hh);x0i.prototype.toBuilder=function(){return new w0i(this)};x0i.prototype.getFunctionName=function(){return ph(this,2)};function y0i(){var a=void 0===a?jh(x0i):a;return new w0i(a)}function z0i(a){C.call(this,a)}v(z0i,C);function A0i(a,b){return Eh(a,1,b)}function B0i(a){this.hb=eh(a,-1,0)}v(B0i,hh);B0i.prototype.toBuilder=function(){return new z0i(this)};function C0i(){var a=void 0===a?jh(B0i):a;return new z0i(a)}
function D0i(a,b){var c=this;this.J=a;this.F=new Vf;this.C=new Map;this.D=new Map;this.H=new Pm(this);this.H.listen(b,"external_data_change",function(){E0i(c);c.F.dispatchEvent(null)});E0i(this)}
function F0i(a,b,c){for(var d=ha(uh(b,1,x0i).Gb()),e=d.next();!e.done;e=d.next()){var f=e.value;lh(f,2);e=f.getFunctionName();var h=a.C.get(e);if(h)if(nh(f,5))a.C.delete(e),a.D.set(e,h);else{h=h.toBuilder();lh(f,3);var k=ph(f,3);Ah(h,8,k);lh(f,4)?(f=ph(f,4),Ah(h,9,f)):wh(h,9);a.C.set(e,h.build())}else h=a.D.get(e).toBuilder(),lh(f,3),f=ph(f,3),Ah(h,8,f),a.C.set(e,h.build()),a.D.delete(e)}a.F.dispatchEvent(null);Jl(ep(Vo(a.J.Oe("/editactions"),{data:JSON.parse(b.qb())}),"POST"),c).Qe()}
function E0i(a){var b=N().WT()().map(zpa),c=new Map,d=new Map;b=ha(b);for(var e=b.next();!e.done;e=b.next())e=e.value,lh(e,8)?c.set(e.getFunctionName(),e):nh(e,11)||d.set(e.getFunctionName(),e);a.C=c;a.D=d}function G0i(){return T('<div class="waffle-edit-actions-dialog-scroll"><div class="waffle-edit-actions-dialog-actions-row-container"></div><div class="waffle-edit-actions-empty" role="alert">There are no macros</div></div>')}
function H0i(a){return T('<div class="waffle-edit-actions-row"><div class="waffle-edit-actions-row-name"><input class="waffle-edit-actions-name-input jfk-textinput" maxlength="50"/><div class="waffle-edit-actions-shortcut-conflict-message"></div></div><div class="waffle-edit-actions-options"><div class="waffle-edit-actions-row-shortcut-prefix">'+Jr(a.mHa)+'</div><div class="waffle-edit-actions-row-shortcut"><input class="waffle-edit-actions-row-shortcut-input jfk-textinput" maxlength="1"/></div><div class="waffle-edit-actions-row-menu"></div></div></div>')}
;function I0i(a,b,c,d,e){jw.call(this,void 0,!1,e);var f=this;this.R=a;this.O=Array.from(this.R.C.values());q0i(this.O,function(h){return h.getFunctionName()});this.F=b;this.ea=c;this.C=new Map;this.L=null;this.ma=d;this.H=new Ybc("Macro removed","UNDO",function(){return J0i(f)},void 0,this.qa(),"off");this.oa(this.H);yw(this.ea,this.H);Rs(this,(new Os).mf(Vs,!1,!0).set("save","Update",!0))}v(I0i,jw);
I0i.prototype.Ca=function(){jw.prototype.Ca.call(this);this.mq=!1;Qs(this,!1);K0i(this,!1);ks(Ms(this),"waffle-edit-actions-dialog-gm");ct(this,"save");this.setTitle("Manage macros");this.zb().appendChild(Gr(G0i));for(var a=this.Da("waffle-edit-actions-dialog-actions-row-container"),b=ha(this.O),c=b.next();!c.done;c=b.next()){c=c.value;var d=new L0i(c,this.F,this.ma);this.Ia(d);this.C.set(c.getFunctionName(),d);d.render(a)}Q(this.Da("waffle-edit-actions-empty"),!1);this.H.render();ks(this.H.La(),
"waffle-edit-actions-undo-remove-toast")};function K0i(a,b){Ss(a.D,"save").disabled=!b}I0i.prototype.Ja=function(){var a=this;jw.prototype.Ja.call(this);M0i(this);this.getHandler().listen(this,"dialogselect",this.xa).listen(this.La(),"keydown",function(b){13==b.keyCode&&"INPUT"==b.target.tagName&&(b.target.setSelectionRange(0,0),b.target.blur(),b.preventDefault());90==b.keyCode&&b.ctrlKey&&J0i(a)});N0i(this)};
function M0i(a){for(var b={},c=ha(a.C.values()),d=c.next();!d.done;b={uQ:b.uQ},d=c.next())b.uQ=d.value,a.getHandler().listen(b.uQ.ea,"action",function(e){return function(){return O0i(a,e.uQ)}}(b)).listen(P0i(b.uQ),"input",function(e){return function(){var f=e.uQ;Q0i(f)?CW(f.qM):BW(f.qM,"Must be a number from 0 to 9 or blank.",!0);f=!N0i(a)&&Q0i(f);K0i(a,f)}}(b)).listen(R0i(b.uQ),"input",function(){a.F.C(29573);K0i(a,!0)})}
function N0i(a){var b=new Map;a=ha(a.C.values());for(var c=a.next();!c.done;c=a.next())c=c.value,b.has(S0i(c))?b.get(S0i(c)).push(c):b.set(S0i(c),[c]);a=!1;c=null;b=ha(b);for(var d=b.next();!d.done;d=b.next()){var e=ha(d.value);d=e.next().value;e=e.next().value;1<e.length&&""!=d?(a=!0,c=d,e.forEach(function(h){h=h.Da("waffle-edit-actions-shortcut-conflict-message");nk(h,"Conflicts with another shortcut");Q(h,!0)})):e.forEach(function(h){h=h.Da("waffle-edit-actions-shortcut-conflict-message");Q(h,
!1)})}if(a){var f="Can't save conflicting shortcut "+c;setTimeout(function(){return NG(f)})}return a}function O0i(a,b){K0i(a,!0);a.L=b;a.C.delete(b.Aa);Q(b.La(),!1);N0i(a);a.H.setVisible(!0);0==a.C.size&&Q(a.Da("waffle-edit-actions-empty"),!0);a.La().focus();var c="Macro "+(b.C.getValue()+" was removed, Ctrl-Z to Undo");setTimeout(function(){return NG(c)});a.F.C(29572)}
function J0i(a){if(null!=a.L){var b=a.L;a.C.set(b.Aa,b);Q(b.La(),!0);Q(a.Da("waffle-edit-actions-empty"),!1);N0i(a);a.L=null;var c="Macro "+(b.C.getValue()+" is restored.");setTimeout(function(){return NG(c)});a.F.C(29577)}}
I0i.prototype.xa=function(a){var b=this;if("cancel"==a.key)this.F.C(29569);else if("save"==a.key){for(var c=ha(this.C.values()),d=c.next();!d.done;d=c.next())if(d=d.value,!Q0i(d)||""!=T0i(d)){a.preventDefault();return}N0i(this)?a.preventDefault():(a=U0i(this),F0i(this.R,a,function(){var e=xw(b.ea,"Failed to update macros.",Lj(),!0,0,!0,void 0,!0,["waffle-edit-actions-update-failed"]);vw(e);e.render();e.setVisible(!0)}),this.F.C(29574),setTimeout(function(){return NG("Macros updated")}))}};
function U0i(a){for(var b=C0i(),c=ha(a.O),d=c.next();!d.done;d=c.next()){var e=d.value;d=y0i();var f=!1,h=a.C.get(e.getFunctionName()),k=ph(e,9),l=ph(e,8);h?(k!=S0i(h)&&(k=S0i(h),f=!0),l!=h.C.getValue()&&(l=h.C.getValue(),f=!0)):(xh(d,5,!0),f=!0);f&&(f=ph(e,1),Ah(d,1,f),e=e.getFunctionName(),Ah(d,2,e),Ah(d,3,l),k&&Ah(d,4,k),d=d.build(),Dh(b,1,d))}return b.build()}
function L0i(a,b,c,d){S.call(this,d);this.xa=a;this.Ma=ph(a,8);this.Aa=a.getFunctionName();this.J=(a=ph(a,9))?a.split("+"):[];this.D=new Pv;this.Ia(this.D);this.L=this.O=null;this.C=new Pv;this.Ia(this.C);this.ma=new nw;this.oa(this.ma);this.Ea=b;this.Ha=c;b=st(Lt,"waffle-overflow-menu-material");this.H=new bu(void 0,void 0,b,this.qa());this.oa(this.H);this.R=new Qt("Edit script");this.oa(this.R);this.ea=new Qt("Remove");this.oa(this.ea);this.qM=new AW(this.qa());this.oa(this.qM);this.F=new AW(this.qa());
this.oa(this.F)}v(L0i,S);L0i.prototype.Ca=function(){var a=(zd(this.J)?V0i:this.J.slice(0,this.J.length-1)).join(" + ")+" + ";a=Gr(H0i,{mHa:Sp?a.replace(/Ctrl/g,"\u2318").replace(/Alt/g,"Option"):a});this.mb(a)};
L0i.prototype.Ja=function(){var a=this;this.D.Va(this.Da("waffle-edit-actions-row-shortcut-input"));this.D.setValue(nd(this.J)||"");var b=this.Da("waffle-edit-actions-name-input");this.C.Va(b);this.C.setValue(this.Ma);this.ma.Va(b);this.qM.setPosition(3,2);this.qM.render();b=this.D.La();this.qM.wi(b);DW(this.qM,b);CW(this.qM);this.F.setPosition(0,2);this.F.render();b=this.C.La();this.F.wi(b);DW(this.F,b);CW(this.F);b=new as(this.H.zb(),13);cu(this.H,b);this.H.vz=!0;this.H.jd(this.R);this.H.jd(this.ea);
b=this.Da("waffle-edit-actions-row-menu");this.H.Va(b);"black"==ju()&&ks(b,"waffle-overflow-menu-material-white");this.getHandler().listen(this.R,"action",function(){a.Ha.Fa("macros-editor").kb({scriptId:ph(a.xa,1),filename:ph(a.xa,10)});a.Ea.C(29570)}).listen(this.C.La(),"blur",function(){""==T0i(a)?CW(a.F):BW(a.F,T0i(a),!0)}).listen(this.D.La(),"click",function(){return a.D.La().select()}).listen(P0i(this),"input",function(){return a.Ea.C(29571)});gs(this.Da("waffle-edit-actions-name-input"),"Macro name");
gs(this.D.La(),"Numeric shortcut key");gs(b,"More options button")};function S0i(a){var b=a.D.getValue();return""==b?"":(zd(a.J)?V0i:a.J.slice(0,a.J.length-1)).join("+")+"+"+b}function P0i(a){null==a.O&&(a.O=new mw(a.D.La()),a.oa(a.O));return a.O}function R0i(a){null==a.L&&(a.L=new mw(a.C.La()),a.oa(a.L));return a.L}function Q0i(a){a=a.D.getValue();return""==a||/^\d$/.test(a)}
function T0i(a){a=a.C.getValue();return""==a?"Macro name must be not be empty.":/\r|\n/.test(a)?"Macro name must not contain line-break characters.":""}var V0i=["Ctrl","Alt","Shift"];function W0i(){return T('<div class="waffle-import-custom-function-actions-title-separator"></div><div class="waffle-import-custom-function-actions-dialog-scroll"><div class="waffle-import-custom-functions-row-container"></div></div>')}
function X0i(a){var b=a.cvc,c=a.fileName;a='<div class="waffle-import-custom-function-row" tabindex="0"><div class="waffle-import-custom-function-name">'+Jr(a.functionName)+'</div><div class="waffle-import-custom-function-metadata"><div class="waffle-import-custom-function-project-name"><span class="waffle-import-custom-function-description-label">';a=a+'Project:</span><span class="function-description-seperator"></span>'+(Jr(b)+'</div><div class="waffle-import-custom-function-file-name"><span class="waffle-import-custom-function-description-label">');
a=a+'File:</span><span class="function-description-seperator"></span>'+(Jr(c)+'</div></div><div class="waffle-import-custom-function-view-script"></div><div class="waffle-import-custom-function-add-function"></div></div>');return T(a)};function Y0i(a,b,c,d){jw.call(this,void 0,!1,d);this.O=a;this.ea=Array.from(this.O.D.values());q0i(this.ea,function(e){return e.getFunctionName()});this.L=b;this.R=c;this.H=[];this.F=[];this.C=xw(this.R,"Function added.",Lj(),!1,3E3,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);this.oa(this.C);this.Ha=new pw(this.qa());this.oa(this.Ha);this.ma=new Pn(this.xa,3E3,this);this.oa(this.ma)}v(Y0i,jw);
Y0i.prototype.Ca=function(){jw.prototype.Ca.call(this);ks(Ms(this),"waffle-import-custom-function-actions-dialog");this.setTitle("Import");var a=this.qa().Ca("DIV","waffle-import-custom-function-title-description",px()?"Added functions will appear in the menu under Extensions > Macros":"Added functions will appear in the menu under Tools > Macros");Ks(this).appendChild(a);this.zb().appendChild(Gr(W0i));a=this.Da("waffle-import-custom-functions-row-container");for(var b=ha(this.ea),c=b.next();!c.done;c=
b.next())c=new Z0i(c.value,this.L),this.Ia(c),c.render(a),this.H.push(c);this.C.render();this.C.setVisible(!1);Rs(this,null)};Y0i.prototype.Ja=function(){var a=this;jw.prototype.Ja.call(this);for(var b={},c=ha(this.H),d=c.next();!d.done;b={qca:b.qca},d=c.next())b.qca=d.value,this.getHandler().listen(b.qca.D,"action",function(e){return function(){return $0i(a,e.qca)}}(b));this.getHandler().listen(this,"hide",function(){return a.xa()})};
function $0i(a,b){a1i(b);var c=b1i(b.C);c1i(a,c);b=b.Da("waffle-import-custom-function-add-function");b.setAttribute("tabindex","0");gs(b,"This function has been added.");b.focus();a.L.C(29576);setTimeout(function(){return a.C.setVisible(!0)})}function b1i(a){var b=y0i();var c=ph(a,1);b=Ah(b,1,c);c=a.getFunctionName();b=Ah(b,2,c);a=a.getFunctionName();return Ah(b,3,a).build()}function c1i(a,b){a.F.push(b);a.ma.start()}
Y0i.prototype.xa=function(){var a=this;if(0<this.F.length){var b=A0i(C0i(),this.F).build();F0i(this.O,b,function(){var c=xw(a.R,"Failed to add function.",Lj(),!1,1E4,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);vw(c);c.render();c.setVisible(!0)});this.F=[]}};function Z0i(a,b,c){S.call(this,c);this.C=a;this.H=b;a=rw.getInstance();this.D=new Mt("Add Function",a,c);this.Ia(this.D);this.F=new Mt("Edit Script",a,c);this.Ia(this.F)}v(Z0i,S);
Z0i.prototype.Ca=function(){S.prototype.Ca.call(this);var a=Gr(X0i,{functionName:this.C.getFunctionName(),cvc:ph(this.C,2),fileName:ph(this.C,10)});this.mb(a);this.D.render(this.Da("waffle-import-custom-function-add-function"));this.F.render(this.Da("waffle-import-custom-function-view-script"))};
Z0i.prototype.Ja=function(){var a=this;S.prototype.Ja.call(this);this.getHandler().listen(this.F,"action",function(){O("macros-editor").kb({scriptId:ph(a.C,1),filename:ph(a.C,10)});a.H.C(29575)});var b="Function: "+(this.C.getFunctionName()+(", from project: "+(ph(this.C,2)+(", defined in file: "+ph(this.C,10)))));gs(this.La(),b)};function a1i(a){Q(a.D.La(),!1);ks(a.Da("waffle-import-custom-function-add-function"),"waffle-import-custom-function-actions-checkmark")};function d1i(a,b,c,d,e,f){B.call(this);this.C=a;this.functionName=b;this.F=d||null;this.D=void 0!==f?f:null}v(d1i,B);function e1i(a){I(this,a,0,-1,f1i,null)}x(e1i,H);var f1i=[6];p=e1i.prototype;p.V=function(){var a=new D;g1i(this,a);return Y(a)};function g1i(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&b.Ba(3,c);c=J(a,4);null!=c&&b.Ba(4,c);c=J(a,5);null!=c&&b.Ba(5,c);c=a.uh();0<c.length&&ki(b,6,c,g1i);c=J(a,7);null!=c&&F(b,7,c);c=J(a,9);null!=c&&b.Ba(9,c);c=J(a,10);null!=c&&b.Ba(10,c);c=J(a,11);null!=c&&G(b,11,c);c=J(a,12);null!=c&&G(b,12,c);c=J(a,13);null!=c&&b.Ba(13,c)}
p.Ie=function(){return J(this,1)};p.Pg=function(){return J(this,2)};p.Sj=function(a){K(this,2,a)};p.getKey=function(){return J(this,5)};p.uh=function(){return Oi(this,e1i,6)};p.jd=function(a,b){return Si(this,6,a,e1i,b)};p.Oa=function(a){return K(this,7,a)};p.Zq=function(){return J(this,13)};function h1i(a){I(this,a,"amep",-1,null,null)}x(h1i,H);h1i.prototype.V=function(){var a=new D;var b=this.Bb();null!=b&&a.va(1,b,g1i);return Y(a)};h1i.messageId="amep";h1i.prototype.Bb=function(){return M(this,e1i,1,1)};h1i.prototype.ue=function(a){return Pi(this,1,a)};h1i.prototype.j6=function(){qQ(this,1)};h1i.prototype.WA=function(){return si(this,1)};function c8(a){Cm.call(this,a)}v(c8,Cm);function i1i(a){Cm.call(this,j1i);this.D=new h1i(a)}v(i1i,c8);i1i.prototype.C=g("D");var j1i=h1i.messageId;function k1i(a){I(this,a,0,-1,null,null)}x(k1i,H);k1i.prototype.V=function(){var a=new D;l1i(this,a);return Y(a)};
function l1i(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&b.Ba(3,c);c=J(a,4);null!=c&&F(b,4,c);c=J(a,5);null!=c&&b.Ba(5,c);c=J(a,6);null!=c&&b.Ba(6,c);c=J(a,7);null!=c&&b.Ba(7,c);c=J(a,8);null!=c&&F(b,8,c);c=J(a,9);null!=c&&F(b,9,c);c=J(a,10);null!=c&&F(b,10,c);c=J(a,11);null!=c&&b.Ba(11,c);c=J(a,12);null!=c&&F(b,12,c);c=J(a,13);null!=c&&b.Ba(13,c);c=J(a,14);null!=c&&b.Ba(14,c);c=J(a,15);null!=c&&b.Ba(15,c);c=J(a,16);null!=c&&b.Ba(16,c);c=J(a,17);null!=c&&b.Ba(17,
c);c=J(a,18);null!=c&&bi(b,18,c);c=J(a,19);null!=c&&F(b,19,c)}function d8(a){return J(a,2)}k1i.prototype.getName=function(){return J(this,3)};k1i.prototype.Mj=function(){return J(this,13)};function m1i(a,b){this.D=void 0===a?null:a;this.C=(void 0===b?null:b)||null}m1i.prototype.F=g("C");function n1i(a,b){return y(A(),"docs-emgsmw")?null==a.F||null==J(b,18)?!1:a.C===J(b,18):a.D===J(b,1)}function o1i(a){return new m1i(J(a,1),J(a,18))};function p1i(a){I(this,a,"der",-1,null,null)}x(p1i,H);p1i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};p1i.messageId="der";p1i.prototype.qr=function(){return vi(this,1)};function q1i(a){I(this,a,"eer",-1,null,null)}x(q1i,H);q1i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};q1i.messageId="eer";q1i.prototype.qr=function(){return vi(this,1)};function r1i(a,b,c){this.C=a;this.F=b;this.D=c}r1i.prototype.getVersionInfo=g("D");function s1i(a,b){this.C=a;this.D=b}s1i.prototype.getVersionInfo=g("D");function t1i(a,b){this.C=a;this.Td=b}t1i.prototype.getExtension=g("C");t1i.prototype.isEnabled=g("Td");function u1i(a){jw.call(this);this.C=a;Ns(this,!0);this.Lt(!1);Rs(this,null);Qs(this,!1)}v(u1i,jw);u1i.prototype.Ca=function(){jw.prototype.Ca.call(this);this.C.render(this.zb())};u1i.prototype.Ja=function(){jw.prototype.Ja.call(this);var a=this.La();es(a,"labelledby");gs(a,"Add-ons");ks(Ms(this),"gsm-widget")};function v1i(a,b){var c=new Yi,d=new QOd;if(b){if(J(b,1)){var e=J(b,1);K(d,1,e)}e=vi(b,12);K(d,2,e);si(b,18)&&(e=J(b,18),K(d,5,e));b=vi(b,19);K(d,6,b)}b=id(A(),"docs-tcmt");e=!!b;K(d,3,e);e&&K(d,4,b);Pi(c,73,d);return tq(uq(new sq,c),a).build()}function w1i(a){var b=new Yi,c=new QOd;null!=a.D&&K(c,1,a.D);null!=a.C&&K(c,5,a.C);Pi(b,73,c);return tq(uq(new sq,b),90).build()};function x1i(a,b,c){aX.call(this,a);this.D=b;this.F=c;this.D.Bi=!0}v(x1i,aX);p=x1i.prototype;p.Yra=function(){O("macros-extension-store-render").kb()};p.Pda=function(a,b,c){a=new m1i(null,a);O("macros-extension-store-install").kb(new r1i(a,String(b),c),w1i(a))};p.Xra=function(a,b){a=new m1i(null,a);O("macros-extension-store-uninstall-item").kb(new s1i(a,b),w1i(a))};
p.WMa=function(a){var b=new Gnf,c=this.F(new m1i(null,a));if(!c)return b;a=c.getExtension();c=c.isEnabled();var d=new $W;d.Sj("Use in this document");K(d,3,"useInDoc");d.Jb(!!vi(a,4)||!!vi(a,12));d.Oa(c);var e=new $W;e.Sj("Help");K(e,3,"help");d=[d,e];vi(a,9)&&(e=new $W,K(e,1,!0),d.push(e),vi(a,8)&&(a=new $W,a.Oa(c),a.Sj("Settings"),K(a,3,"settings"),d.push(a)),a=new $W,a.Sj("Report an issue"),K(a,3,"reportIssue"),d.push(a));Ri(b,1,d);return b};
p.VMa=function(a,b){var c=new m1i(null,a);a=w1i(c);switch(b){case "help":b=this.F(c);if(!b)break;b=b.getExtension();O("macros-extension-help").kb(d8(b),a);break;case "reportIssue":O("macros-extension-store-report").kb(c,a);break;case "settings":O("macros-extension-store-settings").kb(c,a);Xf(this.D);break;case "useInDoc":O("macros-extension-store-use-in-doc").kb(c,a)}};p.yma=function(){this.D.setVisible(!1)};function y1i(a,b,c){B.call(this);this.D=z1i(a);this.F=b;this.C=c}v(y1i,B);function A1i(a,b,c,d,e){b=new ivf(b,null,e);jvf(b,jd(A(),"docs-gsmd"));a.C&&mvf(b,a.C);p0i(b,c.map(function(f){return f.C}));d&&d.C&&(b.F=d.C);a=jd(A(),"gaia_session_id");a=$d(a)?NaN:Number(a);isNaN(a)||kvf(b,a);return b.build()}function B1i(a,b){var c=new u1i(b);a=new x1i(b,c,a.F);c.oa(a);return c}
function z1i(a){if(a==(av(),Yu))return"docs_addon";if(a==(av(),Zu))return"sheets_addon";if(a==(av(),$u))return"slides_addon";if(a==(av(),A1a))return"forms_addon";throw Error("Unsupported document type for GSM  ["+a+"]");};function C1i(a,b,c,d,e,f){B.call(this);this.D=b;this.F=new y1i(a,d,f);this.C=null}v(C1i,B);function D1i(a){I(this,a,"iar",-1,null,null)}x(D1i,H);D1i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&F(a,3,b);return Y(a)};D1i.messageId="iar";D1i.prototype.qr=function(){return vi(this,1)};function E1i(a,b,c,d){var e=J(a,4)+"-polymorphic-"+(a.Ie()||"");FTa.call(this,e);this.H=a;this.L=sd(b,function(f){return new E1i(f,[],!1)},this);this.Oa(this.isEnabled());this.xa=c;this.ma="boolean"===typeof d?d:!0}v(E1i,FTa);p=E1i.prototype;p.Ya=g("H");p.isInstalled=g("ma");p.kb=function(){O("macros-polymorphic-item").kb(this)};p.isEnabled=function(){return this.L&&(0<this.L.length?!0:!!vi(this.H,7))};p.getLabel=function(){return this.H.Pg()||J(this.H,10)||""};function F1i(){Cm.call(this,"cm")}v(F1i,Cm);function G1i(){Lm.call(this);this.C={};this.C[1]={};this.C[0]={};this.D=new Du(this);this.oa(this.D);this.D.subscribe(O("macros-polymorphic-item"),"action",this.F)}v(G1i,Lm);G1i.prototype.F=function(a){a.xa||0<a.L.length?this.dispatchEvent(new F1i(a)):(a=new d1i(J(a.Ya(),4),J(a.Ya(),3),void 0,J(a.Ya(),9)||void 0,void 0,a.Ya().Zq()||void 0),O("macros-exec").kb(a))};function H1i(a){I(this,a,"ger",-1,I1i,null)}x(H1i,H);var I1i=[1];H1i.prototype.V=function(){var a=new D;var b=this.yia();0<b.length&&ki(a,1,b,l1i);return Y(a)};H1i.messageId="ger";H1i.prototype.yia=function(){return Oi(this,k1i,1)};function J1i(a){I(this,a,0,-1,null,null)}x(J1i,H);J1i.prototype.V=function(){var a=new D;K1i(this,a);return Y(a)};function K1i(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c)}J1i.prototype.getName=function(){return J(this,1)};function L1i(a){I(this,a,0,-1,M1i,null)}x(L1i,H);var M1i=[4];p=L1i.prototype;p.V=function(){var a=new D;N1i(this,a);return Y(a)};function N1i(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&b.Ba(3,c);c=Oi(a,J1i,4);0<c.length&&ki(b,4,c,K1i)}p.getId=function(){return J(this,1)};p.wc=function(a){return K(this,1,a)};p.getName=function(){return J(this,2)};p.Od=function(){return J(this,3)};p.xi=function(a){return K(this,3,a)};function O1i(a){I(this,a,"llr",-1,P1i,null)}x(O1i,H);var P1i=[2];O1i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=Oi(this,L1i,2);0<b.length&&ki(a,2,b,N1i);return Y(a)};O1i.messageId="llr";O1i.prototype.qr=function(){return vi(this,1)};function Q1i(a){I(this,a,"rar",-1,null,null)}x(Q1i,H);Q1i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=J(this,2);null!=b&&a.Ba(2,b);return Y(a)};Q1i.messageId="rar";Q1i.prototype.qr=function(){return vi(this,1)};function R1i(a){I(this,a,"uer",-1,null,null)}x(R1i,H);R1i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};R1i.messageId="uer";R1i.prototype.qr=function(){return vi(this,1)};function S1i(a,b,c,d){B.call(this);this.D=a;this.F=c;this.C=d||new T1i}v(S1i,B);p=S1i.prototype;p.M3a=function(a,b,c,d,e,f,h){a=["ruid",Ha({}),this.C.C,this.D,this.C.F,a,this.C.ma,b,this.C.D,c,this.C.L,e,this.C.O,f,this.C.J,h];a=cp(Gl(ep(e8(this,this.C.xa),"POST"),2),a).Fr();d&&(Kl(a,w(this.cxb,this,d)),Jl(a,w(this.f8b,this,d)));a.Qe()};p.cancel=function(a){a=["ruid",Ha({}),this.C.C,this.D,this.C.H,a];cp(Gl(ep(e8(this,this.C.R),"POST"),2),a).Fr().Qe()};
function U1i(a,b){var c=["ruid",Ha({}),a.C.C,a.D];c=cp(Gl(e8(a,a.C.Aa),2),c);b&&(Kl(c,w(a.P8b,a,b)),Jl(c,w(a.O8b,a,b)));c.Qe()}p.cxb=function(a,b){b=b.we();b=new D1i(b[0]);a(b)};p.f8b=function(a){var b=new D1i;K(b,1,!1);a(b)};p.P8b=function(a,b){b=b.we();b=new O1i(b[0]);a(b)};p.O8b=function(a){var b=new O1i;K(b,1,!1);a(b)};p.dxb=function(a,b){b=b.we();b=new Q1i(b[0]);a(b)};p.uec=function(a){var b=new Q1i;K(b,1,!1);a(b)};
function V1i(a,b){var c=["ruid",Ha({}),a.C.C,a.D];Jl(Kl(cp(Gl(e8(a,"/scripts/getitems"),1),c),w(a.l6b,a,b)),za).Qe()}p.l6b=function(a,b){b=b.we();b=new H1i(b[0]);a(b)};function W1i(a,b,c,d){function e(h,k){k=k.we();k=new R1i(k[0]);h(k)}var f=["ruid",Ha({}),a.C.C,a.D];null!=b.D&&f.push("storeitemid",b.D);null!=b.C&&f.push("appid",b.C);d&&f.push("versioninfo",d);b=cp(ep(e8(a,"/scripts/uninstallitem"),"POST"),f).Fr();c&&(Kl(b,w(e,a,c)),a=new R1i,K(a,1,!1),Jl(b,Ia(c,a)));b.Qe()}
p.eVa=function(a,b,c,d,e,f){a=["ruid",Ha({}),this.C.C,this.D,this.C.D,e,"extensionid",a,"justInstalled",d];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);f&&a.push("versioninfo",f);b=cp(Gl(ep(e8(this,"/scripts/enableitem"),"POST"),1),a).Fr();c&&(Kl(b,w(this.t4b,this,c)),Jl(b,w(this.s4b,this,c)));b.Qe()};p.t4b=function(a,b){b=b.we();b=new q1i(b[0]);a(b)};p.s4b=function(a){var b=new q1i;K(b,1,!1);a(b)};
p.tKb=function(a,b,c,d){a=["ruid",Ha({}),this.C.C,this.D,this.C.D,d,"extensionid",a];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);b=cp(Gl(ep(e8(this,"/scripts/disableitem"),"POST"),1),a).Fr();c&&(Kl(b,w(this.V2b,this,c)),Jl(b,w(this.U2b,this,c)));b.Qe()};p.V2b=function(a,b){b=b.we();b=new p1i(b[0]);a(b)};p.U2b=function(a){var b=new p1i;K(b,1,!1);a(b)};function e8(a,b){return dp(a.F.Oe(b)).setTimeout(4E4)}
function T1i(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E,L,P,R){B.call(this);this.C=a||"id";this.F=c||"lib";this.ma=d||"func";this.D=e||"ctx";this.H=f||"pid";this.L=L||"eei";this.O=P||"usit";this.J=void 0!==R?R:"did";this.ea=h||"ca";this.xa=k||"/scripts/invoke";this.R=l||"/scripts/cancel";this.Aa=n||"/scripts/libraries";this.Ea=q||"/scripts/resume";this.Ha=u||"/scripts/uiready"}v(T1i,B);function X1i(a,b,c,d,e,f,h,k,l,n,q,t){B.call(this);var u=this;this.Ha=n?bbc(n):void 0;this.Ea=n?cbc(n):void 0;this.ma=a;this.C=d;this.Ma=e;this.ea=b;this.L=f;this.F=h;this.J=k;this.D=[];this.H=l;this.O=new mt("mae-show_addons_menu_promo");nt(c,this.O,"mae-show_addons_menu_promo");this.Aa=q||null;this.xa=t||null;this.R=new C1i(this.ma,this.ea,this,function(z){if(z=u.getExtension(z)){var E=2==u.H?!1:1==u.H?!(!vi(z,10)||!vi(z,9)):!0;z=new t1i(z,E)}else z=void 0;return z},this.Ea,this.Ha);this.oa(this.R);
O("macros-extension-store-install").Ab(Ap,this.N4b,this);O("macros-extension-store-install").Oa(!0);O("macros-extension-store-render").Ab(Ap,this.O4b,this);O("macros-extension-store-render").Oa(!0);O("macros-extension-store-report").Ab(Ap,this.P4b,this);O("macros-extension-store-report").Oa(!0);O("macros-extension-store-settings").Ab(Ap,this.Q4b,this);O("macros-extension-store-settings").Oa(!0);O("macros-extension-store-uninstall-item").Ab(Ap,this.R4b,this);O("macros-extension-store-uninstall-item").Oa(!0);
O("macros-extension-store-use-in-doc").Ab(Ap,this.S4b,this);O("macros-extension-store-use-in-doc").Oa(!0)}v(X1i,B);p=X1i.prototype;p.O4b=function(){Y1i(this)};p.N4b=function(a){a=a.data;Z1i(this,a.F,a.C,a.getVersionInfo())};p.P4b=function(a){a=this.getExtension(a.data);var b=o1i(a);this.z8a(b,d8(a),a.getName(),J(a,6)||void 0,J(a,11)||void 0)};p.Q4b=function(a){a=this.getExtension(a.data);$1i(this,d8(a))};p.R4b=function(a){a=a.data;var b=this.getExtension(a.C),c=b&&d8(b);b=o1i(b);a2i(this,c,b,za,a.getVersionInfo())};
p.S4b=function(a){var b=this.getExtension(a.data);a=o1i(b);vi(b,4)||vi(b,12)?b2i(this,d8(b),a,function(c){c&&(K(b,4,!1),K(b,12,!1))}):c2i(this,d8(b),a,function(c){c&&K(b,4,!0)})};p.PV=function(a){var b=d2i(this,!1),c=this.R;var d=c.F;a=A1i(d,d.D,b,a,!1);d=B1i(d,a);c.C=d;d=c.C;c.D.Zg(d);d.setVisible(!0);e2i(this)};function d2i(a,b){return(void 0===b?0:b)?a.D.map(function(c){return o1i(c)}):a.D.filter(function(c){return vi(c,10)&&vi(c,9)}).map(function(c){return o1i(c)})}
function $1i(a,b){f2i(a.C);var c=w(function(d,e){this.C.uO();d&&d(e)},a,void 0);rse(a.L.C,w(a.F.M3a,a.F,b,"doSettings",a.J().getState()||void 0,c))}function c2i(a,b,c,d){f2i(a.C);rse(a.L.C,w(a.F.eVa,a.F,b,c,w(function(e,f){if(f.qr()){var h=a.getExtension(c);h&&K(h,4,!0);Y1i(a)}a.C.uO();e&&e(f.qr())},a,d),void 0,a.J().getState()||void 0))}
function b2i(a,b,c,d){f2i(a.C);rse(a.L.C,w(a.F.tKb,a.F,b,c,w(function(e,f){if(f.qr()){O("macros-extension-disabled").kb(b);var h=a.getExtension(c);h&&(K(h,4,!1),K(h,12,!1));Y1i(a)}a.C.uO();e&&e(f.qr())},a,d),a.J().getState()||void 0))}function a2i(a,b,c,d,e){W1i(a.F,c,w(function(f,h){if(h.qr()&&b){O("macros-extension-disabled").kb(b);var k=a.D.findIndex(function(l){return n1i(c,l)});-1!=k&&Fd(a.D,k);(k=g2i(a.C))&&qe(k.J,b)}Y1i(a,function(){return f(h.qr())})},a,d),e)}
p.z8a=function(a,b,c,d,e){e?zr(e):(h2i(this.C,w(function(f,h){var k=this.F,l=w(this.C.vzc,this.C,c,h,d),n=w(this.C.uzc,this.C);f=["ruid",Ha({}),k.C.C,k.D,k.C.F,b,"issuedesc",f,"includeUserInfo",h];null!=a.D&&f.push("storeitemid",a.D);null!=a.C&&f.push("appid",a.C);cp(Jl(Kl(Gl(ep(e8(k,"/scripts/sendissuereport"),"POST"),1),Ee(l)),Ee(n)),f).Fr().Qe()},this),c),e2i(this))};
function Z1i(a,b,c,d){f2i(a.C);rse(a.L.C,w(a.F.eVa,a.F,b,c,function(e){a.C.uO();e.qr()?Y1i(a):(e=dv("Unable to install add-on","warning",!0),a.C.C.C.postMessage(e),e.getId(),i2i(a))},!0,a.J().getState()||void 0,d))}function Y1i(a,b){b=void 0===b?za:b;V1i(a.F,w(function(c,d){d=d.yia();Ad(this.D);d=ha(d);for(var e=d.next();!e.done;e=d.next())this.D.push(e.value);j2i(this);i2i(this);c()},a,b))}
function j2i(a){var b=a.Ma,c=Hd(a.D);b.C[1]={};b.C[0]={};for(var d=0;d<c.length;++d){var e=c[d],f=d8(e),h=new e1i,k=String(Ha(h));K(h,1,k);h.Sj(e.getName());k=d8(e);K(h,4,k);h.Oa(!0);k=e.getName();K(h,10,k);K(h,11,1);k=!(!vi(e,10)&&!vi(e,9));e=new E1i(h,[],!0,k,vi(e,19)||!1);e.setVisible(!0);b.C[xi(e.Ya(),11,0)][f]=e}b.dispatchEvent("am");if(b=a.C.O)if(zd(a.D))!a.O.getValue()&&O("macros-extension-menu-promo").isEnabled()&&(a=a.ma,Sl(b.J.F,"mae-promo-id")||(a=new k2i(a),a.render(),c=new Qt(""),c.wc("mae-promo-id"),
c.Ob("script-promo-menu-item"),c.setContent(a.getElement()),Hu(b.O,c,O("macros-extension-menu-promo"),void 0,void 0,v1i(3)),b.C.Qc(),b.J.Qc(),l2i(b.J,c)),m2i(b));else{c=Hd(a.D);if(b.F){Nd(c,b.Ma);f=new Rl;AAa(f,b.C.F);b.J.Qc();b.C.Qc();d=[];for(e=0;e<c.length;++e){k=c[e];var l=d8(k),n=!(!vi(k,10)&&!vi(k,9));d.push(l);h=f.get(l);var q=vi(k,19);if(h)l=h.Bb(),n&&!q&&(n=l.Bc(0),q="addon-menu-install-"+d8(k),n&&n.getId()==q&&(l.En(0).dispose(),2==l.jc()&&(l.Bc(0),l.En(0).dispose())));else{h=new au("");
h.wc(l);h.Oa(2==b.R?!1:1==b.R?!!(k&&vi(k,10)&&vi(k,9)):!0);var t=new Vt;n||q||n2i(b,t,k);o2i(b,t,l,[],k);h.ue(t)}k=k.getName();n=ak("span");n.appendChild(bk(k));h.setContent(n);p2i(h.Bb().La(),!0);l2i(b.C,h)}for(e=0;e<b.ea.length;++e)l2i(b.C,f.get(b.ea[e]));if(b.L)for(f=f.Pe(),e=0;e<f.length;++e)if(0>d.indexOf(f[e])&&0>b.ea.indexOf(f[e])&&(h=b.xa[f[e]])){for(k=0;k<h.length;++k)b.L.yR(h[k]);delete b.xa[f[e]]}O("macros-manage-extensions").Oa(!!c.length);m2i(b)}a.xa&&a.xa.C(!!a.D.length)}}
function i2i(a){var b=g2i(a.C);if(b){var c=Hd(a.D),d=a.H;b.C=[];for(var e=0;e<c.length;e++){var f=c[e];if(vi(f,12)||vi(f,4))Zea(b.C,f,b.dMb),b.H&&!vi(f,12)&&(b.H=!1)}O("macros-addon-sidebar-focus").Oa(0<b.C.length);b.R=0==d;b.ea=!0;b.L=1==b.C.length&&null!=q2i(b);b.yb()&&r2i(b);a.Aa&&a.Aa.C(0<b.C.length)}}p.getExtension=function(a){return this.D.find(function(b){return n1i(a,b)})};function s2i(a,b){return a.D.find(function(c){return d8(c)===b})}
function e2i(a){if(!a.O.getValue()&&(a.O.setValue(!0),zd(a.D))){var b=a.C.O;if(b){var c=Tj("docs-menu-superscript",b.D.getElement());c&&hr(c,0);b.J.Qc();m2i(b);j2i(a)}}};function t2i(a,b,c,d,e,f,h,k,l,n,q,t,u){this.L=a;this.F=b;this.R=c;this.ea=d;this.H=e;this.Aa=h;this.D=k;this.C=l;this.O=n;this.ma=q;this.xa=t;this.J=u}function u2i(a,b){a=a.R;if(b){a=new jm(a);var c=a.F;c+=Vd(c,"/")?"":"/";Vd(c,"/start/")&&(c=c.replace("start/",""));c+=sha("d/%s/edit",b);nm(a,c);a=a.toString()}return a};function v2i(a){I(this,a,0,-1,null,null)}x(v2i,H);v2i.prototype.V=function(){var a=new D;w2i(this,a);return Y(a)};function w2i(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&ai(b,3,c);c=J(a,4);null!=c&&b.Ba(4,c)};function x2i(a){I(this,a,0,-1,null,null)}x(x2i,H);x2i.prototype.V=function(){var a=new D;y2i(this,a);return Y(a)};function y2i(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&b.Ba(3,c);c=J(a,5);null!=c&&bi(b,5,c);c=J(a,6);null!=c&&G(b,6,c);c=M(a,v2i,7);null!=c&&b.va(7,c,w2i);c=J(a,8);null!=c&&G(b,8,c);c=J(a,9);null!=c&&bi(b,9,c);c=J(a,10);null!=c&&bi(b,10,c);c=J(a,11);null!=c&&bi(b,11,c)}x2i.prototype.Rf=function(){return J(this,3)};function z2i(a){I(this,a,"paep",-1,null,null)}x(z2i,H);z2i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=M(this,x2i,3);null!=b&&a.va(3,b,y2i);b=J(this,4);null!=b&&F(a,4,b);return Y(a)};z2i.messageId="paep";z2i.prototype.getUrl=function(){return J(this,1)};z2i.prototype.getMessage=function(){return J(this,2)};function A2i(a){Cm.call(this,B2i);this.D=new z2i(a)}v(A2i,c8);A2i.prototype.C=g("D");var B2i=z2i.messageId;function C2i(a){I(this,a,0,-1,null,null)}x(C2i,H);C2i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&G(a,1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&F(a,3,b);b=J(this,4);null!=b&&a.Ba(4,b);return Y(a)};C2i.prototype.ij=function(){return J(this,2)};function D2i(a){I(this,a,"rfep",-1,null,null)}x(D2i,H);D2i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,4);null!=b&&a.Ba(4,b);b=J(this,5);null!=b&&a.Ba(5,b);return Y(a)};D2i.messageId="rfep";D2i.prototype.getFunctionName=function(){return J(this,2)};D2i.prototype.Zq=function(){return J(this,5)};function E2i(a){Cm.call(this,F2i);this.D=new D2i(a)}v(E2i,c8);E2i.prototype.C=g("D");var F2i=D2i.messageId;function G2i(a){I(this,a,"sfep",-1,null,null)}x(G2i,H);G2i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&G(a,2,b);b=J(this,3);null!=b&&a.Ba(3,b);return Y(a)};G2i.messageId="sfep";G2i.prototype.vF=function(){return J(this,2)};G2i.prototype.getMessage=function(){return J(this,3)};function H2i(a){Cm.call(this,I2i);this.D=new G2i(a)}v(H2i,c8);H2i.prototype.C=g("D");var I2i=G2i.messageId;function J2i(a){I(this,a,"step",-1,null,null)}x(J2i,H);J2i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&F(a,2,b);return Y(a)};J2i.messageId="step";J2i.prototype.y7=function(){return vi(this,2)};function K2i(a){Cm.call(this,L2i);this.D=new J2i(a)}v(K2i,c8);K2i.prototype.C=g("D");var L2i=J2i.messageId;function M2i(a){I(this,a,"scpep",-1,null,null)}x(M2i,H);M2i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};M2i.messageId="scpep";function N2i(a){Cm.call(this,O2i);this.D=new M2i(a)}v(N2i,c8);N2i.prototype.C=g("D");var O2i=M2i.messageId;function P2i(a){I(this,a,"saep",-1,null,null)}x(P2i,H);P2i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&a.Ba(3,b);b=J(this,4);null!=b&&a.Ka(4,b);b=J(this,5);null!=b&&a.Ka(5,b);b=J(this,6);null!=b&&G(a,6,b);b=J(this,7);null!=b&&a.Ba(7,b);b=J(this,8);null!=b&&F(a,8,b);b=M(this,DS,9);null!=b&&a.va(9,b,CS);return Y(a)};P2i.messageId="saep";p=P2i.prototype;p.getTitle=function(){return J(this,2)};
p.setTitle=function(a){return K(this,2,a)};p.getWidth=function(){return J(this,4)};p.setWidth=function(a){return K(this,4,a)};p.getHeight=function(){return J(this,5)};p.setHeight=function(a){return K(this,5,a)};p.Tk=function(){return xi(this,6,0)};p.Op=function(a){return K(this,6,a)};p.Tv=function(){return si(this,6)};function Q2i(a){Cm.call(this,R2i);this.D=new P2i(a)}v(Q2i,c8);Q2i.prototype.C=g("D");var R2i=P2i.messageId;function S2i(a){I(this,a,"snep",-1,null,null)}x(S2i,H);S2i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&G(a,1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&a.Ba(3,b);b=J(this,4);null!=b&&a.Ua(4,b);return Y(a)};S2i.messageId="snep";p=S2i.prototype;p.getType=function(){return xi(this,1,0)};p.setType=function(a){return K(this,1,a)};p.clearType=function(){return Fi(this,1)};p.hasType=function(){return si(this,1)};p.getText=function(){return J(this,2)};
p.hasText=function(){return si(this,2)};p.getTitle=function(){return J(this,3)};p.setTitle=function(a){return K(this,3,a)};function T2i(a){Cm.call(this,U2i);this.D=new S2i(a)}v(T2i,c8);T2i.prototype.C=g("D");var U2i=S2i.messageId;function V2i(a){I(this,a,"spep",-1,W2i,null)}x(V2i,H);var W2i=[4];V2i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&a.Ba(3,b);b=J(this,4);0<b.length&&ii(a,4,b);b=J(this,5);null!=b&&F(a,5,b);b=J(this,6);null!=b&&F(a,6,b);b=J(this,7);null!=b&&a.Ba(7,b);return Y(a)};V2i.messageId="spep";V2i.prototype.getTitle=function(){return J(this,2)};V2i.prototype.setTitle=function(a){return K(this,2,a)};
V2i.prototype.mf=function(a,b){return Mi(this,4,a,b)};function X2i(a){Cm.call(this,Y2i);this.D=new V2i(a)}v(X2i,c8);X2i.prototype.C=g("D");var Y2i=V2i.messageId;function Z2i(a){I(this,a,"stbep",-1,null,null)}x(Z2i,H);Z2i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&a.Ba(3,b);b=J(this,4);null!=b&&a.Ba(4,b);b=J(this,5);null!=b&&a.Ba(5,b);b=J(this,6);null!=b&&a.Ba(6,b);return Y(a)};Z2i.messageId="stbep";p=Z2i.prototype;p.getFunctionName=function(){return J(this,2)};p.Pg=function(){return J(this,3)};p.Sj=function(a){K(this,3,a)};p.getUrl=function(){return J(this,5)};
p.Zq=function(){return J(this,6)};function $2i(a){Cm.call(this,a3i);this.D=new Z2i(a)}v($2i,c8);$2i.prototype.C=g("D");var a3i=Z2i.messageId;function b3i(a){I(this,a,"sttep",-1,null,null)}x(b3i,H);b3i.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);return Y(a)};b3i.messageId="sttep";b3i.prototype.getText=function(){return J(this,1)};b3i.prototype.hasText=function(){return si(this,1)};b3i.prototype.nk=function(){return J(this,2)};b3i.prototype.Zd=function(a){K(this,2,a)};function c3i(a){Cm.call(this,d3i);this.D=new b3i(a)}v(c3i,c8);c3i.prototype.C=g("D");var d3i=b3i.messageId;function e3i(){Lm.call(this);var a=this;this.C=null;this.D=function(b){switch(b[0]){case j1i:b=new i1i(b);a.dispatchEvent(b);break;case B2i:b=new A2i(b);a.dispatchEvent(b);break;case F2i:b=new E2i(b);a.dispatchEvent(b);break;case I2i:b=new H2i(b);a.dispatchEvent(b);break;case L2i:b=new K2i(b);a.dispatchEvent(b);break;case R2i:b=new Q2i(b);a.dispatchEvent(b);break;case U2i:b=new T2i(b);a.dispatchEvent(b);break;case Y2i:b=new X2i(b);a.dispatchEvent(b);break;case a3i:b=new $2i(b);a.dispatchEvent(b);
break;case d3i:b=new c3i(b);a.dispatchEvent(b);break;case O2i:b=new N2i(b),a.dispatchEvent(b)}}}v(e3i,Lm);e3i.prototype.bind=function(a){this.C=a;this.C.subscribe("13",this.D)};e3i.prototype.Na=function(){this.C&&this.C.unsubscribe("13",this.D);Lm.prototype.Na.call(this)};function f3i(a,b){Lm.call(this);this.D=new Pm(this);this.oa(this.D);this.C={};this.F=a;this.H=b}v(f3i,Lm);p=f3i.prototype;p.start=function(){this.D.listen(this.H,I2i,w(this.EOa,this));this.D.listen(this.H,L2i,w(this.gxb,this))};function g3i(a,b,c,d){var e=void 0;e=void 0===e?za:e;d=void 0===d?za:d;d=w(a.fxb,a,b,e,d);a=a.F;b=["ruid",Ha({}),a.C.C,a.D,a.C.H,b,a.C.ea,c];b=cp(Gl(ep(e8(a,a.C.Ea),"POST"),2),b).Fr();d&&(Kl(b,w(a.dxb,a,d)),Jl(b,w(a.uec,a,d)));b.Qe()}
p.exb=function(a,b,c,d,e,f){f.qr()?(a=J(f,2),this.C[a]=new h3i(a,b,d,e),c(a,Bi(f,3,!1))):(b=new G2i,K(b,2,6),e(b))};p.fxb=function(a,b,c,d){d.qr()?b():(c(),b=new G2i,K(b,1,a),K(b,2,6),this.EOa(new H2i(b.Gb())))};p.gxb=function(a){a=a.C();var b=J(a,1);if(me(this.C,b)){var c=sfa(this.C,b);(0,c.hxb)(a);c.dispose();qe(this.C,b)}};p.EOa=function(a){a=a.C();var b=J(a,1);if(me(this.C,b)){var c=sfa(this.C,b);(0,c.rMb)(a);c.dispose();qe(this.C,b)}a="Google Apps Script: "+a.getMessage();window.console.log(a)};
p.Na=function(){Yf(this.C);Lm.prototype.Na.call(this)};function h3i(a,b,c,d){B.call(this);this.C=b;this.hxb=c;this.rMb=d}v(h3i,B);h3i.prototype.getFunctionName=g("C");function i3i(a){var b=a.id,c=a.Vkc,d=a.qba,e=a.zIb,f=a.YY,h=a.Iva;return T('<div class="'+U(a.Cs)+'" aria-labelledby="title'+U(b)+'" tabindex="0"><div class="'+U(c)+'"><div class="'+U(d)+'" id="title'+U(b)+'"></div><div class="'+U(e)+'" tabindex="0" title="'+U("Close sidebar")+'" aria-label="'+U("Close sidebar")+'" role="button">'+tw(h)+'</div></div><div class="'+U(f)+'"></div></div>')}
function j3i(a){a=a.caption;return T('<div class="'+U("docs-script-button-bar-text")+" "+U("docs-titlebar-button")+" "+U("goog-inline-block")+'" tabindex="0">'+Jr(a)+"</div>")}function k3i(a){a=a.text;return T('<div class="'+U("docs-script-button-bar-bubble-content")+'">'+Jr(a)+"</div>")}
function l3i(a){var b=a.iconName,c=a.title;a=a.description;return T('<div class="'+U("script-promo-menu-item-content")+'"><div class="'+U("script-promo-menu-item-icon")+'" aria-hidden="true"><img src="//ssl.gstatic.com/docs/common/'+U(b)+'.svg"/></div><div class="'+U("script-promo-menu-item-text")+'"><div class="'+U("script-promo-menu-item-title")+'">'+Jr(c)+'</div><div class="'+U("script-promo-menu-item-description")+'">'+Jr(a)+"</div></div></div>")}
function m3i(a){var b=a.functionName;a=a.qGa;return T('<div class="'+U("func-entry")+'" aria-checked="false" role="radio" tabindex="-1"><div class="'+U("goog-inline-block")+" "+U("func-entry-rb")+'">&nbsp;</div><div class="'+U("goog-inline-block")+" "+U("func-entry-func")+'">'+Jr(b)+'</div><div class="'+U("goog-inline-block")+" "+U("func-entry-lib")+'">'+Jr(a)+"</div></div>")}
function n3i(a){var b=a.ids,c=a.description;a=a.Emc;var d='<div class="'+U("script-help-dialog-content")+'"><div class="'+U("script-help-dialog-content-left")+" "+U("goog-inline-block")+(a?" "+U("script-help-dialog-content-left-gsm-onhold")+" ":"")+'">';a?(d+='<div class="'+U("script-help-dialog-content-section")+" "+U("script-help-dialog-content-section-gsm-onhold")+'" tabindex="0"><div class="'+U("script-help-dialog-content-title")+'">'+T('<div class="'+(U("script-help-dialog-content-title-caution-icon")+
'"><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11,15 L13,15 L13,17 L11,17 L11,15 Z M11,7 L13,7 L13,13 L11,13 L11,7 Z M11.99,2 C6.47,2 2,6.48 2,12 C2,17.52 6.47,22 11.99,22 C17.52,22 22,17.52 22,12 C22,6.48 17.52,2 11.99,2 Z M12,20 C7.58,20 4,16.42 4,12 C4,7.58 7.58,4 12,4 C16.42,4 20,7.58 20,12 C20,16.42 16.42,20 12,20 Z" id="path-1"></path></defs><g id="caution" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="alert/error_outline_24px"><mask id="mask-2" fill="white"><use xlink:href="#path-1"></use></mask><g id="ic_error_outline_24px" fill-rule="nonzero"></g><g id="_c/Red/600" mask="url(#mask-2)" fill="#D93025" fill-rule="evenodd"><rect id="swatch" x="0" y="0" width="24" height="24"></rect></g></g></g></svg></div>'))+
"<span>",d+="Add-on not available in \r\n G Suite Marketplace</span></div><div>The developer of this add-on has not accepted the terms and conditions of G Suite Marketplace.</div></div>"):(d+='<div class="'+U("script-help-dialog-content-section")+'" tabindex="0"><div class="'+U("script-help-dialog-content-title")+'">',d=d+"Getting started</div><div>"+(Jr(c)+"</div></div>"));d+='</div><div id="'+U(b.Bca)+'" class="'+U("script-help-dialog-buttons")+" "+U("goog-inline-block")+'"></div></div>';return T(d)}
function o3i(a){var b=a.cMb;a='<p class="'+U("script-reportissue-dialog-description-label")+'" tabindex="0">';var c="Describe the issue for the creators of <strong>"+(Jr(b)+"</strong>:");a=a+c+('</p><textarea class="'+U("jfk-textinput")+" "+U("script-reportissue-dialog-description")+'"></textarea><p class="'+U("script-reportissue-dialog-disclaimer")+'" tabindex="0">');a=a+'Only this description will be sent, no information from your open document.</p><div class="'+(U("script-reportissue-dialog-nonanonymous")+
'" tabindex="0"><div class="'+U("script-reportissue-dialog-nonanonymous-control")+" "+U("goog-inline-block")+'"><div class="'+U("script-reportissue-dialog-nonanonymous-checkbox")+" "+U("jfk-checkbox")+'"></div></div><div class="'+U("script-reportissue-dialog-nonanonymous-label")+" "+U("goog-inline-block")+'"><div class="'+U("script-reportissue-dialog-nonanonymous-optional-text")+" "+U("goog-inline-block")+'">');a+="(Optional)</div> ";b="Include your name and email address so the creators of <strong>"+
(Jr(b)+" </strong>can follow up.");a=a+b+"</div></div>";return T(a)}
function p3i(a,b){a=a||{};a=a.qc;var c='<div class="'+U("func-actions")+'">';c+=Tu({id:"func-action-new",content:Or("New"),style:0},b);c+=Tu({id:"func-action-run",content:Or("Run"),style:0,Id:"jfk-button-collapse-right"},b);c+=Tu({id:"func-action-edit",content:Or("Edit"),style:0,Id:"jfk-button-collapse-left"},b);c+=Tu({id:"func-action-reload",content:Or(""+tw(a?"docs-icon-img docs-icon-reload-rtl":"docs-icon-img docs-icon-reload")),style:0,width:1,title:"Reload"},b);c+='</div><div class="'+U("func-header")+
'"><div class="'+U("func-header-rb")+" "+U("goog-inline-block")+'"></div><div class="'+U("func-header-func")+" "+U("goog-inline-block")+'">';c=c+'Function</div><div class="'+(U("func-header-lib")+" "+U("goog-inline-block")+'">');c=c+'Script</div></div><div class="'+(U("func-entries")+'" role="radiogroup" tabindex="0"></div>');return T(c)}function q3i(){var a='<div class="'+U("func-loading")+'">';return T(a+"Fetching scripts\u2026</div>")}
function r3i(){var a='<div class="'+U("func-none")+'">';return T(a+"No scripts found</div>")};function s3i(){}v(s3i,rt);s3i.prototype.kc=m("func-entry");s3i.prototype.Ug=m(!1);s3i.prototype.Ca=function(a){return Gr(m3i,{functionName:a.getFunctionName(),qGa:a.Lnc},void 0,a.qa())};Ca(s3i);function t3i(a,b,c,d,e,f){yt.call(this,null,d||s3i.getInstance(),e);this.A4a=a;this.D=void 0!==f?f:null;this.Lnc=b;this.C=c;this.Pf(16,!0);this.Pf(32,!0);Bt(this,16,!0);At(this,16,!1)}v(t3i,yt);t3i.prototype.Np=function(a){yt.prototype.Np.call(this,a);a&&this.getElement()&&this.getElement().focus()};t3i.prototype.Zq=g("D");t3i.prototype.getFunctionName=g("C");t3i.prototype.rc=function(a){yt.prototype.rc.call(this,a);this.Jb(a);this.getElement()&&ok(this.getElement(),a)};function u3i(a,b){jw.call(this,void 0,void 0,a);this.O=b||!1;this.Ms=new y_a;this.oa(this.Ms);this.Ce=new ot;this.oa(this.Ce);this.H=new Uu("");this.oa(this.H);this.C=new Uu("");this.oa(this.C);this.F=new Uu("");this.oa(this.F);this.L=new Uu("");this.oa(this.L);a=new Os(a);a.set("close","Close",!1,!0);Ns(this,!1);Rs(this,a);this.setTitle("Script manager")}v(u3i,jw);p=u3i.prototype;
p.reset=function(a){this.Ms.clear();this.od(!0);0===a?(a=Gr(q3i,{},void 0,this.qa()),a=new yt(a),a.Pf(32,!1),this.Ia(a,!0)):1===a&&(a=Gr(r3i,{},void 0,this.qa()),a=new yt(a),a.Pf(32,!1),this.Ia(a,!0))};p.focus=function(){if(this.yb()&&0<this.Ms.qh()){var a=this.Ms.rf();a&&a.Np(!0)}else jw.prototype.focus.call(this)};p.od=function(a){a=jw.prototype.od.call(this,a);this.Ms.clear();v3i(this);return a};
p.Af=function(a,b,c){jw.prototype.Af.call(this,a,b,c);a instanceof t3i&&(b=a.isChecked(),this.Ms.jd(a),1==this.Ms.qh()||b)&&(B_a(this.Ms,a),a.Np(!0));v3i(this)};p.Ca=function(){jw.prototype.Ca.call(this);var a=this.zb();ks(a,"script-explorer-contents");Er(a,p3i,{qc:this.O});a=ik(jk(a));this.H.Va(a[0]);this.F.Va(a[1]);this.C.Va(a[2]);this.L.Va(a[3]);ct(this,"run")};
p.Ja=function(){jw.prototype.Ja.call(this);this.Ce.Qf(this.zb());v3i(this);this.addEventListener("dialogselect",ye(!0));Fm(this,"action",this.A0a,void 0,this);Fm(this.Ce,"key",this.d1a,void 0,this);var a=new Ps("new",this.H.getContent());Fm(this.H,"action",w(this.dispatchEvent,this,a));a=new Ps("run",this.F.getContent());Fm(this.F,"action",w(this.dispatchEvent,this,a));a=new Ps("edit",this.C.getContent());Fm(this.C,"action",w(this.dispatchEvent,this,a));a=new Ps("reload",this.L.getContent());Fm(this.L,
"action",w(this.dispatchEvent,this,a))};p.Cd=function(){jw.prototype.Cd.call(this);this.Ce.detach();Im(this,"action",this.A0a,void 0,this);Im(this.Ce,"key",this.d1a,void 0,this);Km(this.H);Km(this.F);Km(this.C);Km(this.L)};p.zb=function(){var a=jw.prototype.zb.call(this),b=ik(a);return 0<b.length?b[2]:a};p.A0a=function(a){v3i(this);a.target instanceof t3i&&(B_a(this.Ms,a.target),a.target.Np(!0))};
p.d1a=function(a){var b=this.Ms.qh();if(0<b)switch(a.keyCode){case 38:this.Ms.jf(yj(this.Ms.gi()-1,b));a.preventDefault();this.focus();break;case 40:this.Ms.jf(yj(this.Ms.gi()+1,b)),a.preventDefault(),this.focus()}};function v3i(a){var b=!!a.Ms.rf();a.F.setVisible(b);a.C.setVisible(b)};function w3i(a,b){this.D=a;this.C=b}function x3i(a){a.D.H&&Y1i(a.C,function(){if(O("macros-extensions").isEnabled()){a.D.Aa&&!a.D.C&&a.C.PV();var b=a.D.ma;if(b&&(b=a.C.getExtension(new m1i(b))||s2i(a.C,b))){var c=a.C,d=c.C.O;d&&(f2i(c.C),c=w(c.C.uO,c.C),y3i(d,d8(b),c))}}})};function z3i(){B.call(this);this.F=new Rl}v(z3i,nv);z3i.prototype.C=function(){return this.F.Jd()};function l2i(a,b){a.F.set(b.getId(),b)}z3i.prototype.Qc=function(){this.F.clear()};function k2i(a,b){S.call(this,b);this.C=a}v(k2i,S);
k2i.prototype.Ca=function(){S.prototype.Ca.call(this);var a=this.C==(av(),Yu)?"Do more with Docs":this.C==(av(),A1a)?"Do more with Forms":this.C==(av(),Zu)?"Do more with Sheets":this.C==(av(),$u)?"Do more with Slides":"Do more with Docs",b=this.C==(av(),Yu)?"Looking for even more Docs features? Get a few add-ons.":this.C==(av(),A1a)?"Looking for even more Forms features? Get a few add-ons.":this.C==(av(),Zu)?"Looking for even more Sheets features? Get a few add-ons.":this.C==(av(),$u)?"Looking for even more Slides features? Get a few add-ons.":
"Looking for even more Docs features? Get a few add-ons.",c=this.C==(av(),Yu)?"addon_docs_promo":this.C==(av(),A1a)?"addon_forms_promo":this.C==(av(),Zu)?"addon_sheets_promo":this.C==(av(),$u)?"addon_slides_promo":"addon_docs_promo",d=this.qa();this.Ic(Gr(l3i,{title:a,description:b,iconName:c},void 0,d))};function A3i(){}v(A3i,Lt);A3i.prototype.Ca=function(a){a=Lt.prototype.Ca.call(this,a);bs(a,"menuitem");return a};A3i.prototype.kc=m("goog-control");A3i.prototype.Ao=function(a){a=Lt.prototype.Ao.call(this,a);a.push("menu-button","goog-inline-block");return a};Ca(A3i);function B3i(a,b,c,d,e){B.call(this);this.O=b;this.R=c;this.D=a;this.H={};this.Aa={};this.xa={};this.ma=[];this.ea=[];this.F=d||null;this.L=e||null;this.C=new z3i;this.J=new z3i;this.Ea=new Pm;this.oa(this.Ea);this.Ha=[]}v(B3i,B);B3i.prototype.Na=function(){Yf(this.H);B.prototype.Na.call(this)};B3i.prototype.WA=function(a){return me(this.H,a)};
function C3i(a,b,c){c=c?[c]:ke(a.H);for(var d=0;d<c.length;d++)for(var e=c[d].Bb(),f=0;f<e.jc();f++){var h=e.Bc(f);if(h instanceof Qt&&h.getId()==b||h instanceof au&&(h=C3i(a,b,h)))return h}return null}
function D3i(a,b,c,d,e){if(J(b,3)){var f=vi(b,7)||!1,h=b.Pg(),k=J(b,10),l=new Qt("");l.wc(b.Ie()||String(Ha(l)));var n=[bk(h)];d&&b.getKey()&&(d+=b.getKey().toUpperCase(),d=o0a(l,O("macros-exec"),[d]),a.ma.push(d),n.push(d));l.setContent(n);b=new d1i(J(b,4),J(b,3),void 0,J(b,9)||void 0,void 0,b.Zq()||void 0);Hu(a.O,l,O("macros-exec"),null,ye(b),v1i(3,e));l.Oa(f);a.L&&f&&k&&(e=h+(" ("+(k+")")),c.push(a.L.Mr(O("macros-exec"),[b],ye(e),ye(e))[0]));return l}if(!b.Pg())return new Ut;if(0<b.uh().length){l=
new Vt;f=b.uh();for(h=0;h<f.length;h++)l.Ia(D3i(a,f[h],c,d,e),!0);a=new au(b.Pg());a.wc(b.Ie()||String(Ha(a)));a.ue(l);p2i(l.La(),!0);return a}throw Error("Unsupported menu item type.");}B3i.prototype.Ma=function(a,b){return Xd(a.getName(),b.getName())};function o2i(a,b,c,d,e){if(b.Bka()){var f=new e1i,h=String(Ha(f));K(f,1,h);b.Ia(D3i(a,f,d),!0)}d=new Qt("Help");d.wc(String(Ha(d)));Hu(a.O,d,O("macros-extension-help"),null,ye(c),v1i(3,e));d.Oa(!0);b.Ia(d,!0)}
function n2i(a,b,c){var d=new Qt("");d.wc("addon-menu-install-"+d8(c));Hu(a.O,d,O("macros-extension-install-start"),Ku,ye(d8(c)),v1i(3,c));d.Oa(!0);b.Ia(d,!0)}function m2i(a){tv(a.F,"docs-macros-extension-promo")||sv(a.F,"docs-macros-extension-promo",[a.J,null]);tv(a.F,"docs-macros-extensions")||sv(a.F,"docs-macros-extensions",[a.C]);a.F.Bb("docs-extensions-menu",!0);px()&&a.F.Bb("macros-extension-add-ons-menu",!0)}
function y3i(a,b,c){var d=c||za;(c=a.C.F.get(b))?-1===a.Ha.indexOf(b)?(b=mn(w(function(e){e.dispatchEvent("load")},a,c),1E4),b=w(function(e,f,h){this.D.Eca("docs-extensions-menu");e.Ng(!0);e.RV();nn(h);f()},a,c,d,b),a.Ea.Nc(c,"load",b)):(a.D.Eca("docs-extensions-menu"),UZa(c),c.Ng(!0),c.RV(),d()):d()}function p2i(a,b){px()&&(ks(a,"ia-menu"),b||ks(a,"ia-primary-menu"))};function E3i(a,b){var c=a.Iva;a='<div class="'+U(a.Cs)+'" aria-labelledby="addon-sidebar-title" tabindex="0"><div class="'+U("addon-sidebar-header")+'"><div class="'+U("addon-sidebar-title")+'" id="addon-sidebar-title">';a=a+"Document add-ons</div>"+(Tu({Id:"addon-sidebar-close docs-material",content:Or(""+tw(c)),style:4,title:"Close sidebar"},b)+'</div><div class="'+U("addon-sidebar-content")+'"><div class="'+U("addon-sidebar-banner")+'"></div><div class="'+U("addon-sidebar-introduction")+'"></div></div><div class="'+
U("addon-sidebar-empty-caption")+'"><div class="'+U("addon-sidebar-empty-title")+'">');a=a+'No document add-ons</div><div class="'+(U("addon-sidebar-empty-description")+'">');return T(a+"This document doesn't include any add-ons</div></div></div>")}function F3i(a){var b=a.IGb;a=a.FGb;return T('<img class="'+U("addon-sidebar-banner-image")+'" src='+Rr(Tr(b))+" alt="+Rr(a)+' /><div class="'+U("addon-sidebar-banner-image-overlay")+'"></div>')};function G3i(a){var b=a.icon,c=a.title,d=a.category,e=a.summary,f=a.isInstalled;a=a.vCc;return T('<div class="'+U("addon-sidebar-card")+'" aria-label="'+U(c)+'" tabindex="0" role="region"><div class="'+U("addon-sidebar-card-header")+'"><div class="'+U("addon-sidebar-card-icon")+'">'+(b?'<img class="'+U("addon-sidebar-card-icon-image")+'" src='+Rr(Tr(b))+" alt="+Rr(c)+" />":"")+'</div><div class="'+U("addon-sidebar-card-header-content")+'"><div class="'+U("addon-sidebar-card-title")+'"><div class="'+
U("addon-sidebar-card-title-caption")+(a?" "+U("addon-sidebar-card-two-line-title-caption"):"")+'">'+Jr(c)+"</div>"+(f?T('<div class="'+(U("addon-sidebar-card-check")+'"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 48 48" fill="')+U("#455A64")+'"><path d="M0 0h48v48H0z" fill="none"/><path d="M24 4C12.95 4 4 12.95 4 24c0 11.04 8.95 20 20 20 11.04 0 20-8.96 20-20 0-11.05-8.96-20-20-20zm-4 30L10 24l2.83-2.83L20 28.34l15.17-15.17L38 16 20 34z"/></svg></div>'):"")+'</div><div class="'+
U("addon-sidebar-card-category")+'">'+Jr(d)+"</div></div></div>"+(e?'<div class="'+U("addon-sidebar-card-summary")+'">'+Jr(e)+"</div>":"")+"</div>")};function H3i(){}v(H3i,vD);H3i.prototype.kc=m("docs-material-menu-button-flat-primary");H3i.prototype.Qn=function(){return Gr(Fnc,{className:"docs-material-menu-button-flat-primary-dropdown"})};Ca(H3i);function I3i(a,b,c,d,e){c=void 0===c?H3i.getInstance():c;bu.call(this,a,b,c,d,e)}v(I3i,bu);function J3i(){}v(J3i,vD);J3i.prototype.kc=m("docs-material-menu-button-raised-primary");J3i.prototype.Qn=function(){return Gr(Fnc,{className:"docs-material-menu-button-raised-primary-dropdown"})};Ca(J3i);function K3i(a,b,c,d,e){c=void 0===c?J3i.getInstance():c;bu.call(this,a,b,c,d,e)}v(K3i,bu);function L3i(a,b,c,d,e){B.call(this);this.D=a;this.C=b;this.F=c;this.H=d;this.eb=e||Lj()}v(L3i,B);
function M3i(a,b){if(!b)return N3i(a);b=b.uh();if(1==b.length&&J(b[0],3)){var c=N3i(a);b=b[0];c.Oa(!!vi(b,7));b=new d1i(J(b,4),J(b,3),void 0,J(b,9)||void 0);Hu(a.D,c,O("macros-exec"),{enabled:!0},ye(b),a.F);return c}c=new Vt(a.eb);for(var d=0;d<b.length;d++)c.Ia(O3i(a,b[d]),!0);b=[bk("Use")];a=a.C?new K3i(b,c,void 0,a.eb):new I3i(b,c,void 0,a.eb);a.Yd("Use");a.Ob("addon-sidebar-card-menu-button");a.Oa(!0);return a}
function O3i(a,b){if(J(b,3)){var c=b.Pg(),d=new Qt("");d.Ob(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");d.setContent([bk(c)]);c=new d1i(J(b,4),J(b,3),void 0,J(b,9)||void 0);Hu(a.D,d,O("macros-exec"),{enabled:!0},ye(c),a.F);d.Oa(!!vi(b,7));return d}if(!b.Pg())return new Ut;if(0<b.uh().length){d=new Vt(a.eb);c=b.uh();for(var e=0;e<c.length;e++)d.Ia(O3i(a,c[e]),!0);b=new au(b.Pg());b.Ob(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");
b.ue(d);return b}throw Error("Unsupported menu item type.");}function N3i(a){var b=[bk("Use")];a=a.C?new yxf(b,a.eb):new AP(b,a.eb);a.Yd("Use");a.Ob("addon-sidebar-card-button");a.Oa(!1);return a};function P3i(a,b,c,d,e){S.call(this,e);this.C=a;this.ma=b;this.R=vi(this.C,19)||!1;this.H=!(!vi(this.C,10)&&!vi(this.C,9));this.L=new Fu(void 0,void 0,!0,Hw.getInstance());this.oa(this.L);this.ea=v1i(10,this.C);this.J=new yt(void 0,void 0,e);this.oa(this.J);this.F=new L3i(this.L,c,this.ea,d,e);this.oa(this.F);if(this.H)a=M3i(this.F);else{a=this.F;b=this.C;a:switch(a.H){case av(),Yu:c="Add to Docs";break a;case av(),$u:c="Add to Slides";break a;case av(),Zu:c="Add to Sheets";break a;default:throw Error("Unsupported document type");
}d=[bk(c)];d=a.C?new yxf(d,a.eb):new AP(d,a.eb);d.Yd(c);d.Ob("addon-sidebar-card-button");d.Oa(!1);Hu(a.D,d,O("macros-extension-install-start"),{enabled:!0},ye(d8(b)),a.F);a=d}this.D=a;a=this.F;b=this.C;c=new AP([bk("Help")],a.eb);c.Yd("Help");c.Ob("addon-sidebar-card-button");c.Oa(!1);c.Zd("Help");Hu(a.D,c,O("macros-extension-help"),{enabled:!0},ye(d8(b)),a.F);this.O=c}v(P3i,S);
P3i.prototype.Ca=function(){S.prototype.Ca.call(this);var a=J(this.C,15)||"";a&&(a=km(new jm(a),"https").toString());var b=this.qa();a={icon:a,title:this.C.getName(),category:this.C.Mj(),isInstalled:this.H,summary:J(this.C,14),vCc:Nf};b=Gr(G3i,a,void 0,b);this.mb(b);this.Ic(b)};P3i.prototype.Ic=function(a){S.prototype.Ic.call(this,a);a=this.Da("addon-sidebar-card-title-caption");bs(a,"button");this.Ia(this.J);this.J.Va(a)};
P3i.prototype.Ja=function(){S.prototype.Ja.call(this);Hu(this.L,this.J,O("macros-manage-extensions"),{},ye(o1i(this.C)),this.ea);Q3i(this);!this.H&&this.R&&(this.Ia(this.O,!0),this.O.Oa(!0))};P3i.prototype.Na=function(){Xf(this.D);Xf(this.O);S.prototype.Na.call(this)};function R3i(a,b){a.H&&(a.D.getParent()==a&&a.removeChild(a.D,!0),Xf(a.D),a.D=M3i(a.F,b),a.yb()&&Q3i(a))}
function Q3i(a){a.Ia(a.D,!0);a.H||(a.D.Oa(a.ma&&!a.R),a.ma?a.R&&a.D.Zd("Add-on not available in G Suite Marketplace"):a.D.Zd("Disabled for your organization"))};function S3i(a,b,c){jS.call(this,c);this.D={};this.C=[];this.R=!1;this.H=a;this.ma=b;this.J={};this.F=new zK(this.qa(),"addon-sidebar-spinner");this.Ia(this.F);this.O=new Uu(void 0,this.qa());this.L=this.ea=!1}v(S3i,jS);p=S3i.prototype;p.Ca=function(){jS.prototype.Ca.call(this);var a={Cs:"addon-sidebar",Iva:Wp("close-white")};a=Gr(E3i,a,void 0,this.qa());this.mb(a);this.Ic(a)};
p.Ic=function(a){jS.prototype.Ic.call(this,a);this.F.render(this.zb());a=this.F.La();gs(a,"Loading");bs(a,"status");ds(a,"live","polite")};p.Ja=function(){jS.prototype.Ja.call(this);T3i(this,!1);U3i(this,!1);this.O.Va(this.Da("addon-sidebar-close"));this.getHandler().Ue(this.O.La(),Hm,w(this.FOa,this)).listen(this.getElement(),"keyup",this.dhc);this.ea&&r2i(this)};p.zb=function(){return this.$a("addon-sidebar-content")};
function r2i(a){a.F.setVisible(!1);U3i(a,a.H);T3i(a,0==a.C.length);V3i(a,a.L);W3i(a);pd(a.C,function(b){var c=d8(b);b=new P3i(b,this.R,this.L,this.ma,this.qa());R3i(b,this.J[c]);this.Ia(b,!0);this.D[c]=b},a)}function W3i(a){fe(a.D,function(b){this.removeChild(b,!0);Xf(b)},a);pe(a.D)}function T3i(a,b){if(a.yb()){var c=a.Da("addon-sidebar-empty-caption");Q(c,b)}b&&U3i(a,!1)}
function U3i(a,b){if(a.yb()){var c=a.Da("addon-sidebar-introduction");b&&!pk(c)&&nk(c,1<a.C.length?"This template is optimized to work with these add-ons":"This template is optimized to work with this add-on");Q(c,b)}}function q2i(a){return 0==a.C.length?null:(a=J(a.C[0],16)||J(a.C[0],17))?km(new jm(a),"https").toString():null}
function V3i(a,b){if(a.yb()){os(a.getElement(),"addon-sidebar-with-banner",b);var c=a.Da("addon-sidebar-banner");b?(b=q2i(a))&&Er(c,F3i,{IGb:b,FGb:a.C[0].getName()}):ek(c)}}p.dMb=function(a,b){return Xd(a.getName(),b.getName())};p.dhc=function(a){27==a.keyCode&&(this.getElement()==a.target&&this.FOa(),a.stopPropagation())};p.FOa=function(){this.setVisible(!1);U3i(this,!1);this.H=!1;O("docs-focus-editor").kb()};p.Ug=m(!1);function X3i(a,b){uS.call(this,a,b)}v(X3i,uS);X3i.prototype.wm=function(){return O("macros-addon-sidebar-focus")};X3i.prototype.Bf=function(){return O("macros-addon-sidebar")};X3i.prototype.Wo=function(a){var b=this.fc;b.yb()||b.render();uS.prototype.Wo.call(this,a)};X3i.prototype.q$a=function(a){a&&this.Bf().isVisible()&&this.Wo(!0)};function Y3i(a,b,c){this.C=a;this.F=b;this.D=c;Object.defineProperties(this,{path:{get:w(this.ixb,this),set:w(this.hyc,this)},invoke:{get:w(this.HSb,this),set:w(this.eyc,this)},arity:{get:w(this.vNb,this),set:w(this.Nxc,this)}})}p=Y3i.prototype;p.ixb=g("C");p.hyc=ca("C");p.HSb=g("F");p.eyc=ca("F");p.vNb=g("D");p.Nxc=ca("D");function Z3i(a,b,c,d,e){S.call(this,e);this.L=a;this.D=b;this.J=c;this.C=d}v(Z3i,S);
Z3i.prototype.Ca=function(){var a=jd(A(),"docs-tfh"),b=this.L;a&&(b=Ke(b,{allow_parent:a}));a=PXa(this.qa());mf(a,b);a.width="100%";a.height="100%";a.marginWidth="0";a.marginHeight="0";a.scrolling="no";a.allow="accelerometer ambient-light-sensor autoplay camera encrypted-media fullscreen geolocation gyroscope magnetometer microphone midi payment picture-in-picture speaker usb vr".split(" ").map(function(c){return c+" *;"}).join(" ");this.mb(a);va("payload",this.D,a);va("adapter.hostFunctions",this.J,
a);Oa("adapter.getSessionId",w(this.H,this),a);Oa("adapter.getState",w(this.F,this),a)};Z3i.prototype.Ug=m(!1);Z3i.prototype.H=function(){var a=this.C().C;return null!==a?String(a):null};Z3i.prototype.F=function(){return this.C().getState()};function $3i(a,b,c,d,e,f,h,k,l){jw.call(this,void 0,void 0,l);var n=w(this.setVisible,this,!1),q=w(this.H,this),t=w(this.F,this);e&&this.setTitle(e);this.Jg=f||500;this.We=h||300;this.C=new Z3i(a,b,[new Y3i("google.script.host.close",n,0),new Y3i("google.script.host.closeDialog",n,0),new Y3i("google.script.host.editor.focus",w(d.Db,d,3),0),new Y3i("google.script.host.setWidth",q,1),new Y3i("google.script.host.setHeight",t,1)],c,l);this.Ia(this.C);Ns(this,!!k);Rs(this,null)}v($3i,jw);
$3i.prototype.H=function(a){!isFinite(a)||0>a||dr(this.zb(),Math.min(a,Math.floor(.8*Vj().width)))};$3i.prototype.F=function(a){!isFinite(a)||0>a||er(this.zb(),Math.min(a,Math.floor(.8*Vj().height)))};$3i.prototype.Ca=function(){jw.prototype.Ca.call(this);ks(this.getElement(),"script-app-dialog");var a=this.zb();ks(a,"script-app-contents");dr(a,Math.min(this.Jg,Math.floor(.8*Vj().width)));er(a,Math.min(this.We,Math.floor(.8*Vj().height)));this.C.render(a)};$3i.prototype.Ug=m(!1);function a4i(a){jS.call(this,a);this.C=this.D=this.F=this.H=null}v(a4i,jS);p=a4i.prototype;p.Dea=function(){this.C&&(this.removeChild(this.C,!0),this.C.dispose(),this.C=null);this.setVisible(!1)};p.focus=function(){this.C.getElement().focus()};p.zb=g("D");
p.Ca=function(){var a=this.qa(),b={id:this.getId(),Cs:"script-application-sidebar",Vkc:"script-application-sidebar-header",qba:"script-application-sidebar-title",zIb:"script-application-sidebar-close",YY:"script-application-sidebar-content",Iva:Wp("close-white")};b=Gr(i3i,b,void 0,a);this.mb(b);this.H=a.$a("script-application-sidebar-title",b);this.F=a.$a("script-application-sidebar-close",b);this.D=a.$a("script-application-sidebar-content",b)};
p.Ja=function(){jS.prototype.Ja.call(this);this.getHandler().Ue(this.F,Hm,w(this.Dea,this))};p.Ug=m(!1);p.Na=function(){delete this.H;delete this.F;delete this.D;delete this.C;jS.prototype.Na.call(this)};function b4i(a,b){uS.call(this,a,b)}v(b4i,uS);b4i.prototype.wm=function(){return O("macros-application-focus")};b4i.prototype.Bf=function(){return O("macros-application-sidebar")};function c4i(a,b){var c=null;c=c||zr("",{target:"_blank",height:500,width:600,top:(screen.height-500)/2,left:(screen.width-600)/2,scrollbars:!0});of(c.location,a);b!=za&&(a=new Zfc(function(){return c?c.closed:!0}),a.Ex=b,a.start(100,-1))};function d4i(a,b,c,d,e){jw.call(this,void 0,!0,c);this.H=a;this.F=d||za;Js(this,b);this.setVisible(!0);this.Bi=!0;Qs(this,!1);Rs(this,(new Os).mf(nYa,!0).mf(Vs,!1,!0));this.setTitle(e||"Authorization Required");ct(this,nYa.key)}v(d4i,jw);d4i.prototype.Ja=function(){jw.prototype.Ja.call(this);this.addEventListener("dialogselect",this.C)};d4i.prototype.Cd=function(){jw.prototype.Cd.call(this);this.removeEventListener("dialogselect",this.C)};
d4i.prototype.C=function(a){"cancel"!=a.key?c4i(this.H,this.F):this.F();this.setVisible(!1)};function e4i(a){jw.call(this,void 0,void 0,void 0);this.F=a;this.C=null;this.Bi=!0;this.setTitle("Message details");Rs(this,oYa())}v(e4i,jw);e4i.prototype.Ca=function(){jw.prototype.Ca.call(this);var a=this.zb();ks(a,"script-error-dialog-content");this.C=bk(this.F);a.appendChild(this.C)};e4i.prototype.Na=function(){jw.prototype.Na.call(this);this.C&&gk(this.C)};function f4i(a){B.call(this);this.C=a}v(f4i,B);function g4i(a,b){var c=ae("Running script ");c=Xj("SPAN",null,c);b=b?ev(c,"Cancel",b,"info",!0):dv(c,"info",!0);a.C.postMessage(b);return b.getId()}function h4i(a,b,c){var d=(c=void 0===c?null:c)?c:"Script "+(vf(b)+" experienced an error");b=Xj("SPAN","script-error-message",d);b.style.maxWidth="600px";a.C.postMessage(ev([b],"Details",function(){(new e4i(d)).setVisible(!0)},"warning",!0))}f4i.prototype.Na=function(){delete this.C};function i4i(){B.call(this);this.C=null;this.D=new Pm;this.oa(this.D)}v(i4i,B);i4i.prototype.Na=function(){j4i();k4i(this);B.prototype.Na.call(this)};function k4i(a){a.D.Qc();a.C&&(a.C.dispose(),a.C=null);j4i()}function j4i(){var a=Oj("docs-script-button-bar");a&&ek(a)};var l4i=new ZF(["http","https"]);function m4i(a){a=Bf(a);if($d(a)||be(a,'"'))return null;var b=Wl(1,a);return b?l4i.contains(b.toLowerCase())?a:null:null};function n4i(a,b,c,d,e,f,h){h=void 0===h?!1:h;jw.call(this);this.Ki=$d(Bf(b))?"You can find "+(a+" in the Add-ons menu."):b;this.ma=c;this.xa=d;this.H=m4i(e);this.ea=m4i(f);this.L=h;this.R=wr(this,o4i);this.C=yS("Learn more");this.Ia(this.C);this.F=new Uu("Report an issue");this.Ia(this.F);this.O=new Uu("View in store");this.Ia(this.O);this.setTitle(ae("Help for "+a));a=new Os;a.mf({key:Vs.key,caption:"Close"},!1,!0);Rs(this,a);ct(this,"ok")}v(n4i,jw);p=n4i.prototype;
p.Ca=function(){jw.prototype.Ca.call(this);var a=this.zb();Er(a,n3i,{description:this.Ki,ids:this.R,Emc:this.L});ks(a,"script-help-dialog")};
p.Ja=function(){jw.prototype.Ja.call(this);var a=this.qa().getElement(this.R.Bca);this.L?(this.F.render(a),this.getHandler().listen(this.F,"action",this.X1a),this.C.render(a),this.getHandler().listen(this.C,"action",this.GOa)):(this.H&&(this.C.render(a),this.getHandler().listen(this.C,"action",this.GOa)),this.F.render(a),this.getHandler().listen(this.F,"action",this.X1a),this.O.render(a),this.getHandler().listen(this.O,"action",this.Jjc))};
p.GOa=function(){this.L?zr("https://support.google.com/docs?p=GSM_migration"):this.H&&zr(this.H)};p.X1a=function(){this.ea?zr(this.ea):(this.ma(),this.dispose())};p.Jjc=function(){this.xa();this.dispose()};var o4i={Bca:"script-help-dialog-buttonbar"};function p4i(a,b,c,d){Cm.call(this,"Zl");this.title=d}v(p4i,Cm);function q4i(a,b,c,d,e,f){jw.call(this,void 0,void 0,f);this.H=b;this.F=d;this.L=e;this.C=null;this.setTitle(a);Ns(this,!0);a=new Os(f);for(b=0;b<c.length;++b)d=c[b],a.set(d,r4i[d]);a.D="0";Rs(this,a)}v(q4i,jw);p=q4i.prototype;p.Ca=function(){jw.prototype.Ca.call(this);var a=this.qa(),b=this.zb();ks(b,"script-prompt-contents");for(var c=a.Ca("DIV"),d=this.H.split("\n"),e=0;e<d.length;++e)0<e&&c.appendChild(a.Ca("BR")),c.appendChild(xk(a,d[e]));b.appendChild(c);this.F&&(this.C=a.Ca("INPUT"),b.appendChild(this.C))};
p.Ug=m(!1);p.Ja=function(){jw.prototype.Ja.call(this);this.getHandler().listen(this,"dialogselect",w(this.jxb,this))};p.focus=function(){jw.prototype.focus.call(this);this.C&&this.C.focus()};p.jxb=function(a){this.L(Number(a.key),this.F?this.C.value:null)};var r4i={1:"Ok",4:"Cancel",2:"Yes",3:"No"};function s4i(a,b){jw.call(this);this.H=a;this.F=b;Rs(this,(new Os).mf({key:"send",caption:"Send"},!0).mf({key:"cancel",caption:"Cancel"},!1,!0));this.setTitle("Report an issue");this.C=new Qu;this.Ia(this.C)}v(s4i,jw);p=s4i.prototype;p.Ca=function(){jw.prototype.Ca.call(this);ct(this,"send");var a=this.zb();ks(a,"script-reportissue-dialog-content");Er(a,o3i,{cMb:this.F})};
p.Ja=function(){jw.prototype.Ja.call(this);this.C.Va(this.Da("script-reportissue-dialog-nonanonymous-checkbox"));this.icb();var a=this.getHandler();a.listen(this.Da("script-reportissue-dialog-description"),"input",this.icb);a.listen(this,"dialogselect",this.kxb)};p.Od=function(){return this.Da("script-reportissue-dialog-description").value};p.icb=function(){var a=!$d(this.Od());Ts(this.D,"send",a)};p.kxb=function(a){if("send"!=a.key)return!0;this.H(this.Od(),this.C.isChecked());return!0};function t4i(a,b){B.call(this);this.D={};this.F={};this.L=0;this.J=b;this.C=a;this.C.wK(w(this.lxb,this))}v(t4i,B);p=t4i.prototype;p.connect=function(a){this.C.isConnected();this.C.connect(a)};p.isConnected=function(){return this.C.isConnected()};p.R9b=function(a,b){var c=u4i(this,b[0]),d=u4i(this,b[1]);b=Jd(b,2);try{var e=a.apply(this,b);"function"===typeof e?e(c,d):c.call(this,e)}catch(f){d.call(this,null)}};
p.lxb=function(a,b){if(Ud(a,"callback.")&&me(this.D,a)){var c=sfa(this.D,a);b=null!=b?JSON.parse(b):null;var d=this.F[a];d&&(qe(this.D,d),qe(this.F,a),qe(this.F,d));qe(this.D,a);c.call(this,b)}};function u4i(a,b){return w(function(c){c=null!=c?kn(c):null;this.C.send(b,c)},a)}p.Na=function(){B.prototype.Na.call(this);delete this.J;delete this.D;delete this.F;delete this.L;delete this.C};function v4i(a,b,c,d){c=new rC({role:0,ph:c,cn:"ide.api.ch",tp:1});c.pz=b;t4i.call(this,c,d||5E3);this.H=a;a=w(this.O,this);this.C.zf("method.getContainerInfo",w(this.R9b,this,a),!0)}v(v4i,t4i);v4i.prototype.O=function(){return k0e(this.H.call())};v4i.prototype.Na=function(){var a=this.C;t4i.prototype.Na.call(this);a.dispose();delete this.H};function w4i(a,b,c,d,e){B.call(this);this.H=a;this.L=b;this.R=c;this.F=d||null;this.J=e||null;this.C=this.D=null}v(w4i,B);w4i.prototype.open=function(){if(this.F){if(this.F.closed){this.F=null;return}this.D=this.F;this.F=null;of(this.D.location,this.H)}else this.D=zr(this.H,{target:this.L});if(this.J)try{this.C=new v4i(this.J,this.D,this.R),this.C.connect(),mn(w(this.O,this,!0),1E5)}catch(a){this.C=null}};
w4i.prototype.O=function(a){try{!this.C||a&&this.C.isConnected()||(this.C.dispose(),this.C=null)}catch(b){this.C=null}};w4i.prototype.close=function(){this.O();this.D&&!this.D.closed&&(this.D.close(),this.D=null)};w4i.prototype.Na=function(){B.prototype.Na.call(this);this.C&&this.C.dispose();delete this.F;delete this.D;delete this.C;delete this.H;delete this.L};function x4i(a,b,c,d,e,f,h,k,l){Lm.call(this);this.R=[];this.Ha=!!k;this.F=a;this.O=b;this.oa(this.O);this.Ea=new i4i;this.oa(this.Ea);this.C=new f4i(bv.getInstance());this.oa(this.C);this.D=null;this.xa=new b4i(new a4i,l);this.ea=null;e&&(this.ea=new X3i(new S3i(f,h),l));this.H=new u3i(void 0,k);this.H.Wd(this);this.oa(this.H);this.F.Zg(this.H);this.ma=c;this.Aa=d;this.L=this.J=null}v(x4i,Lm);function g2i(a){return a.ea?a.ea.fc:null}p=x4i.prototype;p.qc=g("Ha");
function y4i(a,b){if(null==b)a.H.reset(0);else{var c=a.H;c.reset(2);for(var d=0;d<b.length;d++)for(var e=b[d],f=Oi(e,J1i,4),h=0;h<f.length;h++){var k=f[h];k=new t3i(e.getId(),e.getName(),k.getName());c.Ia(k,!0)}0===c.jc()&&c.reset(1);a.H.isVisible()&&a.H.focus()}}function z4i(a,b){var c=Oj("docs-script-button-bar");c&&(ek(c),$d(Bf(a))||(a=new Uu(a),a.Ob("docs-titlebar-button"),a.render(c),Fm(a,"action",b)))}
function h2i(a,b,c){a.L&&!a.L.isDisposed()&&(kw(a.F,a.L),a.L.dispose());a.L=new s4i(b,c);a.L.Bi=!0;a.F.Zg(a.L);a.L.setVisible(!0)}
p.vzc=function(a,b,c){var d=this.F,e=c||null;c="<p>";var f="Thanks! Your feedback was sent to the creators of <strong>"+(Jr(a)+"</strong>.");c=c+f+"</p>";e&&(c+="<p>",b?(a="You might not receive an individual reply, but if you'd like to learn more, check out <a href=\""+(U(Sr(e))+'" target="_blank">'+(Jr(a)+" help</a>.")),c+=a):(a="You won't receive an individual reply, but if you'd like to learn more, check out <a href=\""+(U(Sr(e))+'" target="_blank">'+(Jr(a)+" help</a>.")),c+=a),c+="</p>");c=T(c);
M_e(d,"Report an issue",Dr(c),void 0,void 0,"Close")};p.uzc=function(){M_e(this.F,"Report an issue","We're sorry, but we encountered an error sending your issue report. Please try again later.",void 0,void 0,"Close")};function f2i(a){a.dispatchEvent("bm")&&(a=a.Aa,a.C.isVisible()&&a.C.hide(),a.D.yb()||a.D.render(a.F||void 0),a.D.show())}p.uO=function(){this.dispatchEvent("Yl")&&this.Aa.D.hide()};p.nuc=function(a,b,c,d,e){a=new w4i(a,"MacroService"+Jha(c),b,e,d);this.R.push(a);a.open()};p.i1=function(a){zr(a)};
p.Na=function(){Lm.prototype.Na.call(this);Yf(this.R)};function A4i(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E,L,P,R,da){u=void 0===u?!1:u;z=void 0===z?null:z;P=void 0===P?!1:P;B.call(this);this.L=a;this.R=l;this.Sa=k;this.Aa=n;this.O=b;this.xa=c;this.J=d;this.D=L;this.H=new Pm(this);this.oa(this.H);this.Qa=q;this.Ra=z;this.ma=new f3i(this.xa,this.J);this.oa(this.ma);this.Pa=P;a=this.Aa;c=this.Pa;u=void 0===u?!1:u;this.C=new x4i(e,h,q,t,B4i(a),c,a,u,E);this.oa(this.C);this.Ha=new G1i;h=0;b.D?b.C&&(h=2):h=1;this.F=new X1i(this.Aa,e,f,this.C,this.Ha,this.L,this.xa,
this.R,h,this.D,R,da);this.oa(this.F);this.Ea={};this.ea=this.Ma=null}v(A4i,B);p=A4i.prototype;
p.start=function(){if(ao(this.L.F,1,1)){this.H.listen(this.J,j1i,w(this.mxb,this));this.H.listen(this.J,a3i,w(this.txb,this));this.H.listen(this.J,d3i,w(this.uxb,this));this.H.listen(this.J,Y2i,w(this.sxb,this));this.H.listen(this.J,R2i,w(this.qxb,this));this.H.listen(this.J,U2i,w(this.rxb,this));this.H.listen(this.J,B2i,w(this.oxb,this));this.H.listen(this.J,F2i,w(this.pxb,this));this.H.listen(this.C,"dialogselect",w(this.L4b,this));this.H.listen(BH.getInstance(),"Uc",w(this.nxb,this));this.Sa(w(this.H4b,
this));var a=this.L.C;O("macros-exec").Ab(Ap,this.C4b,this);O("macros-resume").Ab(Ap,this.tec,this);O("macros-manage").Ab(Ap,w(a.Ts,a,w(this.r9b,this)));O("macros-editor").Ab(Ap,this.OAa,this);O("macros-extensions").Ab(Ap,w(this.F0a,this));O("macros-manage-extensions").Ab(Ap,w(this.q9b,this));O("macros-extension-menu-promo").Ab(Ap,w(this.F0a,this));O("macros-extension-disabled").Ab(Ap,this.S2b,this);O("macros-extension-help").Ab(Ap,this.T4b,this);O("macros-extension-install-start").Ab(Ap,this.a8b,
this);O("macros-trigger-0").Ab(Ap,w(this.WE,this,"0"));O("macros-trigger-1").Ab(Ap,w(this.WE,this,"1"));O("macros-trigger-2").Ab(Ap,w(this.WE,this,"2"));O("macros-trigger-3").Ab(Ap,w(this.WE,this,"3"));O("macros-trigger-4").Ab(Ap,w(this.WE,this,"4"));O("macros-trigger-5").Ab(Ap,w(this.WE,this,"5"));O("macros-trigger-6").Ab(Ap,w(this.WE,this,"6"));O("macros-trigger-7").Ab(Ap,w(this.WE,this,"7"));O("macros-trigger-8").Ab(Ap,w(this.WE,this,"8"));O("macros-trigger-9").Ab(Ap,w(this.WE,this,"9"));this.ma.start();
C4i(this.Aa,this.Pa)&&(O("macros-addon-sidebar-focus").Oa(!0),O("macros-addon-sidebar-focus").kb(void 0,v1i(19)));x3i(new w3i(this.O,this.F));a=this.O.O;var b=!this.O.C,c=this.xa,d=this.R().getState()||void 0;d=["ruid",Ha({}),c.C.C,c.D,c.C.D,d];b||d.push("addon_safe_mode",!0);a&&d.push("addon_dry_run",a);cp(ep(e8(c,c.C.Ha),"POST").setContent(""),d).Fr().Qe()}};
function D4i(a){y4i(a.C,null);var b=w(function(c){c.qr()?y4i(this.C,Oi(c,L1i,2)):(this.C.C.C.postMessage(dv("Could not load scripts.","warning",!0)),y4i(this.C,[]))},a);U1i(a.xa,b)}
function E4i(a,b,c,d,e,f){if(d){f2i(a.C);var h=w(function(){var t=s2i(this.F,b);t&&!vi(t,4)&&(K(t,4,!0),i2i(this.F))},a);var k=w(function(){this.C.uO();this.L.Sp.dispatchEvent(new yn(!0))},a);var l=w(function(t){this.C.uO();8!=t.vF()&&h4i(this.C.C,c,t.getMessage())},a);e2i(a.F)}else{var n=g4i(a.C.C),q=w(function(t){this.ma.F.cancel(t);cv(this.C.C.C,n)},a);h=w(function(t){cv(this.C.C.C,n);n=g4i(this.C.C,Ia(q,t))},a);k=w(function(t){cv(this.C.C.C,n);if(t.y7()){t=this.C.C;var u=ae("Canceled script ");
t.C.postMessage(dv(u,"info",!1,2500))}else t=this.C.C,u=ae("Finished script "),t.C.postMessage(dv(u,"info",!1,2500));this.L.Sp.dispatchEvent(new yn(!0))},a);l=w(function(t){cv(this.C.C.C,n);8!=t.vF()&&h4i(this.C.C,c,t.getMessage())},a)}a.Qa.Db(3);rse(a.L.C,w(a.Qwc,a,b,c,h,k,l,d,e,f))}p.Qwc=function(a,b,c,d,e,f,h,k){var l=this.R().getState()||void 0,n=this.ma;c=void 0===c?za:c;d=void 0===d?za:d;e=void 0===e?za:e;e=w(n.exb,n,a,b,c,d,e);n.F.M3a(a,b,l,e,f,h,k)};
p.nxb=function(a){var b=Hd(this.F.D),c={};b=ha(b);for(var d=b.next();!d.done;d=b.next())d=d.value,c["ADD-ON:"+d8(d)]={name:d.getName(),"cws-id":J(d,1),"gsm-application-id":J(d,18),"app-key":d8(d)};ve(a.nB,c)};p.S2b=function(a){a.data==this.Ma&&(a=this.C,a.dispatchEvent("Xl")&&a.xa.fc.Dea())};
p.mxb=function(a){a=a.C().Bb();var b={},c=F4i(this,a);if(1==xi(a,11,0)){var d=J(a,4);d=s2i(this.F,d)}else d=void 0;var e=d,f=e&&(vi(e,10)||vi(e,9))||!1,h=e&&vi(e,19)||!1;d=this.Ha;var k=c,l=J(a,4),n=1==xi(a,11,0);f=new E1i(a,k,n,f,h);f.setVisible(!0);0==xi(a,11,0)&&(l=f.getLabel());d.C[xi(a,11,0)][l]=f;d.dispatchEvent("am");(d=g2i(this.C))&&J(a,9)&&(1==J(a,12)||5==J(a,12))&&(l=J(a,4),d.J[l]=a,l&&l in d.D&&R3i(d.D[l],a));c=c.reverse();if(d=this.C.O){for(l=0;l<c.length;l++)if(f=c[l],h=f.getKey())if(b[h])Fi(f,
5);else{if(this.Ea[h])for(k="Ctrl+Alt+Shift+"+h.toUpperCase(),k=Cu(O("macros-exec"),[k]),n=0;n<d.ma.length;n++){var q=d.ma[n];pk(q)==k&&nk(q,"")}this.Ea[h]=f.Ie();b[h]=!0}if(1==xi(a,11,0)){b=null!=e?e:null;c=[];e=J(a,4);f=!!J(a,9)&&3!=J(a,12);l=d.C.F.get(e);l||(l=new au(""),l.wc(e),h=J(a,10),l.setContent(bk(h)),l.Oa(2==d.R?!1:f&&1==d.R?!1:!0),d.J.Qc(),l2i(d.C,l),m2i(d));f||d.ea.push(e);f=new Vt;!b||vi(b,10)||vi(b,9)||vi(b,19)||(n2i(d,f,b),h=new e1i,k=String(Ha(h)),K(h,1,k),f.Ia(D3i(d,h,c),!0));h=
b&&(vi(b,10)||vi(b,9))||!1;if(!b||h||!vi(b,19))for(a=a.uh(),h=0;h<a.length;++h)f.Ia(D3i(d,a[h],c,void 0,b?b:void 0),!0);b&&o2i(d,f,e,c,b);d.xa[e]=c;l.ue(f);p2i(f.La(),!0);l.dispatchEvent("load");d.Ha.push(e)}else{b=a.Pg();if(d.WA(b)){d.WA(b);c=d.H[b];delete d.H[b];d.D.removeChild(c,!0);if(d.L)for(e=d.Aa[b],l=0;l<e.length;++l)d.L.yR(e[l]);delete d.Aa[b];c.dispose()}10<=je(d.H)||(b=[],a.uh(),c=a.Pg(),a=D3i(d,a,b,"Ctrl+Alt+Shift+").Bb(),p2i(a.La(),!1),a=new lv(c,a,A3i.getInstance(),void 0,!0),e=d.D.jc()?
d.D.jc()-1:0,d.D.Af(a,e,!0),d.H[c]=a,d.Aa[c]=b)}}};p.txb=function(a){a=a.C();var b=a.Pg();b?z4i(b,w(function(c){var d=Bf(c.getUrl());$d(d)||this.C.i1(d);d=Bf(c.getFunctionName());$d(d)||E4i(this,J(c,1),d,J(c,4)||void 0,void 0,c.Zq()||void 0)},this,a)):j4i()};
p.uxb=function(a){var b=a.C();a=b.getText();b=b.nk();var c=this.C.Ea,d=Oj("docs-script-button-bar");d&&(k4i(c),$d(Bf(a))||(a=Gr(j3i,{caption:a}),dk(d,a),$d(Bf(b))||(c.C=new It,c.C.Ob("docs-script-button-bar-bubble"),c.C.setContent(Gr(k3i,{text:b})),c.C.wi(a),Jt(c.C,!0),c.C.fC=!1,c.C.setPosition(1,1),c.C.jo(!1),c.C.render(d),c.D.listen(a,"mouseover",w(c.C.setVisible,c.C,!0)).listen(a,"mouseout",w(c.C.setVisible,c.C,!1)))))};
p.sxb=function(a){this.C.uO();var b=a.C(),c=Bi(b,6,!1);a=c?J(b,3).replace(/\n/g," ").replace(/\\n/g,"\n"):J(b,3);var d=J(b,7),e=this.C,f=b.getTitle(),h=J(b,4),k=Bi(b,5,!1);b=w(this.Wcc,this,J(b,1),c,d);e.D&&(e.D.setVisible(!1),kw(e.F,e.D));e.D=new q4i(f,a,h,k,b);e.D.Bi=!0;e.F.Zg(e.D);e.D.setVisible(!0)};p.Wcc=function(a,b,c,d,e){var f=new C2i;K(f,1,d);K(f,3,b);K(f,4,c);null!==e&&K(f,2,e);O("macros-resume").kb([a,kn(f.Gb())])};
p.qxb=function(a){a=a.C();var b=Tye(M(a,DS,9));var c={};c.mid=this.O.L;b=Ke(b,c);switch(a.Tk()){case 1:var d=this.C;c=J(a,3);var e=this.R,f=a.getTitle()||void 0;if(d.dispatchEvent(new p4i(b,c,e,f))){var h=d.ma;d=d.xa.fc;d.yb()||(d.render(),d.resize());d.Dea();var k=d.qa();k.Ee(d.H,f||"Apps Script application");f=w(h.Db,h,3);d.C=new Z3i(b,c,[new Y3i("google.script.host.close",w(d.Dea,d),0),new Y3i("google.script.host.editor.focus",f,0)],e,k);Zf(d.C,f);d.Ia(d.C,!0);O("macros-application-focus").kb()}this.Ma=
J(a,7)||null;break;default:c=this.C,e=J(a,3),f=this.R,h=a.getTitle()||void 0,d=a.getWidth()||void 0,k=a.getHeight()||void 0,a=Bi(a,8,!1),c.D&&(c.D.setVisible(!1),kw(c.F,c.D)),c.D=new $3i(b,e,f,c.ma,h,d,k,a),c.D.Bi=!0,c.F.Zg(c.D),c.D.setVisible(!0)}};p.rxb=function(a){a=a.C();var b=a.getType();this.Ra(b,a.getText(),a.getTitle()||void 0,J(a,4)||void 0)};
p.oxb=function(a){if(et().C){if(!this.ea||this.ea.isDisposed()){a=Lj();var b=tk(a,"docs-hub-open-external-appbarbutton");this.ea=new lwd(b,a,"A script attached to this file needs your permission to run. To give permission, open in a new tab and rerun the script.","Authorization required");this.oa(this.ea);sr(this.ea,b)}}else a=a.C(),(b=M(a,x2i,3))&&(si(b,2)||si(b,11))?(b=new m1i(J(b,2),J(b,11)),vi(a,4)?(b=this.F.getExtension(b),null!=b&&vi(b,10)?(b="The add-on "+(b.getName()+" needs your permission to run in this document."),
a=a.getUrl(),new d4i(a,(new ox).format(""),void 0,void 0,b)):(a=a.getUrl(),new d4i(a,(new ox).format("A script attached to this document needs your permission to run."),void 0,void 0,"Updated add-on"))):this.F.PV(b)):(a=a.getUrl(),new d4i(a,(new ox).format("A script attached to this document needs your permission to run."),void 0,void 0,void 0))};p.pxb=function(a){a=a.C();E4i(this,J(a,1),a.getFunctionName(),J(a,4)||void 0,void 0,a.Zq()||void 0)};
p.C4b=function(a){a=a.data;var b=s2i(this.F,a.C);!b||vi(b,9)?E4i(this,a.C,a.functionName,a.F||void 0,1,a.D||void 0):this.F.PV(o1i(b))};p.tec=function(a){f2i(this.C);var b=a.data;a=b[0];b=b[1];var c=w(function(){this.C.C.C.postMessage(dv("Error resuming script execution","warning",!0))},this);g3i(this.ma,a,b,c)};p.r9b=function(){this.C.H.setVisible(!0);D4i(this)};
p.OAa=function(a){var b=a.data;a=b?b.scriptId:void 0;a=new jm(u2i(this.O,a?a:void 0));b&&(a=b.editorUri?new jm(b.editorUri):a,b.filename&&a.zc("f",b.filename),b.lineNumber&&(a.zc("l",b.lineNumber),a.zc("s",b.lineNumber)));b=this.L.D;var c=null;Ho(this.L.C)||(c=Wke("Loading\u2026",{target:"MacroService"+Jha(b)}));this.L.C.Ts(w(this.C.nuc,this.C,a.toString(),this.O.F,b,this.R,c))};p.F0a=function(){this.F.PV()};
p.q9b=function(a){if(a.data)this.F.PV(a.data);else{a=this.F;var b=d2i(a,!0),c=a.R;var d=c.F;b=A1i(d,d.D,b,void 0,!0);d=B1i(d,b);c.C=d;d=c.C;c.D.Zg(d);d.setVisible(!0);e2i(a)}};
p.T4b=function(a){var b=this.F,c=s2i(b,a.data);if(c){var d=o1i(c);a=w(b.z8a,b,d,d8(c),c.getName(),J(c,6)||void 0,J(c,11)||void 0);d=w(b.PV,b,d);var e=vi(c,19)||void 0,f=b.C,h=c.getName(),k=Bf(J(c,7)),l=J(c,6)||void 0;c=J(c,11)||void 0;e=void 0===e?!1:e;f.J&&!f.J.isDisposed()&&(kw(f.F,f.J),f.J.dispose());f.J=new n4i(h,k,a,d,l,c,e);f.J.Bi=!0;f.F.Zg(f.J);f.J.setVisible(!0);e2i(b)}};
p.a8b=function(a){if(a.data){var b=s2i(this.F,a.data);if(null!=b)if(a=this.F,b=o1i(b),a.H){a:{if(1==a.H)b="Add-ons aren't allowed in your domain. Talk to your domain administrator for more information.";else if(2==a.H)b="Add-ons aren't allowed while in safe mode.";else break a;M_e(a.ea,"Oops",b,void 0,void 0,"Close")}i2i(a)}else{var c=a.getExtension(b);c&&vi(c,9)?(b=a.getExtension(b).getName(),b=ae(b+" is already installed"),a.C.C.C.postMessage(dv(b,"info",!1,2500)),i2i(a)):a.PV(b)}}};
p.L4b=function(a){"edit"==a.key?(a=a.target.Ms.rf(),a=u2i(this.O,a?a.A4a:void 0),this.OAa(new Bp({editorUri:a}))):"new"==a.key?this.OAa(new Bp({editorUri:this.O.ea})):"reload"==a.key?D4i(this):"run"==a.key&&(a=a.target.Ms.rf(),E4i(this,a.A4a,a.getFunctionName(),void 0,void 0,a.Zq()))};p.WE=function(a){(a=this.Ea[a])&&(a=C3i(this.C.O,a))&&a.isEnabled()&&a.dispatchEvent("action")};p.H4b=function(){for(var a=this.C,b=0;b<a.R.length;b++){var c=a.R[b];c.close();c.dispose()}a.R=[]};
function F4i(a,b){var c=[];J(b,3)&&c.push(b);b=b.uh();for(var d=0;d<b.length;d++)c=c.concat(F4i(a,b[d]));return c}p.getView=g("C");function B4i(a){return a==(av(),Yu)||a==(av(),$u)||a==(av(),Zu)}function C4i(a,b){return b&&(a==(av(),Yu)||a==(av(),Zu))};function G4i(a,b,c,d,e,f,h){B.call(this);var k=this;this.C=a;this.L=b;this.eb=e;this.F=d;this.ma=new Nm;this.D=f;this.xa=h;this.R=new Du(this);this.oa(this.R);this.R.Ab(Mlb,wp,this.J);this.ea=new Pm(this);this.oa(this.ea);this.ma.wb(this.F.F,function(){return k.J()});this.H=new t3a(this.eb.Lb(),!0);this.oa(this.H);this.O={};this.J()}v(G4i,B);G4i.prototype.J=function(){var a=H4i(this),b=this.L.Bb(gA.getId(),!0);b.od(!0);uv(this.L,b,[new pSe(a,this.C)]);ks(b.getElement(),"waffle-action-menu")};
function H4i(a){var b=Array.from(a.F.C.values());q0i(b,function(t){return ph(t,8)});var c=Array.from(a.F.D.values());Mv(a.xa,eid(0<b.length,0<c.length));fA.setProperty("visible",!0);eA.setProperty("visible",!0);var d={};c={};b=ha(b);for(var e=b.next();!e.done;c={Upa:c.Upa},e=b.next()){e=e.value;var f=ph(e,1),h=e.getFunctionName(),k=ph(e,8),l=lh(e,9)?ph(e,9):null,n="recorded-action-"+f+":"+h,q=a.C.Ne(n);q||(q=(new Yp(n)).enabled(!0),q.Ga(29583),q=q.build(),c.Upa=new d1i(f,h,void 0,void 0,void 0,lh(e,
12)?e.Zq():void 0),q.Ab(Ap,function(t){return function(){a.C.Fa("macros-exec").kb(t.Upa)}}(c)),V2a(a.H,[q]),a.C.Bm(q),a.D&&a.D.Yh(q));q.setProperty("label",k);I4i(a,l)&&q.setProperty("keys",[l]);null==l&&null!=q.getProperty("keys")&&q.setProperty("keys",null);d[n]=q}fe(a.O,function(t,u){d[u]||(t.setProperty("keys",null),a.C.tP(u),a.D&&a.D.yR(u),Xf(t))});a.O=d;return ke(d)}function I4i(a,b){return!Mlb.wd()&&null!=b&&/^Ctrl\+Alt\+Shift\+\d$/i.test(b)&&0==(a.H.C[jc(b)]||[]).length};function J4i(a,b){this.qGa=a;this.noa=b};function K4i(){var a='<div class="waffle-recording-toast" role="complementary" tabIndex="0" aria-describedby="waffle-recording-toast-content"><div class="waffle-recording-toast-top"><div class="waffle-recording-toast-icon"><div class="waffle-recording-toast-outer-circle"><div class="waffle-recording-toast-inner-circle"></div></div></div><div class="waffle-recording-toast-content"><div class="waffle-recording-toast-new-content"></div><div class="waffle-recording-toast-default-content">Recording new macro\u2026</div></div><div class="waffle-recording-toast-right"><div class="waffle-recording-toast-cancel">Cancel</div><div class="waffle-recording-toast-stop">Save</div><div class="waffle-recording-toast-expand-section"><div class="waffle-recording-toast-expand"><div class="waffle-recording-toast-expand-icon"></div></div></div></div></div><div class="waffle-recording-toast-bottom" role="radiogroup"><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-absolute">'+
XO(void 0,void 0,void 0,void 0,void 0,Or('Use absolute references<div class="waffle-recording-toast-label-description">When applying macro use exact location as recorded</div>'));a=a+'</div></div><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-relative">'+XO(void 0,void 0,void 0,void 0,void 0,Or('Use relative references<div class="waffle-recording-toast-label-description">When applying macro use active selection</div>'));return T(a+"</div></div></div></div>")}
;function L4i(a,b){S.call(this,b);this.R=a;this.J=new Mt("",new rw,this.qa());this.Ia(this.J);this.F=new Mt("",new rw,this.qa());this.Ia(this.F);this.D=new Fu;this.oa(this.D);this.H=null;this.C=0}v(L4i,S);p=L4i.prototype;p.Ca=function(){this.mb(Gr(K4i))};
p.Ja=function(){S.prototype.Ja.call(this);this.O=new VV(this.qa(),void 0,"relative");this.L=new VV(this.qa(),void 0,"absolute");this.O.Va(this.Da("waffle-recording-toast-relative"));this.L.Va(this.Da("waffle-recording-toast-absolute"));var a=se(Iu);re(a,"selected",!0);var b=tq(new sq,6).build();Hu(this.D,this.O,iA,a,void 0,b);Hu(this.D,this.L,jA,a,void 0,b);Hu(this.D,this.J,this.R.Fa("recorded-action-stop"),void 0,void 0,b);Hu(this.D,this.F,dA,void 0,void 0,b);this.H=new GJ(this.Da("waffle-recording-toast-expand"),
this.Da("waffle-recording-toast-bottom"),Olb.isVisible(),void 0,this.qa());this.oa(this.H);this.getHandler().listen(this.H,"toggle",this.Hdc);this.J.Va(this.Da("waffle-recording-toast-stop"));this.F.Va(this.Da("waffle-recording-toast-cancel"))};p.setVisible=function(a){var b=this.La();Q(b,a);ds(b,"hidden",!a);a&&(a=this.qa().Lb(),a=Wj(a)||window,b=fr(this.La()),this.La().style.left=Math.max(Math.floor(Vj(a).width/2-b.width/2),0)+"px")};
function M4i(a,b){a.Da("waffle-recording-toast-default-content").style.opacity=0;var c=a.Da("waffle-recording-toast-new-content");a.qa().Ee(c,b);0!=a.C?N4i(a):(nn(a.C),a.C=mn(function(){return N4i(a)},400))}function N4i(a){var b=a.Da("waffle-recording-toast-new-content");ms(b,"waffle-recording-toast-slide-in");nn(a.C);a.C=mn(function(){ks(b,"waffle-recording-toast-slide-in");nn(a.C);a.C=mn(function(){return O4i(a)},2200)})}
function O4i(a){var b=a.Da("waffle-recording-toast-default-content"),c=a.Da("waffle-recording-toast-new-content");ms(c,"waffle-recording-toast-slide-in");b.style.opacity=1;nn(a.C);a.C=mn(function(){a.C=0},400)}p.Hdc=function(a){Olb.setVisible(a.OI)};p.Na=function(){nn(this.C);S.prototype.Na.call(this)};function P4i(a,b,c,d,e){B.call(this);var f=this;this.L=a;this.J=c;this.D=d;this.C=N().PWb()(N().fu()(),N().nVb()(),f8(this),iA.wd(),function(h){h="Action "+(N().OWb()(f.C)+(": "+h));Q4i(f,h)},N().yZa()());N().PZa()(this.C);this.H=new L4i(e);this.oa(this.H);this.Ea=new Du(this);this.oa(this.Ea);this.Ea.Ab(iA,Ap,this.Ejc,this).Ab(jA,Ap,this.Djc,this).Ab(O("docs-doc-copy-made"),Ap,this.i3b,this).Ab(O("macros-exec"),Ap,this.Qec,this).Ab(Agb,Ap,function(h){return R4i(f,h.data,2)},this).Ab(Ggb,Ap,function(h){return R4i(f,
h.data,3)},this).Ab(zgb,Ap,function(h){return R4i(f,h.data,1)},this).Ab(Bgb,Ap,function(h){return R4i(f,h.data,5)},this).Ab(whb,Ap,function(h){return R4i(f,h.data,4)},this).Ab(Sx,Ap,function(h){h=h.data;switch(h.F){case "all-objects-for-all-datasources":N().EWb()(f.C,f8(f));break;case "all-objects-for-single-datasource":N().FWb()(f.C,f8(f),h.D);break;case "specific-ids":var k=h.C;if(!(0<(y(A(),"feds")?N().vya()(k):[]).length)){var l=h.C[0];h=N().uF()(l);k=null;switch(h){case 4:k=S4i(f,l,!1);break;
case 1:case 3:case 5:(l=N().bXa()(l,KU(f.J)))&&0<l.length&&(k=fo(l[0]),k=qo(po(oo(io(),k.gb()),k.Pb()),k.Mb()).build(),l=t0i(),3==h?(u0i(l),Fh(l,6,k)):1==h?(u0i(l),Fh(l,5,k)):5==h&&(u0i(l),Fh(l,4,k)),k=l.build().qb());break;case 2:(l=N().aXa()(l))&&0<l.length&&(k=s0i(l[0]).build().qb())}k&&N().TZa()(f.C,f8(f),h,k)}}}).Ab(Lgb,Ap,function(){return N().GWb()(f.C,f8(f),!1)},this).Ab(ygb,Ap,this.E1b,this).Ab(Cgb,Ap,function(h){return N().AWb()(f.C,f8(f),h.data.qb())},this);this.F=new Nm;this.oa(this.F);
this.F.wb(a.bb,function(){N().UWb()(f.C,!0,f8(f))});this.F.wb(a.ma,function(h){if(h.D){var k=h.C.D();"docs-edit"==k?"ritz-waffle"==h.C.C&&N().RWb()(f.C,f8(f)):"docs-undo"==k?(Q4i(f,"Undo previous action"),N().VWb()(f.C)):"docs-redo"==k&&(Q4i(f,"Redo previous action"),N().SWb()(f.C))}});this.F.wb(b.xa,function(h){h.C||N().LWb()(f.C,f8(f),h.D)});this.F.wb(this.D.Eb,function(h){return T4i(f,h)});this.F.wb(this.D.Kc,function(){f.ma=f8(f)});this.F.wb(this.D.Mc,function(h){switch(h.D){case "find-next-occurrence":N().BWb()(f.C,
f.ma,f8(f),h.C.qb());break;case "replace-current-occurrence":N().HWb()(f.C,f8(f),h.C.qb())}f.ma=null});this.F.wb(this.D.bb.D,function(h){N().KWb()(f.C,f8(f),h.F,h.H,h.J,h.L,h.id,h.C,h.D)});this.F.wb(b.Sp,function(){N().yWb()(f.C,f.Aa,f8(f),f.xa);f.Aa=null;f.xa=null});this.F.wb(this.D.Wc,function(h){N().zWb()(f.C,f.O.D.C.qb(),h.getSelection().C.qb(),f.O.C.qb());f.O=null});this.ea=new Pm(this);this.oa(this.ea);this.O=this.ma=this.xa=this.Aa=this.R=null;this.ea.listen(this.D.C,"na",this.wxb).listen(this.D.C,
"ta",this.vxb);this.H.render();this.H.setVisible(!0);U4i(this);setTimeout(function(){return NG("All actions are now being recorded. Please use the Tools menu to cancel or save recording.")})}v(P4i,B);p=P4i.prototype;p.vxb=function(){this.R=f8(this)};p.wxb=function(a){!a.mG&&jJ(this.D)&&(void 0!==a.uY?(a=a.uY,N().MWb()(this.C,this.R,f8(this),a)):(a=this.D.C.C.Ud(),M4i(this.H,"Activating sheet "+a),N().NWb()(this.C,this.R,f8(this),a)),this.R=null)};
function Q4i(a,b){M4i(a.H,b);NG("Macro recorder "+b)}function V4i(a){return N().QWb()(a.C,f8(a))}p.Qec=function(a){this.xa=a.data.functionName;this.Aa=f8(this)};function T4i(a,b){var c=f8(a);a.ea.Nc(a.D,"dc",function(){var d=f8(a);switch(b.H){case "adjust-next-data-region-edge":N().xWb()(a.C,c,d,b.D,b.C);break;case "move-next-data-region-edge":N().DWb()(a.C,c,d,b.D,b.C);break;case "select-all":N().IWb()(a.C,c,d);break;case "select-rows-columns":N().JWb()(a.C,c,d,"c"==b.F)}})}
p.i3b=function(a){a=a.data;N().CWb()(this.C,f8(this),a.C)};p.E1b=function(a){a=a.data;var b=this.L.C.getSelection();this.O=new W4i(a,b)};
function R4i(a,b,c){var d=N().TZa(),e=a.C,f=f8(a);a:switch(c){case 4:b=S4i(a,b,!0);break a;case 3:case 1:case 5:var h=qJ(a.J);h?(a=uo(a.L.C.getSelection()),X4i(b,a,h)?b=null:(a=GEc(h),X4i(b,a,h)?(b=iG(h.Ta().Yf(a.y,a.x)),b=null!=b?b:qo(po(oo(io(),h.O.C.C.gb()),a.y),a.x).build(),h=t0i(),3==c?(u0i(h),Fh(h,6,b)):1==c?(u0i(h),Fh(h,5,b)):5==c&&(u0i(h),Fh(h,4,b)),b=h.build().qb()):b=null)):b=null;break a;case 2:if(h=qJ(a.J)){a=a.L.C.getSelection();var k=H6e(h);b=k&&qh(a.C,6).Gb().includes(k)?null:(a=F6e(h))&&
b==G6e(h)?s0i(a).build().qb():null}else b=null;break a;default:b=null}d(e,f,c,b)}function X4i(a,b,c){if(!b)return!1;b=c.Ta().Yf(b.y,b.x);c=FEc(c,b);return a==c}function S4i(a,b,c){if(c&&(a=a.D.C.C)&&JC(a))return null;b=N().LN()(b);if(!b)return null;(b=N().qT()(b))?(a=t0i(),u0i(a),b=Ah(a,2,b).build().qb()):b=null;return b}p.Ejc=function(){var a=!N().UZa()(this.C);Y4i(this,!0);a&&(M4i(this.H,"Using relative references"),NG("Recording with relative references"))};
p.Djc=function(){var a=N().UZa()(this.C);Y4i(this,!1);a&&(M4i(this.H,"Using absolute references"),NG("Recording with absolute references"))};function Y4i(a,b){N().TWb()(a.C,b);iA.rc(b);jA.rc(!b)}function U4i(a){(a=qJ(a.J))&&iM(a)}function f8(a){return a.L.C.getSelection().C.qb()}p.Na=function(){N().cZa()();B.prototype.Na.call(this)};function W4i(a,b){this.C=a;this.D=b};function Z4i(a,b,c,d,e){uw.call(this,"Macro saved",Lj(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-saved"]);this.Sa=a;this.L=b;this.Ra=c;this.Ha=d;this.H=e}v(Z4i,uw);Z4i.prototype.Ca=function(){uw.prototype.Ca.call(this);var a=vr(this,"script-recorder-edit-link-id");this.Qr("EDIT SCRIPT",a)};Z4i.prototype.Ja=function(){uw.prototype.Ja.call(this);this.getHandler().Ue(xr(this,"script-recorder-edit-link-id"),Hm,w(this.Qa,this,this.Sa,this.L,this.Ra))};
Z4i.prototype.Qa=function(a,b,c){this.Ha.C(29645);this.H.Fa("macros-editor").kb(b?{scriptId:a,filename:b,lineNumber:c}:void 0)};function $4i(a,b,c,d,e,f,h,k,l,n){Jv.call(this);var q=this;this.Aa=a;this.ma=b;this.Ra=c;this.Pa=d;this.ea=e;this.H=f;this.Ha=h;this.xa=k;this.L=n;this.J=this.H.ud();this.Ea=new Du(this);this.oa(this.Ea);this.F=null;this.R=!1;this.C=null;this.Qa=l;this.Ea.subscribe(hA,"action",this.uyc).subscribe(this.J.Fa("recorded-action-stop"),"action",this.mAc).subscribe(Plb,"action",this.Twc).subscribe(dA,"action",this.OHb).subscribe(eA,"action",this.Xyc).subscribe(fA,"action",this.czc);Lv(this,a5i(this));Eq(this.H,
this);a=["not-revisions","sheet-access-edit",Ov()];var t=new Dq(a.concat(["docs-script-recording"]));pd([dA,this.J.Fa("recorded-action-stop"),Plb,Nlb,jA,iA],function(u){q.H.C(u,t);q.H.D(u,t)});a=new Dq(a.concat(["not-docs-script-recording"]));this.H.C(hA,a);px()||this.H.D(hA,a)}v($4i,Jv);p=$4i.prototype;p.uyc=function(){var a=this;this.F=new P4i(this.Ra,this.Pa,this.ea,this.Ha,this.J);Mv(this,a5i(this));this.Ha.D.C.Ts(function(){dp(Gl(ep(a.Aa.Oe("/startrecordingscript"),"POST"),1).setTimeout(18E4)).Qe()})};
p.mAc=function(){rJ(this.ea)&&kL(qJ(this.ea),!0);this.F.H.setVisible(!1);N().cZa()();m0i(this.ma)};
p.Twc=function(a){var b=this,c=a.qGa;a=a.noa;var d=V4i(this.F).sourceCode();b5i(this,xw(this.L,"Saving new macro",Lj(),!0,0,!1,void 0,!0,["waffle-recording-toast-saving"]),!0);this.R=!0;Mv(this,a5i(this));dp(Jl(Kl(Gl(ep(Fl(Fl(Uo(this.Aa.Oe("/saverecordedscript"),["script",d]),"name",c),"shortcut",""!=a?"Ctrl+Alt+Shift+"+a:""),"POST"),1),function(e){var f=e.bU("scriptId"),h=e.bU("filename");e=Number(aH(e,"lineNumber"));f=new Z4i(f,h,e,b.Qa,b.J);yw(b.L,f);b5i(b,f);b.R=!1;c5i(b)}),function(){b5i(b,xw(b.L,
"Failed to save macro",Lj(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-save-failed"]));b.R=!1;if(b.F){var e=b.F;N().PZa()(e.C);e.H.setVisible(!0)}Mv(b,a5i(b))}).setTimeout(18E4)).Qe()};function c5i(a){Xf(a.F);a.F=null;Mv(a,a5i(a))}p.OHb=function(){c5i(this);setTimeout(function(){return NG("Script recording canceled")})};function a5i(a){var b={},c=!!a.F;a=a.R;b["docs-script-recording"]=c&&!a;b["not-docs-script-recording"]=!c&&!a;return b}p.Xyc=function(){n0i(this.ma,this.xa)};
p.czc=function(){o0i(this.ma,this.xa)};function b5i(a,b,c){a.C&&(zw(a.L,a.C),a.C.setVisible(!1),Xf(a.C));a.C=b;a.C.render();c&&(new MEf(!0,Lj())).render(Tj("docs-ui-toast-content",b.getElement()));a.C.setVisible(!0)}p.Na=function(){Xf(this.F);this.F=null;this.C&&(Xf(this.C),this.C=null);Jv.prototype.Na.call(this)};function d5i(a,b,c,d){1==a&&$Rb(vf(c||""),vf(b),void 0!==d?d:-1,!0)};function e5i(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E,L,P,R,da){B.call(this);this.R=a;this.ma=b;this.Aa=c;this.Ea=d;this.O=e;this.Qa=f;this.Pa=h;this.C=k;this.F=l;this.Ma=n;this.Ha=q;this.ea=t;this.Ra=u;this.L=new Pm(this);this.oa(this.L);this.xa=new D0i(this.Aa,this.F);this.bb=new $4i(this.Aa,this.O,this.ma,this.R,this.C.D,E,this.F,this.xa,L,P);this.oa(this.bb);this.J=E.ud();this.Za=new G4i(this.J,this.C.Aa.C,l,this.xa,z,this.C.Aa.Ma,R);this.oa(this.Za);this.D=null;this.H=da}v(e5i,B);
e5i.prototype.init=function(){var a=this.C.Aa.Ma;a.Yh(hA);a.Yh(dA);a.Yh(this.J.Fa("recorded-action-stop"));a.Yh(iA);a.Yh(jA);a.Yh(eA);a.Yh(fA);a=this.F.xb.D;var b=this.F.xb.C;b&&(b+=a?"_"+a:"");a=A();var c=y(a,"docs-tintd")&&y(a,"docs-thtea");this.D=new LIe(this.Ea,this.ma.C,this.C.D);this.oa(this.D);var d=this.R,e=YMa(this.Ha),f=ZMa(this.Ha),h=this.O,k=this.Qa,l=this.Pa,n=w(this.ea.O,this.ea),q=w(this.D.C,this.D),t=(av(),Zu),u=this.Ma,z=this.Ra,E=this.Ea,L=tx(Lw.getInstance()),P=this.C.Aa.C;L=void 0===
L?!1:L;c=void 0===c?!1:c;var R=A();R=new t2i(jd(R,"maestro_container_token"),jd(R,"maestro_domain"),jd(R,"maestro_script_editor_uri"),jd(R,"maestro_new_project_uri"),y(R,"docs-emae"),jd(R,"mae-pai"),y(R,"mae-cwssw"),y(R,"mae-aoeba"),y(R,"mae-esme"),jd(R,"mae-dret"),jd(R,"mae-ses"),y(R,"docs-tdd"),y(R,"mae-seitd"));e=new S1i(d.D,String(E),e,void 0);E=new e3i;E.bind(f);f=R.C?2:R.D?0:1;var da=new Fu(void 0,void 0,!0,Hw.getInstance());l=l?new B3i(l,da,f,P,void 0):null;d=new A4i(d,R,e,E,h,k,l,n,q,t,u,
z,L,d5i,qUc,b,c);d.oa(e);d.oa(E);d.start();O("macros-addon-sidebar").Oa(B4i(t));O("macros-addon-sidebar-focus").Oa(C4i(t,c||!1));O("macros-application-focus").Oa(!0);O("macros-application-sidebar").Oa(!0);O("macros-editor").Oa(!R.xa||R.J);O("macros-exec").Oa(!0);O("macros-extension-disabled").Oa(!0);O("macros-extension-help").Oa(!0);O("macros-extension-install-start").Oa(!0);O("macros-extension-menu-promo").Oa(!0);O("macros-manage").Oa(!0);O("macros-resume").Oa(!0);O("macros-trigger-0").Oa(!0);O("macros-trigger-1").Oa(!0);
O("macros-trigger-2").Oa(!0);O("macros-trigger-3").Oa(!0);O("macros-trigger-4").Oa(!0);O("macros-trigger-5").Oa(!0);O("macros-trigger-6").Oa(!0);O("macros-trigger-7").Oa(!0);O("macros-trigger-8").Oa(!0);O("macros-trigger-9").Oa(!0);null!=this.H&&(a=y(a,"docs-isctp"),this.H.ea=a,this.L.listen(d.J,O2i,w(this.Wa,this)));this.L.listen(LG,"runMacro",w(this.Sa,this))};e5i.prototype.Wa=function(a){null!=this.H&&(a=vi(a.C(),1),this.H.ea=a)};
e5i.prototype.Sa=function(a){var b=a.payload;a=sd(N().WT()(),zpa);a=wd(a,function(c){return c.getFunctionName()==b});null!=a&&lh(a,1)?this.J.Fa("macros-exec").kb(new d1i(ph(a,1),b,void 0,void 0,void 0,lh(a,12)?a.Zq():void 0)):MG("Script function "+(b+" could not be found"))};function f5i(a){var b=a.mHa;a='<div class="waffle-record-script-dialog-name-section"><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-name-input" id="waffle-record-script-name-input-label">Name</label></div><div class="waffle-record-script-name"><input class="waffle-record-script-name-input jfk-textinput" id="waffle-record-script-name-input" maxlength="50" aria-labelledby="waffle-record-script-dialog-description-id waffle-record-script-name-input-label"/></div></div><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-shortcut-input">Shortcut (optional)</label></div><div class="waffle-record-script-shortcut"><label for="waffle-record-script-shortcut-input" id="waffle-record-script-shortcut-input-label">'+
(Jr(b)+'</label><input class="waffle-record-script-shortcut-input jfk-textinput" id="waffle-record-script-shortcut-input" maxlength="1" aria-labelledby="waffle-record-script-shorcut-description-id"/><div id="waffle-record-script-shorcut-description-id" style="display:none;">');b="Optional numeric shortcut key, use with "+(Jr(b)+" to run macro.");return T(a+b+"</div></div>")};function g5i(a,b){jw.call(this,void 0,void 0,b);this.mq=!1;Qs(this,!1);this.F=new Pv;this.Ia(this.F);this.H=new AW(this.qa());this.Ia(this.H);this.L=new Pv("Number");this.Ia(this.L);this.C=new AW(this.qa());this.Ia(this.C);Rs(this,(new Os).mf({key:"discard",caption:"Discard"},!1).mf(mYa,!0))}v(g5i,jw);p=g5i.prototype;
p.Ca=function(){jw.prototype.Ca.call(this);y(A(),"docs-egmd")?(ks(Ms(this),"waffle-record-script-dialog-gm"),ct(this,"save")):ks(Ms(this),"waffle-record-script-dialog");this.setTitle("Save new macro");this.zb().appendChild(Gr(f5i,{mHa:Sp?"\u2318 + Option + Shift +":"Ctrl + Alt + Shift +"}))};
p.Ja=function(){jw.prototype.Ja.call(this);this.F.Va(this.Da("waffle-record-script-name-input"));y(A(),"docs-egmd")||ks(this.Da("waffle-record-script-name"),jyf.getInstance().kc());this.F.setValue("Untitled Macro");var a=this.F.La();this.H.setPosition(3,2);this.H.render();this.H.wi(a);DW(this.H,a);CW(this.H);this.L.Va(this.Da("waffle-record-script-shortcut-input"));y(A(),"docs-egmd")||ks(this.Da("waffle-record-script-shortcut"),jyf.getInstance().kc());var b=this.L.La();this.C.setPosition(3,2);this.C.render();
this.C.wi(b);DW(this.C,b);CW(this.C);this.getHandler().listen(this,"dialogselect",this.xxb).listen(a,["focus","blur","change"],this.bac).listen(b,["focus","blur","change"],this.rgc)};p.focus=function(){jw.prototype.focus.call(this);Sv(this.F)};p.bac=function(){""!=this.F.getValue()&&CW(this.H)};p.rgc=function(){h5i(this)&&CW(this.C)};
p.xxb=function(a){var b=this,c=tq(new sq,12).build();if("discard"==a.key)dA.kb(void 0,c);else if("save"==a.key)if(""!=this.F.getValue()||BW(this.H,"Must not be empty.",!0),h5i(this)||setTimeout(function(){BW(b.C,"Must be a number from 0 to 9 or blank.",!0)}),i5i(this)&&setTimeout(function(){BW(b.C,"Conflicts with another shortcut.",!0)}),""!=this.F.getValue()&&h5i(this)&&!i5i(this)){a=this.F.getValue();var d=this.L.getValue();Plb.kb(new J4i(a,d),c)}else a.preventDefault()};
function h5i(a){a=a.L.getValue();return""==a||/^\d$/.test(a)}function i5i(a){var b="Ctrl+Alt+Shift+"+a.L.getValue();return N().WT()().map(zpa).some(function(c){return lh(c,9)&&ph(c,9)==b})};function j5i(){Tn.apply(this,arguments)}v(j5i,Tn);j5i.prototype.F=function(){return e5i};j5i.prototype.H=function(){return g5i};j5i.prototype.C=function(a,b,c,d){return new I0i(a,b,c,d,void 0)};j5i.prototype.D=function(a,b,c){return new Y0i(a,b,c,void 0)};Fo("ritzmaestro",j5i);
