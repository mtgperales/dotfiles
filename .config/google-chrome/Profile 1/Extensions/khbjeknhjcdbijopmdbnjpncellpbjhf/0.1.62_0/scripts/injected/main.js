"use strict";function addClass(a,b){a.classList.add(b)}function removeClass(a,b){a.classList.remove(b)}function toggleClassOnElement(a,b){a.classList.contains(b)?removeClass(a,b):addClass(a,b)}function enable(a){a?(removeClass(container,"copycat-disabled"),removeClass(overlay,"copycat-disabled")):(addClass(container,"copycat-disabled"),addClass(overlay,"copycat-disabled"))}function render(){chrome.storage.local.get("options",function(a){var b=a.options,c=void 0!==b.enabled?b.enabled:!0;enable(c)})}function isOpen(){return!container.classList.contains("copycat-hidden")&&!overlay.classList.contains("copycat-hidden")}function trackToggleViewEvent(a){chrome.storage.local.get("clips",function(b){if(!chrome.runtime.lastError){var c,d=b.clips&&b.clips.length||0;c="onCreateClip"===a?"Opened because of Clip":"onCopy"===a?"Closed because of Copy":isOpen()?"Clicked to Open":"Clicked to Close",chrome.runtime.sendMessage({analytic:{type:"event",payload:{category:"Copycat",action:c,label:d+" clips"}}})}})}function toggleView(a){toggleClassOnElement(container,"copycat-hidden"),toggleClassOnElement(overlay,"copycat-hidden"),toggleClassOnElement(document.body,"copycat-no-scroll"),trackToggleViewEvent(a||"onToggleView")}function jiggleToggle(){toggleButton.classList.contains("jiggle")||(addClass(toggleButton,"jiggle"),setTimeout(function(){removeClass(toggleButton,"jiggle")},2e3))}var iFrame=document.createElement("iframe");iFrame.setAttribute("class","copycat-iframe"),iFrame.setAttribute("sandbox","allow-same-origin allow-scripts"),iFrame.src=chrome.extension.getURL("scripts/injected/flyout/app.html");var toggleButton=document.createElement("div");toggleButton.setAttribute("class","copycat-toggle"),toggleButton.innerHTML="Copycat";var container=document.createElement("div");container.setAttribute("class","copycat-container copycat-hidden copycat-disabled"),container.appendChild(toggleButton),container.appendChild(iFrame),document.body.insertBefore(container,document.body.firstChild);var overlay=document.createElement("div");overlay.setAttribute("class","copycat-overlay copycat-hidden copycat-disabled"),document.body.insertBefore(overlay,document.body.firstChild),render(),toggleButton.addEventListener("click",function(){toggleView("onClick")}),overlay.addEventListener("click",function(){toggleView("onClick")}),chrome.runtime.onMessage.addListener(function(a){switch(a.message){case"toggleView":toggleView(a.eventName);break;case"toggleEnabled":enable(a.enabled);break;case"jiggleToggle":jiggleToggle()}});